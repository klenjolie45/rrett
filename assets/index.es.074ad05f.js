import{e as mt,h as f_,k as de,m as p_,w as $l,o as Ll,p as Ic,t as _o,q as d_,s as wi,D as g_,u as y_,N as ie,v as v_,x as pc,y as __,V as m_,R as w_,F as Uh,K as b_,z as E_,L as I_,A as Hh,$ as x_,B as S_,C as Jn,Z as Bh,J as P_,X as O_,_ as ql,E as jr,G as A_,H as R_,I as fn,M as Ft,U as er,O as mi,P as cr,Q as T_,S as pn,T as Ml,W as C_,Y as D_,a0 as N_,a1 as zl,a2 as F_,a3 as Ul,a4 as Hl,a5 as gn,a6 as dc,a7 as lo,a8 as vn,a9 as fo,aa as j_,ab as $_,ac as L_,ad as oo,ae as q_,af as M_,ag as Za,ah as kh,ai as z_,aj as U_,ak as H_,al as Vh,am as B_,an as k_,ao as V_,ap as K_,aq as G_,ar as W_,as as J_,at as Q_,j as Y_,au as Vn,av as Bl,aw as ec,ax as X_,ay as Z_,az as em}from"./index.ffae99bc.js";import{e as Pr,$ as xc}from"./events.871e9f0f.js";var mo={},Sc={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(a){var i,r,s,o,p,_,b,S,D,$,K,X,Q,F,se,ce,pe,le,ue,ne,he,fe,ee;(function(j){var Se=typeof mt=="object"?mt:typeof self=="object"?self:typeof this=="object"?this:{};j(f(Se,f(a.exports)));function f(g,y){return g!==Se&&(typeof Object.create=="function"?Object.defineProperty(g,"__esModule",{value:!0}):g.__esModule=!0),function(I,l){return g[I]=y?y(I,l):l}}})(function(j){var Se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,g){f.__proto__=g}||function(f,g){for(var y in g)g.hasOwnProperty(y)&&(f[y]=g[y])};i=function(f,g){Se(f,g);function y(){this.constructor=f}f.prototype=g===null?Object.create(g):(y.prototype=g.prototype,new y)},r=Object.assign||function(f){for(var g,y=1,I=arguments.length;y<I;y++){g=arguments[y];for(var l in g)Object.prototype.hasOwnProperty.call(g,l)&&(f[l]=g[l])}return f},s=function(f,g){var y={};for(var I in f)Object.prototype.hasOwnProperty.call(f,I)&&g.indexOf(I)<0&&(y[I]=f[I]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,I=Object.getOwnPropertySymbols(f);l<I.length;l++)g.indexOf(I[l])<0&&Object.prototype.propertyIsEnumerable.call(f,I[l])&&(y[I[l]]=f[I[l]]);return y},o=function(f,g,y,I){var l=arguments.length,h=l<3?g:I===null?I=Object.getOwnPropertyDescriptor(g,y):I,P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(f,g,y,I);else for(var M=f.length-1;M>=0;M--)(P=f[M])&&(h=(l<3?P(h):l>3?P(g,y,h):P(g,y))||h);return l>3&&h&&Object.defineProperty(g,y,h),h},p=function(f,g){return function(y,I){g(y,I,f)}},_=function(f,g){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(f,g)},b=function(f,g,y,I){function l(h){return h instanceof y?h:new y(function(P){P(h)})}return new(y||(y=Promise))(function(h,P){function M(q){try{E(I.next(q))}catch(W){P(W)}}function H(q){try{E(I.throw(q))}catch(W){P(W)}}function E(q){q.done?h(q.value):l(q.value).then(M,H)}E((I=I.apply(f,g||[])).next())})},S=function(f,g){var y={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},I,l,h,P;return P={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(P[Symbol.iterator]=function(){return this}),P;function M(E){return function(q){return H([E,q])}}function H(E){if(I)throw new TypeError("Generator is already executing.");for(;y;)try{if(I=1,l&&(h=E[0]&2?l.return:E[0]?l.throw||((h=l.return)&&h.call(l),0):l.next)&&!(h=h.call(l,E[1])).done)return h;switch(l=0,h&&(E=[E[0]&2,h.value]),E[0]){case 0:case 1:h=E;break;case 4:return y.label++,{value:E[1],done:!1};case 5:y.label++,l=E[1],E=[0];continue;case 7:E=y.ops.pop(),y.trys.pop();continue;default:if(h=y.trys,!(h=h.length>0&&h[h.length-1])&&(E[0]===6||E[0]===2)){y=0;continue}if(E[0]===3&&(!h||E[1]>h[0]&&E[1]<h[3])){y.label=E[1];break}if(E[0]===6&&y.label<h[1]){y.label=h[1],h=E;break}if(h&&y.label<h[2]){y.label=h[2],y.ops.push(E);break}h[2]&&y.ops.pop(),y.trys.pop();continue}E=g.call(f,y)}catch(q){E=[6,q],l=0}finally{I=h=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},ee=function(f,g,y,I){I===void 0&&(I=y),f[I]=g[y]},D=function(f,g){for(var y in f)y!=="default"&&!g.hasOwnProperty(y)&&(g[y]=f[y])},$=function(f){var g=typeof Symbol=="function"&&Symbol.iterator,y=g&&f[g],I=0;if(y)return y.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&I>=f.length&&(f=void 0),{value:f&&f[I++],done:!f}}};throw new TypeError(g?"Object is not iterable.":"Symbol.iterator is not defined.")},K=function(f,g){var y=typeof Symbol=="function"&&f[Symbol.iterator];if(!y)return f;var I=y.call(f),l,h=[],P;try{for(;(g===void 0||g-- >0)&&!(l=I.next()).done;)h.push(l.value)}catch(M){P={error:M}}finally{try{l&&!l.done&&(y=I.return)&&y.call(I)}finally{if(P)throw P.error}}return h},X=function(){for(var f=[],g=0;g<arguments.length;g++)f=f.concat(K(arguments[g]));return f},Q=function(){for(var f=0,g=0,y=arguments.length;g<y;g++)f+=arguments[g].length;for(var I=Array(f),l=0,g=0;g<y;g++)for(var h=arguments[g],P=0,M=h.length;P<M;P++,l++)I[l]=h[P];return I},F=function(f){return this instanceof F?(this.v=f,this):new F(f)},se=function(f,g,y){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var I=y.apply(f,g||[]),l,h=[];return l={},P("next"),P("throw"),P("return"),l[Symbol.asyncIterator]=function(){return this},l;function P(Y){I[Y]&&(l[Y]=function(ye){return new Promise(function(ot,we){h.push([Y,ye,ot,we])>1||M(Y,ye)})})}function M(Y,ye){try{H(I[Y](ye))}catch(ot){W(h[0][3],ot)}}function H(Y){Y.value instanceof F?Promise.resolve(Y.value.v).then(E,q):W(h[0][2],Y)}function E(Y){M("next",Y)}function q(Y){M("throw",Y)}function W(Y,ye){Y(ye),h.shift(),h.length&&M(h[0][0],h[0][1])}},ce=function(f){var g,y;return g={},I("next"),I("throw",function(l){throw l}),I("return"),g[Symbol.iterator]=function(){return this},g;function I(l,h){g[l]=f[l]?function(P){return(y=!y)?{value:F(f[l](P)),done:l==="return"}:h?h(P):P}:h}},pe=function(f){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var g=f[Symbol.asyncIterator],y;return g?g.call(f):(f=typeof $=="function"?$(f):f[Symbol.iterator](),y={},I("next"),I("throw"),I("return"),y[Symbol.asyncIterator]=function(){return this},y);function I(h){y[h]=f[h]&&function(P){return new Promise(function(M,H){P=f[h](P),l(M,H,P.done,P.value)})}}function l(h,P,M,H){Promise.resolve(H).then(function(E){h({value:E,done:M})},P)}},le=function(f,g){return Object.defineProperty?Object.defineProperty(f,"raw",{value:g}):f.raw=g,f},ue=function(f){if(f&&f.__esModule)return f;var g={};if(f!=null)for(var y in f)Object.hasOwnProperty.call(f,y)&&(g[y]=f[y]);return g.default=f,g},ne=function(f){return f&&f.__esModule?f:{default:f}},he=function(f,g){if(!g.has(f))throw new TypeError("attempted to get private field on non-instance");return g.get(f)},fe=function(f,g,y){if(!g.has(f))throw new TypeError("attempted to set private field on non-instance");return g.set(f,y),y},j("__extends",i),j("__assign",r),j("__rest",s),j("__decorate",o),j("__param",p),j("__metadata",_),j("__awaiter",b),j("__generator",S),j("__exportStar",D),j("__createBinding",ee),j("__values",$),j("__read",K),j("__spread",X),j("__spreadArrays",Q),j("__await",F),j("__asyncGenerator",se),j("__asyncDelegator",ce),j("__asyncValues",pe),j("__makeTemplateObject",le),j("__importStar",ue),j("__importDefault",ne),j("__classPrivateFieldGet",he),j("__classPrivateFieldSet",fe)})})(Sc);var Zn={};Object.defineProperty(Zn,"__esModule",{value:!0});function tm(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return JSON.parse(a)}catch{return a}}Zn.safeJsonParse=tm;function rm(a){return typeof a=="string"?a:JSON.stringify(a,(i,r)=>typeof r>"u"?null:r)}Zn.safeJsonStringify=rm;var po={exports:{}};(function(){let a;function i(){}a=i,a.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},a.prototype.setItem=function(r,s){this[r]=String(s)},a.prototype.removeItem=function(r){delete this[r]},a.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},a.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof mt<"u"&&mt.localStorage?po.exports=mt.localStorage:typeof window<"u"&&window.localStorage?po.exports=window.localStorage:po.exports=new i})();var kl={},wo={};Object.defineProperty(wo,"__esModule",{value:!0});wo.IKeyValueStorage=void 0;class im{}wo.IKeyValueStorage=im;var bo={};Object.defineProperty(bo,"__esModule",{value:!0});bo.parseEntry=void 0;const nm=Zn;function sm(a){var i;return[a[0],nm.safeJsonParse((i=a[1])!==null&&i!==void 0?i:"")]}bo.parseEntry=sm;(function(a){Object.defineProperty(a,"__esModule",{value:!0});const i=Sc.exports;i.__exportStar(wo,a),i.__exportStar(bo,a)})(kl);Object.defineProperty(mo,"__esModule",{value:!0});mo.KeyValueStorage=void 0;const dn=Sc.exports,Kh=Zn,om=dn.__importDefault(po.exports),am=kl;class Vl{constructor(){this.localStorage=om.default}getKeys(){return dn.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return dn.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(am.parseEntry)})}getItem(i){return dn.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(i);if(r!==null)return Kh.safeJsonParse(r)})}setItem(i,r){return dn.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(i,Kh.safeJsonStringify(r))})}removeItem(i){return dn.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(i)})}}mo.KeyValueStorage=Vl;var cm=mo.default=Vl,mn={},es={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(a){var i,r,s,o,p,_,b,S,D,$,K,X,Q,F,se,ce,pe,le,ue,ne,he,fe,ee;(function(j){var Se=typeof mt=="object"?mt:typeof self=="object"?self:typeof this=="object"?this:{};j(f(Se,f(a.exports)));function f(g,y){return g!==Se&&(typeof Object.create=="function"?Object.defineProperty(g,"__esModule",{value:!0}):g.__esModule=!0),function(I,l){return g[I]=y?y(I,l):l}}})(function(j){var Se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,g){f.__proto__=g}||function(f,g){for(var y in g)g.hasOwnProperty(y)&&(f[y]=g[y])};i=function(f,g){Se(f,g);function y(){this.constructor=f}f.prototype=g===null?Object.create(g):(y.prototype=g.prototype,new y)},r=Object.assign||function(f){for(var g,y=1,I=arguments.length;y<I;y++){g=arguments[y];for(var l in g)Object.prototype.hasOwnProperty.call(g,l)&&(f[l]=g[l])}return f},s=function(f,g){var y={};for(var I in f)Object.prototype.hasOwnProperty.call(f,I)&&g.indexOf(I)<0&&(y[I]=f[I]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,I=Object.getOwnPropertySymbols(f);l<I.length;l++)g.indexOf(I[l])<0&&Object.prototype.propertyIsEnumerable.call(f,I[l])&&(y[I[l]]=f[I[l]]);return y},o=function(f,g,y,I){var l=arguments.length,h=l<3?g:I===null?I=Object.getOwnPropertyDescriptor(g,y):I,P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(f,g,y,I);else for(var M=f.length-1;M>=0;M--)(P=f[M])&&(h=(l<3?P(h):l>3?P(g,y,h):P(g,y))||h);return l>3&&h&&Object.defineProperty(g,y,h),h},p=function(f,g){return function(y,I){g(y,I,f)}},_=function(f,g){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(f,g)},b=function(f,g,y,I){function l(h){return h instanceof y?h:new y(function(P){P(h)})}return new(y||(y=Promise))(function(h,P){function M(q){try{E(I.next(q))}catch(W){P(W)}}function H(q){try{E(I.throw(q))}catch(W){P(W)}}function E(q){q.done?h(q.value):l(q.value).then(M,H)}E((I=I.apply(f,g||[])).next())})},S=function(f,g){var y={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},I,l,h,P;return P={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(P[Symbol.iterator]=function(){return this}),P;function M(E){return function(q){return H([E,q])}}function H(E){if(I)throw new TypeError("Generator is already executing.");for(;y;)try{if(I=1,l&&(h=E[0]&2?l.return:E[0]?l.throw||((h=l.return)&&h.call(l),0):l.next)&&!(h=h.call(l,E[1])).done)return h;switch(l=0,h&&(E=[E[0]&2,h.value]),E[0]){case 0:case 1:h=E;break;case 4:return y.label++,{value:E[1],done:!1};case 5:y.label++,l=E[1],E=[0];continue;case 7:E=y.ops.pop(),y.trys.pop();continue;default:if(h=y.trys,!(h=h.length>0&&h[h.length-1])&&(E[0]===6||E[0]===2)){y=0;continue}if(E[0]===3&&(!h||E[1]>h[0]&&E[1]<h[3])){y.label=E[1];break}if(E[0]===6&&y.label<h[1]){y.label=h[1],h=E;break}if(h&&y.label<h[2]){y.label=h[2],y.ops.push(E);break}h[2]&&y.ops.pop(),y.trys.pop();continue}E=g.call(f,y)}catch(q){E=[6,q],l=0}finally{I=h=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},ee=function(f,g,y,I){I===void 0&&(I=y),f[I]=g[y]},D=function(f,g){for(var y in f)y!=="default"&&!g.hasOwnProperty(y)&&(g[y]=f[y])},$=function(f){var g=typeof Symbol=="function"&&Symbol.iterator,y=g&&f[g],I=0;if(y)return y.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&I>=f.length&&(f=void 0),{value:f&&f[I++],done:!f}}};throw new TypeError(g?"Object is not iterable.":"Symbol.iterator is not defined.")},K=function(f,g){var y=typeof Symbol=="function"&&f[Symbol.iterator];if(!y)return f;var I=y.call(f),l,h=[],P;try{for(;(g===void 0||g-- >0)&&!(l=I.next()).done;)h.push(l.value)}catch(M){P={error:M}}finally{try{l&&!l.done&&(y=I.return)&&y.call(I)}finally{if(P)throw P.error}}return h},X=function(){for(var f=[],g=0;g<arguments.length;g++)f=f.concat(K(arguments[g]));return f},Q=function(){for(var f=0,g=0,y=arguments.length;g<y;g++)f+=arguments[g].length;for(var I=Array(f),l=0,g=0;g<y;g++)for(var h=arguments[g],P=0,M=h.length;P<M;P++,l++)I[l]=h[P];return I},F=function(f){return this instanceof F?(this.v=f,this):new F(f)},se=function(f,g,y){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var I=y.apply(f,g||[]),l,h=[];return l={},P("next"),P("throw"),P("return"),l[Symbol.asyncIterator]=function(){return this},l;function P(Y){I[Y]&&(l[Y]=function(ye){return new Promise(function(ot,we){h.push([Y,ye,ot,we])>1||M(Y,ye)})})}function M(Y,ye){try{H(I[Y](ye))}catch(ot){W(h[0][3],ot)}}function H(Y){Y.value instanceof F?Promise.resolve(Y.value.v).then(E,q):W(h[0][2],Y)}function E(Y){M("next",Y)}function q(Y){M("throw",Y)}function W(Y,ye){Y(ye),h.shift(),h.length&&M(h[0][0],h[0][1])}},ce=function(f){var g,y;return g={},I("next"),I("throw",function(l){throw l}),I("return"),g[Symbol.iterator]=function(){return this},g;function I(l,h){g[l]=f[l]?function(P){return(y=!y)?{value:F(f[l](P)),done:l==="return"}:h?h(P):P}:h}},pe=function(f){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var g=f[Symbol.asyncIterator],y;return g?g.call(f):(f=typeof $=="function"?$(f):f[Symbol.iterator](),y={},I("next"),I("throw"),I("return"),y[Symbol.asyncIterator]=function(){return this},y);function I(h){y[h]=f[h]&&function(P){return new Promise(function(M,H){P=f[h](P),l(M,H,P.done,P.value)})}}function l(h,P,M,H){Promise.resolve(H).then(function(E){h({value:E,done:M})},P)}},le=function(f,g){return Object.defineProperty?Object.defineProperty(f,"raw",{value:g}):f.raw=g,f},ue=function(f){if(f&&f.__esModule)return f;var g={};if(f!=null)for(var y in f)Object.hasOwnProperty.call(f,y)&&(g[y]=f[y]);return g.default=f,g},ne=function(f){return f&&f.__esModule?f:{default:f}},he=function(f,g){if(!g.has(f))throw new TypeError("attempted to get private field on non-instance");return g.get(f)},fe=function(f,g,y){if(!g.has(f))throw new TypeError("attempted to set private field on non-instance");return g.set(f,y),y},j("__extends",i),j("__assign",r),j("__rest",s),j("__decorate",o),j("__param",p),j("__metadata",_),j("__awaiter",b),j("__generator",S),j("__exportStar",D),j("__createBinding",ee),j("__values",$),j("__read",K),j("__spread",X),j("__spreadArrays",Q),j("__await",F),j("__asyncGenerator",se),j("__asyncDelegator",ce),j("__asyncValues",pe),j("__makeTemplateObject",le),j("__importStar",ue),j("__importDefault",ne),j("__classPrivateFieldGet",he),j("__classPrivateFieldSet",fe)})})(es);var Eo={},Pc={},Io={};class Ui{}var um=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",IEvents:Ui}),hm=f_(um);Object.defineProperty(Io,"__esModule",{value:!0});Io.IHeartBeat=void 0;const lm=hm;class fm extends lm.IEvents{constructor(i){super()}}Io.IHeartBeat=fm;(function(a){Object.defineProperty(a,"__esModule",{value:!0}),es.exports.__exportStar(Io,a)})(Pc);var Oc={},_n={};Object.defineProperty(_n,"__esModule",{value:!0});_n.HEARTBEAT_EVENTS=_n.HEARTBEAT_INTERVAL=void 0;const pm=de;_n.HEARTBEAT_INTERVAL=pm.FIVE_SECONDS;_n.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"};(function(a){Object.defineProperty(a,"__esModule",{value:!0}),es.exports.__exportStar(_n,a)})(Oc);Object.defineProperty(Eo,"__esModule",{value:!0});Eo.HeartBeat=void 0;const tc=es.exports,dm=Pr.exports,gm=de,ym=Pc,rc=Oc;class Ac extends ym.IHeartBeat{constructor(i){super(i),this.events=new dm.EventEmitter,this.interval=rc.HEARTBEAT_INTERVAL,this.interval=i?.interval||rc.HEARTBEAT_INTERVAL}static init(i){return tc.__awaiter(this,void 0,void 0,function*(){const r=new Ac(i);return yield r.init(),r})}init(){return tc.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}initialize(){return tc.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),gm.toMiliseconds(this.interval))})}pulse(){this.events.emit(rc.HEARTBEAT_EVENTS.pulse)}}Eo.HeartBeat=Ac;(function(a){Object.defineProperty(a,"__esModule",{value:!0});const i=es.exports;i.__exportStar(Eo,a),i.__exportStar(Pc,a),i.__exportStar(Oc,a)})(mn);var Fe={},Kl={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(a){var i,r,s,o,p,_,b,S,D,$,K,X,Q,F,se,ce,pe,le,ue,ne,he,fe,ee;(function(j){var Se=typeof mt=="object"?mt:typeof self=="object"?self:typeof this=="object"?this:{};j(f(Se,f(a.exports)));function f(g,y){return g!==Se&&(typeof Object.create=="function"?Object.defineProperty(g,"__esModule",{value:!0}):g.__esModule=!0),function(I,l){return g[I]=y?y(I,l):l}}})(function(j){var Se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,g){f.__proto__=g}||function(f,g){for(var y in g)g.hasOwnProperty(y)&&(f[y]=g[y])};i=function(f,g){Se(f,g);function y(){this.constructor=f}f.prototype=g===null?Object.create(g):(y.prototype=g.prototype,new y)},r=Object.assign||function(f){for(var g,y=1,I=arguments.length;y<I;y++){g=arguments[y];for(var l in g)Object.prototype.hasOwnProperty.call(g,l)&&(f[l]=g[l])}return f},s=function(f,g){var y={};for(var I in f)Object.prototype.hasOwnProperty.call(f,I)&&g.indexOf(I)<0&&(y[I]=f[I]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,I=Object.getOwnPropertySymbols(f);l<I.length;l++)g.indexOf(I[l])<0&&Object.prototype.propertyIsEnumerable.call(f,I[l])&&(y[I[l]]=f[I[l]]);return y},o=function(f,g,y,I){var l=arguments.length,h=l<3?g:I===null?I=Object.getOwnPropertyDescriptor(g,y):I,P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(f,g,y,I);else for(var M=f.length-1;M>=0;M--)(P=f[M])&&(h=(l<3?P(h):l>3?P(g,y,h):P(g,y))||h);return l>3&&h&&Object.defineProperty(g,y,h),h},p=function(f,g){return function(y,I){g(y,I,f)}},_=function(f,g){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(f,g)},b=function(f,g,y,I){function l(h){return h instanceof y?h:new y(function(P){P(h)})}return new(y||(y=Promise))(function(h,P){function M(q){try{E(I.next(q))}catch(W){P(W)}}function H(q){try{E(I.throw(q))}catch(W){P(W)}}function E(q){q.done?h(q.value):l(q.value).then(M,H)}E((I=I.apply(f,g||[])).next())})},S=function(f,g){var y={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},I,l,h,P;return P={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(P[Symbol.iterator]=function(){return this}),P;function M(E){return function(q){return H([E,q])}}function H(E){if(I)throw new TypeError("Generator is already executing.");for(;y;)try{if(I=1,l&&(h=E[0]&2?l.return:E[0]?l.throw||((h=l.return)&&h.call(l),0):l.next)&&!(h=h.call(l,E[1])).done)return h;switch(l=0,h&&(E=[E[0]&2,h.value]),E[0]){case 0:case 1:h=E;break;case 4:return y.label++,{value:E[1],done:!1};case 5:y.label++,l=E[1],E=[0];continue;case 7:E=y.ops.pop(),y.trys.pop();continue;default:if(h=y.trys,!(h=h.length>0&&h[h.length-1])&&(E[0]===6||E[0]===2)){y=0;continue}if(E[0]===3&&(!h||E[1]>h[0]&&E[1]<h[3])){y.label=E[1];break}if(E[0]===6&&y.label<h[1]){y.label=h[1],h=E;break}if(h&&y.label<h[2]){y.label=h[2],y.ops.push(E);break}h[2]&&y.ops.pop(),y.trys.pop();continue}E=g.call(f,y)}catch(q){E=[6,q],l=0}finally{I=h=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},ee=function(f,g,y,I){I===void 0&&(I=y),f[I]=g[y]},D=function(f,g){for(var y in f)y!=="default"&&!g.hasOwnProperty(y)&&(g[y]=f[y])},$=function(f){var g=typeof Symbol=="function"&&Symbol.iterator,y=g&&f[g],I=0;if(y)return y.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&I>=f.length&&(f=void 0),{value:f&&f[I++],done:!f}}};throw new TypeError(g?"Object is not iterable.":"Symbol.iterator is not defined.")},K=function(f,g){var y=typeof Symbol=="function"&&f[Symbol.iterator];if(!y)return f;var I=y.call(f),l,h=[],P;try{for(;(g===void 0||g-- >0)&&!(l=I.next()).done;)h.push(l.value)}catch(M){P={error:M}}finally{try{l&&!l.done&&(y=I.return)&&y.call(I)}finally{if(P)throw P.error}}return h},X=function(){for(var f=[],g=0;g<arguments.length;g++)f=f.concat(K(arguments[g]));return f},Q=function(){for(var f=0,g=0,y=arguments.length;g<y;g++)f+=arguments[g].length;for(var I=Array(f),l=0,g=0;g<y;g++)for(var h=arguments[g],P=0,M=h.length;P<M;P++,l++)I[l]=h[P];return I},F=function(f){return this instanceof F?(this.v=f,this):new F(f)},se=function(f,g,y){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var I=y.apply(f,g||[]),l,h=[];return l={},P("next"),P("throw"),P("return"),l[Symbol.asyncIterator]=function(){return this},l;function P(Y){I[Y]&&(l[Y]=function(ye){return new Promise(function(ot,we){h.push([Y,ye,ot,we])>1||M(Y,ye)})})}function M(Y,ye){try{H(I[Y](ye))}catch(ot){W(h[0][3],ot)}}function H(Y){Y.value instanceof F?Promise.resolve(Y.value.v).then(E,q):W(h[0][2],Y)}function E(Y){M("next",Y)}function q(Y){M("throw",Y)}function W(Y,ye){Y(ye),h.shift(),h.length&&M(h[0][0],h[0][1])}},ce=function(f){var g,y;return g={},I("next"),I("throw",function(l){throw l}),I("return"),g[Symbol.iterator]=function(){return this},g;function I(l,h){g[l]=f[l]?function(P){return(y=!y)?{value:F(f[l](P)),done:l==="return"}:h?h(P):P}:h}},pe=function(f){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var g=f[Symbol.asyncIterator],y;return g?g.call(f):(f=typeof $=="function"?$(f):f[Symbol.iterator](),y={},I("next"),I("throw"),I("return"),y[Symbol.asyncIterator]=function(){return this},y);function I(h){y[h]=f[h]&&function(P){return new Promise(function(M,H){P=f[h](P),l(M,H,P.done,P.value)})}}function l(h,P,M,H){Promise.resolve(H).then(function(E){h({value:E,done:M})},P)}},le=function(f,g){return Object.defineProperty?Object.defineProperty(f,"raw",{value:g}):f.raw=g,f},ue=function(f){if(f&&f.__esModule)return f;var g={};if(f!=null)for(var y in f)Object.hasOwnProperty.call(f,y)&&(g[y]=f[y]);return g.default=f,g},ne=function(f){return f&&f.__esModule?f:{default:f}},he=function(f,g){if(!g.has(f))throw new TypeError("attempted to get private field on non-instance");return g.get(f)},fe=function(f,g,y){if(!g.has(f))throw new TypeError("attempted to set private field on non-instance");return g.set(f,y),y},j("__extends",i),j("__assign",r),j("__rest",s),j("__decorate",o),j("__param",p),j("__metadata",_),j("__awaiter",b),j("__generator",S),j("__exportStar",D),j("__createBinding",ee),j("__values",$),j("__read",K),j("__spread",X),j("__spreadArrays",Q),j("__await",F),j("__asyncGenerator",se),j("__asyncDelegator",ce),j("__asyncValues",pe),j("__makeTemplateObject",le),j("__importStar",ue),j("__importDefault",ne),j("__classPrivateFieldGet",he),j("__classPrivateFieldSet",fe)})})(Kl);function vm(a){try{return JSON.stringify(a)}catch{return'"[Circular]"'}}var _m=mm;function mm(a,i,r){var s=r&&r.stringify||vm,o=1;if(typeof a=="object"&&a!==null){var p=i.length+o;if(p===1)return a;var _=new Array(p);_[0]=s(a);for(var b=1;b<p;b++)_[b]=s(i[b]);return _.join(" ")}if(typeof a!="string")return a;var S=i.length;if(S===0)return a;for(var D="",$=1-o,K=-1,X=a&&a.length||0,Q=0;Q<X;){if(a.charCodeAt(Q)===37&&Q+1<X){switch(K=K>-1?K:0,a.charCodeAt(Q+1)){case 100:case 102:if($>=S||i[$]==null)break;K<Q&&(D+=a.slice(K,Q)),D+=Number(i[$]),K=Q+2,Q++;break;case 105:if($>=S||i[$]==null)break;K<Q&&(D+=a.slice(K,Q)),D+=Math.floor(Number(i[$])),K=Q+2,Q++;break;case 79:case 111:case 106:if($>=S||i[$]===void 0)break;K<Q&&(D+=a.slice(K,Q));var F=typeof i[$];if(F==="string"){D+="'"+i[$]+"'",K=Q+2,Q++;break}if(F==="function"){D+=i[$].name||"<anonymous>",K=Q+2,Q++;break}D+=s(i[$]),K=Q+2,Q++;break;case 115:if($>=S)break;K<Q&&(D+=a.slice(K,Q)),D+=String(i[$]),K=Q+2,Q++;break;case 37:K<Q&&(D+=a.slice(K,Q)),D+="%",K=Q+2,Q++,$--;break}++$}++Q}return K===-1?a:(K<X&&(D+=a.slice(K)),D)}const Gh=_m;var wm=kr;const Qn=Tm().console||{},bm={mapHttpRequest:ao,mapHttpResponse:ao,wrapRequestSerializer:ic,wrapResponseSerializer:ic,wrapErrorSerializer:ic,req:ao,res:ao,err:Pm};function Em(a,i){return Array.isArray(a)?a.filter(function(s){return s!=="!stdSerializers.err"}):a===!0?Object.keys(i):!1}function kr(a){a=a||{},a.browser=a.browser||{};const i=a.browser.transmit;if(i&&typeof i.send!="function")throw Error("pino: transmit option must have a send function");const r=a.browser.write||Qn;a.browser.write&&(a.browser.asObject=!0);const s=a.serializers||{},o=Em(a.browser.serialize,s);let p=a.browser.serialize;Array.isArray(a.browser.serialize)&&a.browser.serialize.indexOf("!stdSerializers.err")>-1&&(p=!1);const _=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),a.enabled===!1&&(a.level="silent");const b=a.level||"info",S=Object.create(r);S.log||(S.log=Yn),Object.defineProperty(S,"levelVal",{get:$}),Object.defineProperty(S,"level",{get:K,set:X});const D={transmit:i,serialize:o,asObject:a.browser.asObject,levels:_,timestamp:Om(a)};S.levels=kr.levels,S.level=b,S.setMaxListeners=S.getMaxListeners=S.emit=S.addListener=S.on=S.prependListener=S.once=S.prependOnceListener=S.removeListener=S.removeAllListeners=S.listeners=S.listenerCount=S.eventNames=S.write=S.flush=Yn,S.serializers=s,S._serialize=o,S._stdErrSerialize=p,S.child=Q,i&&(S._logEvent=gc());function $(){return this.level==="silent"?1/0:this.levels.values[this.level]}function K(){return this._level}function X(F){if(F!=="silent"&&!this.levels.values[F])throw Error("unknown level "+F);this._level=F,hn(D,S,"error","log"),hn(D,S,"fatal","error"),hn(D,S,"warn","error"),hn(D,S,"info","log"),hn(D,S,"debug","log"),hn(D,S,"trace","log")}function Q(F,se){if(!F)throw new Error("missing bindings for child Pino");se=se||{},o&&F.serializers&&(se.serializers=F.serializers);const ce=se.serializers;if(o&&ce){var pe=Object.assign({},s,ce),le=a.browser.serialize===!0?Object.keys(pe):o;delete F.serializers,xo([F],le,pe,this._stdErrSerialize)}function ue(ne){this._childLevel=(ne._childLevel|0)+1,this.error=ln(ne,F,"error"),this.fatal=ln(ne,F,"fatal"),this.warn=ln(ne,F,"warn"),this.info=ln(ne,F,"info"),this.debug=ln(ne,F,"debug"),this.trace=ln(ne,F,"trace"),pe&&(this.serializers=pe,this._serialize=le),i&&(this._logEvent=gc([].concat(ne._logEvent.bindings,F)))}return ue.prototype=this,new ue(this)}return S}kr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};kr.stdSerializers=bm;kr.stdTimeFunctions=Object.assign({},{nullTime:Gl,epochTime:Wl,unixTime:Am,isoTime:Rm});function hn(a,i,r,s){const o=Object.getPrototypeOf(i);i[r]=i.levelVal>i.levels.values[r]?Yn:o[r]?o[r]:Qn[r]||Qn[s]||Yn,Im(a,i,r)}function Im(a,i,r){!a.transmit&&i[r]===Yn||(i[r]=function(s){return function(){const p=a.timestamp(),_=new Array(arguments.length),b=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Qn?Qn:this;for(var S=0;S<_.length;S++)_[S]=arguments[S];if(a.serialize&&!a.asObject&&xo(_,this._serialize,this.serializers,this._stdErrSerialize),a.asObject?s.call(b,xm(this,r,_,p)):s.apply(b,_),a.transmit){const D=a.transmit.level||i.level,$=kr.levels.values[D],K=kr.levels.values[r];if(K<$)return;Sm(this,{ts:p,methodLevel:r,methodValue:K,transmitLevel:D,transmitValue:kr.levels.values[a.transmit.level||i.level],send:a.transmit.send,val:i.levelVal},_)}}}(i[r]))}function xm(a,i,r,s){a._serialize&&xo(r,a._serialize,a.serializers,a._stdErrSerialize);const o=r.slice();let p=o[0];const _={};s&&(_.time=s),_.level=kr.levels.values[i];let b=(a._childLevel|0)+1;if(b<1&&(b=1),p!==null&&typeof p=="object"){for(;b--&&typeof o[0]=="object";)Object.assign(_,o.shift());p=o.length?Gh(o.shift(),o):void 0}else typeof p=="string"&&(p=Gh(o.shift(),o));return p!==void 0&&(_.msg=p),_}function xo(a,i,r,s){for(const o in a)if(s&&a[o]instanceof Error)a[o]=kr.stdSerializers.err(a[o]);else if(typeof a[o]=="object"&&!Array.isArray(a[o]))for(const p in a[o])i&&i.indexOf(p)>-1&&p in r&&(a[o][p]=r[p](a[o][p]))}function ln(a,i,r){return function(){const s=new Array(1+arguments.length);s[0]=i;for(var o=1;o<s.length;o++)s[o]=arguments[o-1];return a[r].apply(this,s)}}function Sm(a,i,r){const s=i.send,o=i.ts,p=i.methodLevel,_=i.methodValue,b=i.val,S=a._logEvent.bindings;xo(r,a._serialize||Object.keys(a.serializers),a.serializers,a._stdErrSerialize===void 0?!0:a._stdErrSerialize),a._logEvent.ts=o,a._logEvent.messages=r.filter(function(D){return S.indexOf(D)===-1}),a._logEvent.level.label=p,a._logEvent.level.value=_,s(p,a._logEvent,b),a._logEvent=gc(S)}function gc(a){return{ts:0,messages:[],bindings:a||[],level:{label:"",value:0}}}function Pm(a){const i={type:a.constructor.name,msg:a.message,stack:a.stack};for(const r in a)i[r]===void 0&&(i[r]=a[r]);return i}function Om(a){return typeof a.timestamp=="function"?a.timestamp:a.timestamp===!1?Gl:Wl}function ao(){return{}}function ic(a){return a}function Yn(){}function Gl(){return!1}function Wl(){return Date.now()}function Am(){return Math.round(Date.now()/1e3)}function Rm(){return new Date(Date.now()).toISOString()}function Tm(){function a(i){return typeof i<"u"&&i}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return a(self)||a(window)||a(this)||{}}}var zi={};Object.defineProperty(zi,"__esModule",{value:!0});zi.PINO_CUSTOM_CONTEXT_KEY=zi.PINO_LOGGER_DEFAULTS=void 0;zi.PINO_LOGGER_DEFAULTS={level:"info"};zi.PINO_CUSTOM_CONTEXT_KEY="custom_context";var ur={};Object.defineProperty(ur,"__esModule",{value:!0});ur.generateChildLogger=ur.formatChildLoggerContext=ur.getLoggerContext=ur.setBrowserLoggerContext=ur.getBrowserLoggerContext=ur.getDefaultLoggerOptions=void 0;const wn=zi;function Cm(a){return Object.assign(Object.assign({},a),{level:a?.level||wn.PINO_LOGGER_DEFAULTS.level})}ur.getDefaultLoggerOptions=Cm;function Jl(a,i=wn.PINO_CUSTOM_CONTEXT_KEY){return a[i]||""}ur.getBrowserLoggerContext=Jl;function Ql(a,i,r=wn.PINO_CUSTOM_CONTEXT_KEY){return a[r]=i,a}ur.setBrowserLoggerContext=Ql;function Yl(a,i=wn.PINO_CUSTOM_CONTEXT_KEY){let r="";return typeof a.bindings>"u"?r=Jl(a,i):r=a.bindings().context||"",r}ur.getLoggerContext=Yl;function Xl(a,i,r=wn.PINO_CUSTOM_CONTEXT_KEY){const s=Yl(a,r);return s.trim()?`${s}/${i}`:i}ur.formatChildLoggerContext=Xl;function Dm(a,i,r=wn.PINO_CUSTOM_CONTEXT_KEY){const s=Xl(a,i,r),o=a.child({context:s});return Ql(o,s,r)}ur.generateChildLogger=Dm;(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.pino=void 0;const i=Kl.exports,r=i.__importDefault(wm);Object.defineProperty(a,"pino",{enumerable:!0,get:function(){return r.default}}),i.__exportStar(zi,a),i.__exportStar(ur,a)})(Fe);class Nm extends Ui{constructor(i){super(),this.opts=i,this.protocol="wc",this.version=2}}class Fm extends Ui{constructor(i,r){super(),this.core=i,this.logger=r,this.records=new Map}}class jm{constructor(i,r){this.logger=i,this.core=r}}class $m extends Ui{constructor(i,r){super(),this.relayer=i,this.logger=r}}class Lm extends Ui{constructor(i){super()}}class qm{constructor(i,r,s,o){this.core=i,this.logger=r,this.name=s}}class Mm extends Ui{constructor(i,r){super(),this.relayer=i,this.logger=r}}class zm extends Ui{constructor(i,r){super(),this.core=i,this.logger=r}}class Um{constructor(i,r){this.projectId=i,this.logger=r}}class Hm{constructor(i){this.opts=i,this.protocol="wc",this.version=2}}class Bm{constructor(i){this.client=i}}const km=a=>JSON.stringify(a,(i,r)=>typeof r=="bigint"?r.toString()+"n":r),Vm=a=>{const i=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=a.replace(i,'$1"$2n"$3');return JSON.parse(r,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Rc(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return Vm(a)}catch{return a}}function Xn(a){return typeof a=="string"?a:km(a)||""}var Tc={},Zl={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var i=p_,r=$l;a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var s=function(){function b(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return b.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},b.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},b.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},b.prototype.update=function(S,D){if(D===void 0&&(D=S.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var $=0;if(this._bytesHashed+=D,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&D>0;)this._buffer[this._bufferLength++]=S[$++],D--;this._bufferLength===this.blockSize&&(p(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(D>=this.blockSize&&($=p(this._tempHi,this._tempLo,this._stateHi,this._stateLo,S,$,D),D%=this.blockSize);D>0;)this._buffer[this._bufferLength++]=S[$++],D--;return this},b.prototype.finish=function(S){if(!this._finished){var D=this._bytesHashed,$=this._bufferLength,K=D/536870912|0,X=D<<3,Q=D%128<112?128:256;this._buffer[$]=128;for(var F=$+1;F<Q-8;F++)this._buffer[F]=0;i.writeUint32BE(K,this._buffer,Q-8),i.writeUint32BE(X,this._buffer,Q-4),p(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,Q),this._finished=!0}for(var F=0;F<this.digestLength/8;F++)i.writeUint32BE(this._stateHi[F],S,F*8),i.writeUint32BE(this._stateLo[F],S,F*8+4);return this},b.prototype.digest=function(){var S=new Uint8Array(this.digestLength);return this.finish(S),S},b.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},b.prototype.restoreState=function(S){return this._stateHi.set(S.stateHi),this._stateLo.set(S.stateLo),this._bufferLength=S.bufferLength,S.buffer&&this._buffer.set(S.buffer),this._bytesHashed=S.bytesHashed,this._finished=!1,this},b.prototype.cleanSavedState=function(S){r.wipe(S.stateHi),r.wipe(S.stateLo),S.buffer&&r.wipe(S.buffer),S.bufferLength=0,S.bytesHashed=0},b}();a.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function p(b,S,D,$,K,X,Q){for(var F=D[0],se=D[1],ce=D[2],pe=D[3],le=D[4],ue=D[5],ne=D[6],he=D[7],fe=$[0],ee=$[1],j=$[2],Se=$[3],f=$[4],g=$[5],y=$[6],I=$[7],l,h,P,M,H,E,q,W;Q>=128;){for(var Y=0;Y<16;Y++){var ye=8*Y+X;b[Y]=i.readUint32BE(K,ye),S[Y]=i.readUint32BE(K,ye+4)}for(var Y=0;Y<80;Y++){var ot=F,we=se,Or=ce,U=pe,z=le,N=ue,u=ne,A=he,oe=fe,me=ee,Pe=j,je=Se,Le=f,Te=g,St=y,wt=I;if(l=he,h=I,H=h&65535,E=h>>>16,q=l&65535,W=l>>>16,l=(le>>>14|f<<32-14)^(le>>>18|f<<32-18)^(f>>>41-32|le<<32-(41-32)),h=(f>>>14|le<<32-14)^(f>>>18|le<<32-18)^(le>>>41-32|f<<32-(41-32)),H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,l=le&ue^~le&ne,h=f&g^~f&y,H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,l=o[Y*2],h=o[Y*2+1],H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,l=b[Y%16],h=S[Y%16],H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,E+=H>>>16,q+=E>>>16,W+=q>>>16,P=q&65535|W<<16,M=H&65535|E<<16,l=P,h=M,H=h&65535,E=h>>>16,q=l&65535,W=l>>>16,l=(F>>>28|fe<<32-28)^(fe>>>34-32|F<<32-(34-32))^(fe>>>39-32|F<<32-(39-32)),h=(fe>>>28|F<<32-28)^(F>>>34-32|fe<<32-(34-32))^(F>>>39-32|fe<<32-(39-32)),H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,l=F&se^F&ce^se&ce,h=fe&ee^fe&j^ee&j,H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,E+=H>>>16,q+=E>>>16,W+=q>>>16,A=q&65535|W<<16,wt=H&65535|E<<16,l=U,h=je,H=h&65535,E=h>>>16,q=l&65535,W=l>>>16,l=P,h=M,H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,E+=H>>>16,q+=E>>>16,W+=q>>>16,U=q&65535|W<<16,je=H&65535|E<<16,se=ot,ce=we,pe=Or,le=U,ue=z,ne=N,he=u,F=A,ee=oe,j=me,Se=Pe,f=je,g=Le,y=Te,I=St,fe=wt,Y%16===15)for(var ye=0;ye<16;ye++)l=b[ye],h=S[ye],H=h&65535,E=h>>>16,q=l&65535,W=l>>>16,l=b[(ye+9)%16],h=S[(ye+9)%16],H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,P=b[(ye+1)%16],M=S[(ye+1)%16],l=(P>>>1|M<<32-1)^(P>>>8|M<<32-8)^P>>>7,h=(M>>>1|P<<32-1)^(M>>>8|P<<32-8)^(M>>>7|P<<32-7),H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,P=b[(ye+14)%16],M=S[(ye+14)%16],l=(P>>>19|M<<32-19)^(M>>>61-32|P<<32-(61-32))^P>>>6,h=(M>>>19|P<<32-19)^(P>>>61-32|M<<32-(61-32))^(M>>>6|P<<32-6),H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,E+=H>>>16,q+=E>>>16,W+=q>>>16,b[ye]=q&65535|W<<16,S[ye]=H&65535|E<<16}l=F,h=fe,H=h&65535,E=h>>>16,q=l&65535,W=l>>>16,l=D[0],h=$[0],H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,E+=H>>>16,q+=E>>>16,W+=q>>>16,D[0]=F=q&65535|W<<16,$[0]=fe=H&65535|E<<16,l=se,h=ee,H=h&65535,E=h>>>16,q=l&65535,W=l>>>16,l=D[1],h=$[1],H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,E+=H>>>16,q+=E>>>16,W+=q>>>16,D[1]=se=q&65535|W<<16,$[1]=ee=H&65535|E<<16,l=ce,h=j,H=h&65535,E=h>>>16,q=l&65535,W=l>>>16,l=D[2],h=$[2],H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,E+=H>>>16,q+=E>>>16,W+=q>>>16,D[2]=ce=q&65535|W<<16,$[2]=j=H&65535|E<<16,l=pe,h=Se,H=h&65535,E=h>>>16,q=l&65535,W=l>>>16,l=D[3],h=$[3],H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,E+=H>>>16,q+=E>>>16,W+=q>>>16,D[3]=pe=q&65535|W<<16,$[3]=Se=H&65535|E<<16,l=le,h=f,H=h&65535,E=h>>>16,q=l&65535,W=l>>>16,l=D[4],h=$[4],H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,E+=H>>>16,q+=E>>>16,W+=q>>>16,D[4]=le=q&65535|W<<16,$[4]=f=H&65535|E<<16,l=ue,h=g,H=h&65535,E=h>>>16,q=l&65535,W=l>>>16,l=D[5],h=$[5],H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,E+=H>>>16,q+=E>>>16,W+=q>>>16,D[5]=ue=q&65535|W<<16,$[5]=g=H&65535|E<<16,l=ne,h=y,H=h&65535,E=h>>>16,q=l&65535,W=l>>>16,l=D[6],h=$[6],H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,E+=H>>>16,q+=E>>>16,W+=q>>>16,D[6]=ne=q&65535|W<<16,$[6]=y=H&65535|E<<16,l=he,h=I,H=h&65535,E=h>>>16,q=l&65535,W=l>>>16,l=D[7],h=$[7],H+=h&65535,E+=h>>>16,q+=l&65535,W+=l>>>16,E+=H>>>16,q+=E>>>16,W+=q>>>16,D[7]=he=q&65535|W<<16,$[7]=I=H&65535|E<<16,X+=128,Q-=128}return X}function _(b){var S=new s;S.update(b);var D=S.digest();return S.clean(),D}a.hash=_})(Zl);(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const i=Ll,r=Zl,s=$l;a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function o(U){const z=new Float64Array(16);if(U)for(let N=0;N<U.length;N++)z[N]=U[N];return z}const p=new Uint8Array(32);p[0]=9;const _=o(),b=o([1]),S=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),D=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),$=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),K=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),X=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Q(U,z){for(let N=0;N<16;N++)U[N]=z[N]|0}function F(U){let z=1;for(let N=0;N<16;N++){let u=U[N]+z+65535;z=Math.floor(u/65536),U[N]=u-z*65536}U[0]+=z-1+37*(z-1)}function se(U,z,N){const u=~(N-1);for(let A=0;A<16;A++){const oe=u&(U[A]^z[A]);U[A]^=oe,z[A]^=oe}}function ce(U,z){const N=o(),u=o();for(let A=0;A<16;A++)u[A]=z[A];F(u),F(u),F(u);for(let A=0;A<2;A++){N[0]=u[0]-65517;for(let me=1;me<15;me++)N[me]=u[me]-65535-(N[me-1]>>16&1),N[me-1]&=65535;N[15]=u[15]-32767-(N[14]>>16&1);const oe=N[15]>>16&1;N[14]&=65535,se(u,N,1-oe)}for(let A=0;A<16;A++)U[2*A]=u[A]&255,U[2*A+1]=u[A]>>8}function pe(U,z){let N=0;for(let u=0;u<32;u++)N|=U[u]^z[u];return(1&N-1>>>8)-1}function le(U,z){const N=new Uint8Array(32),u=new Uint8Array(32);return ce(N,U),ce(u,z),pe(N,u)}function ue(U){const z=new Uint8Array(32);return ce(z,U),z[0]&1}function ne(U,z){for(let N=0;N<16;N++)U[N]=z[2*N]+(z[2*N+1]<<8);U[15]&=32767}function he(U,z,N){for(let u=0;u<16;u++)U[u]=z[u]+N[u]}function fe(U,z,N){for(let u=0;u<16;u++)U[u]=z[u]-N[u]}function ee(U,z,N){let u,A,oe=0,me=0,Pe=0,je=0,Le=0,Te=0,St=0,wt=0,at=0,Me=0,Ye=0,Xe=0,ct=0,Be=0,Ze=0,$e=0,Ve=0,lt=0,Ue=0,Pt=0,jt=0,Ut=0,Ht=0,qt=0,Wt=0,tr=0,Lr=0,Jt=0,Vr=0,ci=0,Pi=0,ft=N[0],rt=N[1],pt=N[2],dt=N[3],ut=N[4],it=N[5],Ot=N[6],At=N[7],gt=N[8],Rt=N[9],yt=N[10],bt=N[11],vt=N[12],Qe=N[13],Tt=N[14],Ct=N[15];u=z[0],oe+=u*ft,me+=u*rt,Pe+=u*pt,je+=u*dt,Le+=u*ut,Te+=u*it,St+=u*Ot,wt+=u*At,at+=u*gt,Me+=u*Rt,Ye+=u*yt,Xe+=u*bt,ct+=u*vt,Be+=u*Qe,Ze+=u*Tt,$e+=u*Ct,u=z[1],me+=u*ft,Pe+=u*rt,je+=u*pt,Le+=u*dt,Te+=u*ut,St+=u*it,wt+=u*Ot,at+=u*At,Me+=u*gt,Ye+=u*Rt,Xe+=u*yt,ct+=u*bt,Be+=u*vt,Ze+=u*Qe,$e+=u*Tt,Ve+=u*Ct,u=z[2],Pe+=u*ft,je+=u*rt,Le+=u*pt,Te+=u*dt,St+=u*ut,wt+=u*it,at+=u*Ot,Me+=u*At,Ye+=u*gt,Xe+=u*Rt,ct+=u*yt,Be+=u*bt,Ze+=u*vt,$e+=u*Qe,Ve+=u*Tt,lt+=u*Ct,u=z[3],je+=u*ft,Le+=u*rt,Te+=u*pt,St+=u*dt,wt+=u*ut,at+=u*it,Me+=u*Ot,Ye+=u*At,Xe+=u*gt,ct+=u*Rt,Be+=u*yt,Ze+=u*bt,$e+=u*vt,Ve+=u*Qe,lt+=u*Tt,Ue+=u*Ct,u=z[4],Le+=u*ft,Te+=u*rt,St+=u*pt,wt+=u*dt,at+=u*ut,Me+=u*it,Ye+=u*Ot,Xe+=u*At,ct+=u*gt,Be+=u*Rt,Ze+=u*yt,$e+=u*bt,Ve+=u*vt,lt+=u*Qe,Ue+=u*Tt,Pt+=u*Ct,u=z[5],Te+=u*ft,St+=u*rt,wt+=u*pt,at+=u*dt,Me+=u*ut,Ye+=u*it,Xe+=u*Ot,ct+=u*At,Be+=u*gt,Ze+=u*Rt,$e+=u*yt,Ve+=u*bt,lt+=u*vt,Ue+=u*Qe,Pt+=u*Tt,jt+=u*Ct,u=z[6],St+=u*ft,wt+=u*rt,at+=u*pt,Me+=u*dt,Ye+=u*ut,Xe+=u*it,ct+=u*Ot,Be+=u*At,Ze+=u*gt,$e+=u*Rt,Ve+=u*yt,lt+=u*bt,Ue+=u*vt,Pt+=u*Qe,jt+=u*Tt,Ut+=u*Ct,u=z[7],wt+=u*ft,at+=u*rt,Me+=u*pt,Ye+=u*dt,Xe+=u*ut,ct+=u*it,Be+=u*Ot,Ze+=u*At,$e+=u*gt,Ve+=u*Rt,lt+=u*yt,Ue+=u*bt,Pt+=u*vt,jt+=u*Qe,Ut+=u*Tt,Ht+=u*Ct,u=z[8],at+=u*ft,Me+=u*rt,Ye+=u*pt,Xe+=u*dt,ct+=u*ut,Be+=u*it,Ze+=u*Ot,$e+=u*At,Ve+=u*gt,lt+=u*Rt,Ue+=u*yt,Pt+=u*bt,jt+=u*vt,Ut+=u*Qe,Ht+=u*Tt,qt+=u*Ct,u=z[9],Me+=u*ft,Ye+=u*rt,Xe+=u*pt,ct+=u*dt,Be+=u*ut,Ze+=u*it,$e+=u*Ot,Ve+=u*At,lt+=u*gt,Ue+=u*Rt,Pt+=u*yt,jt+=u*bt,Ut+=u*vt,Ht+=u*Qe,qt+=u*Tt,Wt+=u*Ct,u=z[10],Ye+=u*ft,Xe+=u*rt,ct+=u*pt,Be+=u*dt,Ze+=u*ut,$e+=u*it,Ve+=u*Ot,lt+=u*At,Ue+=u*gt,Pt+=u*Rt,jt+=u*yt,Ut+=u*bt,Ht+=u*vt,qt+=u*Qe,Wt+=u*Tt,tr+=u*Ct,u=z[11],Xe+=u*ft,ct+=u*rt,Be+=u*pt,Ze+=u*dt,$e+=u*ut,Ve+=u*it,lt+=u*Ot,Ue+=u*At,Pt+=u*gt,jt+=u*Rt,Ut+=u*yt,Ht+=u*bt,qt+=u*vt,Wt+=u*Qe,tr+=u*Tt,Lr+=u*Ct,u=z[12],ct+=u*ft,Be+=u*rt,Ze+=u*pt,$e+=u*dt,Ve+=u*ut,lt+=u*it,Ue+=u*Ot,Pt+=u*At,jt+=u*gt,Ut+=u*Rt,Ht+=u*yt,qt+=u*bt,Wt+=u*vt,tr+=u*Qe,Lr+=u*Tt,Jt+=u*Ct,u=z[13],Be+=u*ft,Ze+=u*rt,$e+=u*pt,Ve+=u*dt,lt+=u*ut,Ue+=u*it,Pt+=u*Ot,jt+=u*At,Ut+=u*gt,Ht+=u*Rt,qt+=u*yt,Wt+=u*bt,tr+=u*vt,Lr+=u*Qe,Jt+=u*Tt,Vr+=u*Ct,u=z[14],Ze+=u*ft,$e+=u*rt,Ve+=u*pt,lt+=u*dt,Ue+=u*ut,Pt+=u*it,jt+=u*Ot,Ut+=u*At,Ht+=u*gt,qt+=u*Rt,Wt+=u*yt,tr+=u*bt,Lr+=u*vt,Jt+=u*Qe,Vr+=u*Tt,ci+=u*Ct,u=z[15],$e+=u*ft,Ve+=u*rt,lt+=u*pt,Ue+=u*dt,Pt+=u*ut,jt+=u*it,Ut+=u*Ot,Ht+=u*At,qt+=u*gt,Wt+=u*Rt,tr+=u*yt,Lr+=u*bt,Jt+=u*vt,Vr+=u*Qe,ci+=u*Tt,Pi+=u*Ct,oe+=38*Ve,me+=38*lt,Pe+=38*Ue,je+=38*Pt,Le+=38*jt,Te+=38*Ut,St+=38*Ht,wt+=38*qt,at+=38*Wt,Me+=38*tr,Ye+=38*Lr,Xe+=38*Jt,ct+=38*Vr,Be+=38*ci,Ze+=38*Pi,A=1,u=oe+A+65535,A=Math.floor(u/65536),oe=u-A*65536,u=me+A+65535,A=Math.floor(u/65536),me=u-A*65536,u=Pe+A+65535,A=Math.floor(u/65536),Pe=u-A*65536,u=je+A+65535,A=Math.floor(u/65536),je=u-A*65536,u=Le+A+65535,A=Math.floor(u/65536),Le=u-A*65536,u=Te+A+65535,A=Math.floor(u/65536),Te=u-A*65536,u=St+A+65535,A=Math.floor(u/65536),St=u-A*65536,u=wt+A+65535,A=Math.floor(u/65536),wt=u-A*65536,u=at+A+65535,A=Math.floor(u/65536),at=u-A*65536,u=Me+A+65535,A=Math.floor(u/65536),Me=u-A*65536,u=Ye+A+65535,A=Math.floor(u/65536),Ye=u-A*65536,u=Xe+A+65535,A=Math.floor(u/65536),Xe=u-A*65536,u=ct+A+65535,A=Math.floor(u/65536),ct=u-A*65536,u=Be+A+65535,A=Math.floor(u/65536),Be=u-A*65536,u=Ze+A+65535,A=Math.floor(u/65536),Ze=u-A*65536,u=$e+A+65535,A=Math.floor(u/65536),$e=u-A*65536,oe+=A-1+37*(A-1),A=1,u=oe+A+65535,A=Math.floor(u/65536),oe=u-A*65536,u=me+A+65535,A=Math.floor(u/65536),me=u-A*65536,u=Pe+A+65535,A=Math.floor(u/65536),Pe=u-A*65536,u=je+A+65535,A=Math.floor(u/65536),je=u-A*65536,u=Le+A+65535,A=Math.floor(u/65536),Le=u-A*65536,u=Te+A+65535,A=Math.floor(u/65536),Te=u-A*65536,u=St+A+65535,A=Math.floor(u/65536),St=u-A*65536,u=wt+A+65535,A=Math.floor(u/65536),wt=u-A*65536,u=at+A+65535,A=Math.floor(u/65536),at=u-A*65536,u=Me+A+65535,A=Math.floor(u/65536),Me=u-A*65536,u=Ye+A+65535,A=Math.floor(u/65536),Ye=u-A*65536,u=Xe+A+65535,A=Math.floor(u/65536),Xe=u-A*65536,u=ct+A+65535,A=Math.floor(u/65536),ct=u-A*65536,u=Be+A+65535,A=Math.floor(u/65536),Be=u-A*65536,u=Ze+A+65535,A=Math.floor(u/65536),Ze=u-A*65536,u=$e+A+65535,A=Math.floor(u/65536),$e=u-A*65536,oe+=A-1+37*(A-1),U[0]=oe,U[1]=me,U[2]=Pe,U[3]=je,U[4]=Le,U[5]=Te,U[6]=St,U[7]=wt,U[8]=at,U[9]=Me,U[10]=Ye,U[11]=Xe,U[12]=ct,U[13]=Be,U[14]=Ze,U[15]=$e}function j(U,z){ee(U,z,z)}function Se(U,z){const N=o();let u;for(u=0;u<16;u++)N[u]=z[u];for(u=253;u>=0;u--)j(N,N),u!==2&&u!==4&&ee(N,N,z);for(u=0;u<16;u++)U[u]=N[u]}function f(U,z){const N=o();let u;for(u=0;u<16;u++)N[u]=z[u];for(u=250;u>=0;u--)j(N,N),u!==1&&ee(N,N,z);for(u=0;u<16;u++)U[u]=N[u]}function g(U,z){const N=o(),u=o(),A=o(),oe=o(),me=o(),Pe=o(),je=o(),Le=o(),Te=o();fe(N,U[1],U[0]),fe(Te,z[1],z[0]),ee(N,N,Te),he(u,U[0],U[1]),he(Te,z[0],z[1]),ee(u,u,Te),ee(A,U[3],z[3]),ee(A,A,D),ee(oe,U[2],z[2]),he(oe,oe,oe),fe(me,u,N),fe(Pe,oe,A),he(je,oe,A),he(Le,u,N),ee(U[0],me,Pe),ee(U[1],Le,je),ee(U[2],je,Pe),ee(U[3],me,Le)}function y(U,z,N){for(let u=0;u<4;u++)se(U[u],z[u],N)}function I(U,z){const N=o(),u=o(),A=o();Se(A,z[2]),ee(N,z[0],A),ee(u,z[1],A),ce(U,u),U[31]^=ue(N)<<7}function l(U,z,N){Q(U[0],_),Q(U[1],b),Q(U[2],b),Q(U[3],_);for(let u=255;u>=0;--u){const A=N[u/8|0]>>(u&7)&1;y(U,z,A),g(z,U),g(U,U),y(U,z,A)}}function h(U,z){const N=[o(),o(),o(),o()];Q(N[0],$),Q(N[1],K),Q(N[2],b),ee(N[3],$,K),l(U,N,z)}function P(U){if(U.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const z=(0,r.hash)(U);z[0]&=248,z[31]&=127,z[31]|=64;const N=new Uint8Array(32),u=[o(),o(),o(),o()];h(u,z),I(N,u);const A=new Uint8Array(64);return A.set(U),A.set(N,32),{publicKey:N,secretKey:A}}a.generateKeyPairFromSeed=P;function M(U){const z=(0,i.randomBytes)(32,U),N=P(z);return(0,s.wipe)(z),N}a.generateKeyPair=M;function H(U){if(U.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(U.subarray(32))}a.extractPublicKeyFromSecretKey=H;const E=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function q(U,z){let N,u,A,oe;for(u=63;u>=32;--u){for(N=0,A=u-32,oe=u-12;A<oe;++A)z[A]+=N-16*z[u]*E[A-(u-32)],N=Math.floor((z[A]+128)/256),z[A]-=N*256;z[A]+=N,z[u]=0}for(N=0,A=0;A<32;A++)z[A]+=N-(z[31]>>4)*E[A],N=z[A]>>8,z[A]&=255;for(A=0;A<32;A++)z[A]-=N*E[A];for(u=0;u<32;u++)z[u+1]+=z[u]>>8,U[u]=z[u]&255}function W(U){const z=new Float64Array(64);for(let N=0;N<64;N++)z[N]=U[N];for(let N=0;N<64;N++)U[N]=0;q(U,z)}function Y(U,z){const N=new Float64Array(64),u=[o(),o(),o(),o()],A=(0,r.hash)(U.subarray(0,32));A[0]&=248,A[31]&=127,A[31]|=64;const oe=new Uint8Array(64);oe.set(A.subarray(32),32);const me=new r.SHA512;me.update(oe.subarray(32)),me.update(z);const Pe=me.digest();me.clean(),W(Pe),h(u,Pe),I(oe,u),me.reset(),me.update(oe.subarray(0,32)),me.update(U.subarray(32)),me.update(z);const je=me.digest();W(je);for(let Le=0;Le<32;Le++)N[Le]=Pe[Le];for(let Le=0;Le<32;Le++)for(let Te=0;Te<32;Te++)N[Le+Te]+=je[Le]*A[Te];return q(oe.subarray(32),N),oe}a.sign=Y;function ye(U,z){const N=o(),u=o(),A=o(),oe=o(),me=o(),Pe=o(),je=o();return Q(U[2],b),ne(U[1],z),j(A,U[1]),ee(oe,A,S),fe(A,A,U[2]),he(oe,U[2],oe),j(me,oe),j(Pe,me),ee(je,Pe,me),ee(N,je,A),ee(N,N,oe),f(N,N),ee(N,N,A),ee(N,N,oe),ee(N,N,oe),ee(U[0],N,oe),j(u,U[0]),ee(u,u,oe),le(u,A)&&ee(U[0],U[0],X),j(u,U[0]),ee(u,u,oe),le(u,A)?-1:(ue(U[0])===z[31]>>7&&fe(U[0],_,U[0]),ee(U[3],U[0],U[1]),0)}function ot(U,z,N){const u=new Uint8Array(32),A=[o(),o(),o(),o()],oe=[o(),o(),o(),o()];if(N.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(ye(oe,U))return!1;const me=new r.SHA512;me.update(N.subarray(0,32)),me.update(U),me.update(z);const Pe=me.digest();return W(Pe),l(A,oe,Pe),h(oe,N.subarray(32)),g(A,oe),I(u,A),!pe(N,u)}a.verify=ot;function we(U){let z=[o(),o(),o(),o()];if(ye(z,U))throw new Error("Ed25519: invalid public key");let N=o(),u=o(),A=z[1];he(N,b,A),fe(u,b,A),Se(u,u),ee(N,N,u);let oe=new Uint8Array(32);return ce(oe,N),oe}a.convertPublicKeyToX25519=we;function Or(U){const z=(0,r.hash)(U.subarray(0,32));z[0]&=248,z[31]&=127,z[31]|=64;const N=new Uint8Array(z.subarray(0,32));return(0,s.wipe)(z),N}a.convertSecretKeyToX25519=Or})(Tc);const Km="EdDSA",Gm="JWT",ef=".",tf="base64url",Wm="utf8",Jm="utf8",Qm=":",Ym="did",Xm="key",Wh="base58btc",Zm="z",e1="K36",t1=32;function yo(a){return _o(Ic(Xn(a),Wm),tf)}function rf(a){const i=Ic(e1,Wh),r=Zm+_o(d_([i,a]),Wh);return[Ym,Xm,r].join(Qm)}function r1(a){return _o(a,tf)}function i1(a){return Ic([yo(a.header),yo(a.payload)].join(ef),Jm)}function n1(a){return[yo(a.header),yo(a.payload),r1(a.signature)].join(ef)}function Jh(a=Ll.randomBytes(t1)){return Tc.generateKeyPairFromSeed(a)}async function s1(a,i,r,s,o=de.fromMiliseconds(Date.now())){const p={alg:Km,typ:Gm},_=rf(s.publicKey),b=o+r,S={iss:_,sub:a,aud:i,iat:o,exp:b},D=i1({header:p,payload:S}),$=Tc.sign(s.secretKey,D);return n1({header:p,payload:S,signature:$})}const o1="PARSE_ERROR",a1="INVALID_REQUEST",c1="METHOD_NOT_FOUND",u1="INVALID_PARAMS",nf="INTERNAL_ERROR",Cc="SERVER_ERROR",h1=[-32700,-32600,-32601,-32602,-32603],Wn={[o1]:{code:-32700,message:"Parse error"},[a1]:{code:-32600,message:"Invalid Request"},[c1]:{code:-32601,message:"Method not found"},[u1]:{code:-32602,message:"Invalid params"},[nf]:{code:-32603,message:"Internal error"},[Cc]:{code:-32e3,message:"Server error"}},sf=Cc;function l1(a){return h1.includes(a)}function Qh(a){return Object.keys(Wn).includes(a)?Wn[a]:Wn[sf]}function f1(a){const i=Object.values(Wn).find(r=>r.code===a);return i||Wn[sf]}function of(a,i,r){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${i}`):a}var af={},cf={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(a){var i,r,s,o,p,_,b,S,D,$,K,X,Q,F,se,ce,pe,le,ue,ne,he,fe,ee;(function(j){var Se=typeof mt=="object"?mt:typeof self=="object"?self:typeof this=="object"?this:{};j(f(Se,f(a.exports)));function f(g,y){return g!==Se&&(typeof Object.create=="function"?Object.defineProperty(g,"__esModule",{value:!0}):g.__esModule=!0),function(I,l){return g[I]=y?y(I,l):l}}})(function(j){var Se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,g){f.__proto__=g}||function(f,g){for(var y in g)g.hasOwnProperty(y)&&(f[y]=g[y])};i=function(f,g){Se(f,g);function y(){this.constructor=f}f.prototype=g===null?Object.create(g):(y.prototype=g.prototype,new y)},r=Object.assign||function(f){for(var g,y=1,I=arguments.length;y<I;y++){g=arguments[y];for(var l in g)Object.prototype.hasOwnProperty.call(g,l)&&(f[l]=g[l])}return f},s=function(f,g){var y={};for(var I in f)Object.prototype.hasOwnProperty.call(f,I)&&g.indexOf(I)<0&&(y[I]=f[I]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,I=Object.getOwnPropertySymbols(f);l<I.length;l++)g.indexOf(I[l])<0&&Object.prototype.propertyIsEnumerable.call(f,I[l])&&(y[I[l]]=f[I[l]]);return y},o=function(f,g,y,I){var l=arguments.length,h=l<3?g:I===null?I=Object.getOwnPropertyDescriptor(g,y):I,P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(f,g,y,I);else for(var M=f.length-1;M>=0;M--)(P=f[M])&&(h=(l<3?P(h):l>3?P(g,y,h):P(g,y))||h);return l>3&&h&&Object.defineProperty(g,y,h),h},p=function(f,g){return function(y,I){g(y,I,f)}},_=function(f,g){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(f,g)},b=function(f,g,y,I){function l(h){return h instanceof y?h:new y(function(P){P(h)})}return new(y||(y=Promise))(function(h,P){function M(q){try{E(I.next(q))}catch(W){P(W)}}function H(q){try{E(I.throw(q))}catch(W){P(W)}}function E(q){q.done?h(q.value):l(q.value).then(M,H)}E((I=I.apply(f,g||[])).next())})},S=function(f,g){var y={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},I,l,h,P;return P={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(P[Symbol.iterator]=function(){return this}),P;function M(E){return function(q){return H([E,q])}}function H(E){if(I)throw new TypeError("Generator is already executing.");for(;y;)try{if(I=1,l&&(h=E[0]&2?l.return:E[0]?l.throw||((h=l.return)&&h.call(l),0):l.next)&&!(h=h.call(l,E[1])).done)return h;switch(l=0,h&&(E=[E[0]&2,h.value]),E[0]){case 0:case 1:h=E;break;case 4:return y.label++,{value:E[1],done:!1};case 5:y.label++,l=E[1],E=[0];continue;case 7:E=y.ops.pop(),y.trys.pop();continue;default:if(h=y.trys,!(h=h.length>0&&h[h.length-1])&&(E[0]===6||E[0]===2)){y=0;continue}if(E[0]===3&&(!h||E[1]>h[0]&&E[1]<h[3])){y.label=E[1];break}if(E[0]===6&&y.label<h[1]){y.label=h[1],h=E;break}if(h&&y.label<h[2]){y.label=h[2],y.ops.push(E);break}h[2]&&y.ops.pop(),y.trys.pop();continue}E=g.call(f,y)}catch(q){E=[6,q],l=0}finally{I=h=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},ee=function(f,g,y,I){I===void 0&&(I=y),f[I]=g[y]},D=function(f,g){for(var y in f)y!=="default"&&!g.hasOwnProperty(y)&&(g[y]=f[y])},$=function(f){var g=typeof Symbol=="function"&&Symbol.iterator,y=g&&f[g],I=0;if(y)return y.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&I>=f.length&&(f=void 0),{value:f&&f[I++],done:!f}}};throw new TypeError(g?"Object is not iterable.":"Symbol.iterator is not defined.")},K=function(f,g){var y=typeof Symbol=="function"&&f[Symbol.iterator];if(!y)return f;var I=y.call(f),l,h=[],P;try{for(;(g===void 0||g-- >0)&&!(l=I.next()).done;)h.push(l.value)}catch(M){P={error:M}}finally{try{l&&!l.done&&(y=I.return)&&y.call(I)}finally{if(P)throw P.error}}return h},X=function(){for(var f=[],g=0;g<arguments.length;g++)f=f.concat(K(arguments[g]));return f},Q=function(){for(var f=0,g=0,y=arguments.length;g<y;g++)f+=arguments[g].length;for(var I=Array(f),l=0,g=0;g<y;g++)for(var h=arguments[g],P=0,M=h.length;P<M;P++,l++)I[l]=h[P];return I},F=function(f){return this instanceof F?(this.v=f,this):new F(f)},se=function(f,g,y){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var I=y.apply(f,g||[]),l,h=[];return l={},P("next"),P("throw"),P("return"),l[Symbol.asyncIterator]=function(){return this},l;function P(Y){I[Y]&&(l[Y]=function(ye){return new Promise(function(ot,we){h.push([Y,ye,ot,we])>1||M(Y,ye)})})}function M(Y,ye){try{H(I[Y](ye))}catch(ot){W(h[0][3],ot)}}function H(Y){Y.value instanceof F?Promise.resolve(Y.value.v).then(E,q):W(h[0][2],Y)}function E(Y){M("next",Y)}function q(Y){M("throw",Y)}function W(Y,ye){Y(ye),h.shift(),h.length&&M(h[0][0],h[0][1])}},ce=function(f){var g,y;return g={},I("next"),I("throw",function(l){throw l}),I("return"),g[Symbol.iterator]=function(){return this},g;function I(l,h){g[l]=f[l]?function(P){return(y=!y)?{value:F(f[l](P)),done:l==="return"}:h?h(P):P}:h}},pe=function(f){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var g=f[Symbol.asyncIterator],y;return g?g.call(f):(f=typeof $=="function"?$(f):f[Symbol.iterator](),y={},I("next"),I("throw"),I("return"),y[Symbol.asyncIterator]=function(){return this},y);function I(h){y[h]=f[h]&&function(P){return new Promise(function(M,H){P=f[h](P),l(M,H,P.done,P.value)})}}function l(h,P,M,H){Promise.resolve(H).then(function(E){h({value:E,done:M})},P)}},le=function(f,g){return Object.defineProperty?Object.defineProperty(f,"raw",{value:g}):f.raw=g,f},ue=function(f){if(f&&f.__esModule)return f;var g={};if(f!=null)for(var y in f)Object.hasOwnProperty.call(f,y)&&(g[y]=f[y]);return g.default=f,g},ne=function(f){return f&&f.__esModule?f:{default:f}},he=function(f,g){if(!g.has(f))throw new TypeError("attempted to get private field on non-instance");return g.get(f)},fe=function(f,g,y){if(!g.has(f))throw new TypeError("attempted to set private field on non-instance");return g.set(f,y),y},j("__extends",i),j("__assign",r),j("__rest",s),j("__decorate",o),j("__param",p),j("__metadata",_),j("__awaiter",b),j("__generator",S),j("__exportStar",D),j("__createBinding",ee),j("__values",$),j("__read",K),j("__spread",X),j("__spreadArrays",Q),j("__await",F),j("__asyncGenerator",se),j("__asyncDelegator",ce),j("__asyncValues",pe),j("__makeTemplateObject",le),j("__importStar",ue),j("__importDefault",ne),j("__classPrivateFieldGet",he),j("__classPrivateFieldSet",fe)})})(cf);var bi={};Object.defineProperty(bi,"__esModule",{value:!0});bi.isBrowserCryptoAvailable=bi.getSubtleCrypto=bi.getBrowerCrypto=void 0;function Dc(){return(mt===null||mt===void 0?void 0:mt.crypto)||(mt===null||mt===void 0?void 0:mt.msCrypto)||{}}bi.getBrowerCrypto=Dc;function uf(){const a=Dc();return a.subtle||a.webkitSubtle}bi.getSubtleCrypto=uf;function p1(){return!!Dc()&&!!uf()}bi.isBrowserCryptoAvailable=p1;var Ei={};Object.defineProperty(Ei,"__esModule",{value:!0});Ei.isBrowser=Ei.isNode=Ei.isReactNative=void 0;function hf(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Ei.isReactNative=hf;function lf(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Ei.isNode=lf;function d1(){return!hf()&&!lf()}Ei.isBrowser=d1;(function(a){Object.defineProperty(a,"__esModule",{value:!0});const i=cf.exports;i.__exportStar(bi,a),i.__exportStar(Ei,a)})(af);function Nc(a=3){const i=Date.now()*Math.pow(10,a),r=Math.floor(Math.random()*Math.pow(10,a));return i+r}function ff(a=6){return BigInt(Nc(a))}function yn(a,i,r){return{id:r||Nc(),jsonrpc:"2.0",method:a,params:i}}function Fc(a,i){return{id:a,jsonrpc:"2.0",result:i}}function So(a,i,r){return{id:a,jsonrpc:"2.0",error:g1(i,r)}}function g1(a,i){return typeof a>"u"?Qh(nf):(typeof a=="string"&&(a=Object.assign(Object.assign({},Qh(Cc)),{message:a})),typeof i<"u"&&(a.data=i),l1(a.code)&&(a=f1(a.code)),a)}class y1{}class v1 extends y1{constructor(){super()}}class _1 extends v1{constructor(i){super()}}const m1="^https?:",w1="^wss?:";function b1(a){const i=a.match(new RegExp(/^\w+:/,"gi"));if(!(!i||!i.length))return i[0]}function pf(a,i){const r=b1(a);return typeof r>"u"?!1:new RegExp(i).test(r)}function Yh(a){return pf(a,m1)}function Xh(a){return pf(a,w1)}function E1(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function df(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function jc(a){return df(a)&&"method"in a}function Po(a){return df(a)&&(si(a)||$r(a))}function si(a){return"result"in a}function $r(a){return"error"in a}class oi extends _1{constructor(i){super(i),this.events=new Pr.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(i),this.connection.connected&&this.registerEventListeners()}async connect(i=this.connection){await this.open(i)}async disconnect(){await this.close()}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async request(i,r){return this.requestStrict(yn(i.method,i.params||[],i.id||ff().toString()),r)}async requestStrict(i,r){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(p){o(p)}this.events.on(`${i.id}`,p=>{$r(p)?o(p.error):s(p.result)});try{await this.connection.send(i,r)}catch(p){o(p)}})}setConnection(i=this.connection){return i}onPayload(i){this.events.emit("payload",i),Po(i)?this.events.emit(`${i.id}`,i):this.events.emit("message",{type:i.method,data:i.params})}onClose(i){i&&i.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${i.code} ${i.reason?`(${i.reason})`:""}`)),this.events.emit("disconnect")}async open(i=this.connection){this.connection===i&&this.connection.connected||(this.connection.connected&&this.close(),typeof i=="string"&&(await this.connection.open(i),i=this.connection),this.connection=this.setConnection(i),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",i=>this.onPayload(i)),this.connection.on("close",i=>this.onClose(i)),this.connection.on("error",i=>this.events.emit("error",i)),this.connection.on("register_error",i=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const I1=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),x1=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Zh=a=>a.split("?")[0],el=10,S1=I1();class P1{constructor(i){if(this.url=i,this.events=new Pr.exports.EventEmitter,this.registering=!1,!Xh(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);this.url=i}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async open(i=this.url){await this.register(i)}async close(){return new Promise((i,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),i()},this.socket.close()})}async send(i,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Xn(i))}catch(s){this.onError(i.id,s)}}register(i=this.url){if(!Xh(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",p=>{this.resetMaxListeners(),o(p)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=i,this.registering=!0,new Promise((r,s)=>{const o=af.isReactNative()?void 0:{rejectUnauthorized:!E1(i)},p=new S1(i,[],o);x1()?p.onerror=_=>{const b=_;s(this.emitError(b.error))}:p.on("error",_=>{s(this.emitError(_))}),p.onopen=()=>{this.onOpen(p),r(p)}})}onOpen(i){i.onmessage=r=>this.onPayload(r),i.onclose=r=>this.onClose(r),this.socket=i,this.registering=!1,this.events.emit("open")}onClose(i){this.socket=void 0,this.registering=!1,this.events.emit("close",i)}onPayload(i){if(typeof i.data>"u")return;const r=typeof i.data=="string"?Rc(i.data):i.data;this.events.emit("payload",r)}onError(i,r){const s=this.parseError(r),o=s.message||s.toString(),p=So(i,o);this.events.emit("payload",p)}parseError(i,r=this.url){return of(i,Zh(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>el&&this.events.setMaxListeners(el)}emitError(i){const r=this.parseError(new Error(i?.message||`WebSocket connection failed for host: ${Zh(this.url)}`));return this.events.emit("register_error",r),r}}var yc={exports:{}};(function(a,i){var r=200,s="__lodash_hash_undefined__",o=1,p=2,_=9007199254740991,b="[object Arguments]",S="[object Array]",D="[object AsyncFunction]",$="[object Boolean]",K="[object Date]",X="[object Error]",Q="[object Function]",F="[object GeneratorFunction]",se="[object Map]",ce="[object Number]",pe="[object Null]",le="[object Object]",ue="[object Promise]",ne="[object Proxy]",he="[object RegExp]",fe="[object Set]",ee="[object String]",j="[object Symbol]",Se="[object Undefined]",f="[object WeakMap]",g="[object ArrayBuffer]",y="[object DataView]",I="[object Float32Array]",l="[object Float64Array]",h="[object Int8Array]",P="[object Int16Array]",M="[object Int32Array]",H="[object Uint8Array]",E="[object Uint8ClampedArray]",q="[object Uint16Array]",W="[object Uint32Array]",Y=/[\\^$.*+?()[\]{}|]/g,ye=/^\[object .+?Constructor\]$/,ot=/^(?:0|[1-9]\d*)$/,we={};we[I]=we[l]=we[h]=we[P]=we[M]=we[H]=we[E]=we[q]=we[W]=!0,we[b]=we[S]=we[g]=we[$]=we[y]=we[K]=we[X]=we[Q]=we[se]=we[ce]=we[le]=we[he]=we[fe]=we[ee]=we[f]=!1;var Or=typeof mt=="object"&&mt&&mt.Object===Object&&mt,U=typeof self=="object"&&self&&self.Object===Object&&self,z=Or||U||Function("return this")(),N=i&&!i.nodeType&&i,u=N&&!0&&a&&!a.nodeType&&a,A=u&&u.exports===N,oe=A&&Or.process,me=function(){try{return oe&&oe.binding&&oe.binding("util")}catch{}}(),Pe=me&&me.isTypedArray;function je(w,R){for(var G=-1,te=w==null?0:w.length,Ge=0,Ee=[];++G<te;){var et=w[G];R(et,G,w)&&(Ee[Ge++]=et)}return Ee}function Le(w,R){for(var G=-1,te=R.length,Ge=w.length;++G<te;)w[Ge+G]=R[G];return w}function Te(w,R){for(var G=-1,te=w==null?0:w.length;++G<te;)if(R(w[G],G,w))return!0;return!1}function St(w,R){for(var G=-1,te=Array(w);++G<w;)te[G]=R(G);return te}function wt(w){return function(R){return w(R)}}function at(w,R){return w.has(R)}function Me(w,R){return w?.[R]}function Ye(w){var R=-1,G=Array(w.size);return w.forEach(function(te,Ge){G[++R]=[Ge,te]}),G}function Xe(w,R){return function(G){return w(R(G))}}function ct(w){var R=-1,G=Array(w.size);return w.forEach(function(te){G[++R]=te}),G}var Be=Array.prototype,Ze=Function.prototype,$e=Object.prototype,Ve=z["__core-js_shared__"],lt=Ze.toString,Ue=$e.hasOwnProperty,Pt=function(){var w=/[^.]+$/.exec(Ve&&Ve.keys&&Ve.keys.IE_PROTO||"");return w?"Symbol(src)_1."+w:""}(),jt=$e.toString,Ut=RegExp("^"+lt.call(Ue).replace(Y,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ht=A?z.Buffer:void 0,qt=z.Symbol,Wt=z.Uint8Array,tr=$e.propertyIsEnumerable,Lr=Be.splice,Jt=qt?qt.toStringTag:void 0,Vr=Object.getOwnPropertySymbols,ci=Ht?Ht.isBuffer:void 0,Pi=Xe(Object.keys,Object),ft=hr(z,"DataView"),rt=hr(z,"Map"),pt=hr(z,"Promise"),dt=hr(z,"Set"),ut=hr(z,"WeakMap"),it=hr(Object,"create"),Ot=Gr(ft),At=Gr(rt),gt=Gr(pt),Rt=Gr(dt),yt=Gr(ut),bt=qt?qt.prototype:void 0,vt=bt?bt.valueOf:void 0;function Qe(w){var R=-1,G=w==null?0:w.length;for(this.clear();++R<G;){var te=w[R];this.set(te[0],te[1])}}function Tt(){this.__data__=it?it(null):{},this.size=0}function Ct(w){var R=this.has(w)&&delete this.__data__[w];return this.size-=R?1:0,R}function Ro(w){var R=this.__data__;if(it){var G=R[w];return G===s?void 0:G}return Ue.call(R,w)?R[w]:void 0}function To(w){var R=this.__data__;return it?R[w]!==void 0:Ue.call(R,w)}function Co(w,R){var G=this.__data__;return this.size+=this.has(w)?0:1,G[w]=it&&R===void 0?s:R,this}Qe.prototype.clear=Tt,Qe.prototype.delete=Ct,Qe.prototype.get=Ro,Qe.prototype.has=To,Qe.prototype.set=Co;function yr(w){var R=-1,G=w==null?0:w.length;for(this.clear();++R<G;){var te=w[R];this.set(te[0],te[1])}}function Do(){this.__data__=[],this.size=0}function No(w){var R=this.__data__,G=Oi(R,w);if(G<0)return!1;var te=R.length-1;return G==te?R.pop():Lr.call(R,G,1),--this.size,!0}function Fo(w){var R=this.__data__,G=Oi(R,w);return G<0?void 0:R[G][1]}function jo(w){return Oi(this.__data__,w)>-1}function $o(w,R){var G=this.__data__,te=Oi(G,w);return te<0?(++this.size,G.push([w,R])):G[te][1]=R,this}yr.prototype.clear=Do,yr.prototype.delete=No,yr.prototype.get=Fo,yr.prototype.has=jo,yr.prototype.set=$o;function Kr(w){var R=-1,G=w==null?0:w.length;for(this.clear();++R<G;){var te=w[R];this.set(te[0],te[1])}}function Bi(){this.size=0,this.__data__={hash:new Qe,map:new(rt||yr),string:new Qe}}function Lo(w){var R=ui(this,w).delete(w);return this.size-=R?1:0,R}function ki(w){return ui(this,w).get(w)}function qo(w){return ui(this,w).has(w)}function Mo(w,R){var G=ui(this,w),te=G.size;return G.set(w,R),this.size+=G.size==te?0:1,this}Kr.prototype.clear=Bi,Kr.prototype.delete=Lo,Kr.prototype.get=ki,Kr.prototype.has=qo,Kr.prototype.set=Mo;function Vi(w){var R=-1,G=w==null?0:w.length;for(this.__data__=new Kr;++R<G;)this.add(w[R])}function rs(w){return this.__data__.set(w,s),this}function is(w){return this.__data__.has(w)}Vi.prototype.add=Vi.prototype.push=rs,Vi.prototype.has=is;function Ar(w){var R=this.__data__=new yr(w);this.size=R.size}function zo(){this.__data__=new yr,this.size=0}function Uo(w){var R=this.__data__,G=R.delete(w);return this.size=R.size,G}function Ho(w){return this.__data__.get(w)}function Bo(w){return this.__data__.has(w)}function ns(w,R){var G=this.__data__;if(G instanceof yr){var te=G.__data__;if(!rt||te.length<r-1)return te.push([w,R]),this.size=++G.size,this;G=this.__data__=new Kr(te)}return G.set(w,R),this.size=G.size,this}Ar.prototype.clear=zo,Ar.prototype.delete=Uo,Ar.prototype.get=Ho,Ar.prototype.has=Bo,Ar.prototype.set=ns;function ss(w,R){var G=Wi(w),te=!G&&vs(w),Ge=!G&&!te&&In(w),Ee=!G&&!te&&!Ge&&ws(w),et=G||te||Ge||Ee,Dt=et?St(w.length,String):[],De=Dt.length;for(var We in w)(R||Ue.call(w,We))&&!(et&&(We=="length"||Ge&&(We=="offset"||We=="parent")||Ee&&(We=="buffer"||We=="byteLength"||We=="byteOffset")||fs(We,De)))&&Dt.push(We);return Dt}function Oi(w,R){for(var G=w.length;G--;)if(ys(w[G][0],R))return G;return-1}function bn(w,R,G){var te=R(w);return Wi(w)?te:Le(te,G(w))}function Ai(w){return w==null?w===void 0?Se:pe:Jt&&Jt in Object(w)?hs(w):Ko(w)}function En(w){return Ti(w)&&Ai(w)==b}function Ri(w,R,G,te,Ge){return w===R?!0:w==null||R==null||!Ti(w)&&!Ti(R)?w!==w&&R!==R:os(w,R,G,te,Ri,Ge)}function os(w,R,G,te,Ge,Ee){var et=Wi(w),Dt=Wi(R),De=et?S:qr(w),We=Dt?S:qr(R);De=De==b?le:De,We=We==b?le:We;var Et=De==le,rr=We==le,Nt=De==We;if(Nt&&In(w)){if(!In(R))return!1;et=!0,Et=!1}if(Nt&&!Et)return Ee||(Ee=new Ar),et||ws(w)?Ki(w,R,G,te,Ge,Ee):Vo(w,R,De,G,te,Ge,Ee);if(!(G&o)){var tt=Et&&Ue.call(w,"__wrapped__"),Qt=rr&&Ue.call(R,"__wrapped__");if(tt||Qt){var Rr=tt?w.value():w,vr=Qt?R.value():R;return Ee||(Ee=new Ar),Ge(Rr,vr,G,te,Ee)}}return Nt?(Ee||(Ee=new Ar),us(w,R,G,te,Ge,Ee)):!1}function ko(w){if(!ms(w)||ds(w))return!1;var R=Ji(w)?Ut:ye;return R.test(Gr(w))}function as(w){return Ti(w)&&_s(w.length)&&!!we[Ai(w)]}function cs(w){if(!gs(w))return Pi(w);var R=[];for(var G in Object(w))Ue.call(w,G)&&G!="constructor"&&R.push(G);return R}function Ki(w,R,G,te,Ge,Ee){var et=G&o,Dt=w.length,De=R.length;if(Dt!=De&&!(et&&De>Dt))return!1;var We=Ee.get(w);if(We&&Ee.get(R))return We==R;var Et=-1,rr=!0,Nt=G&p?new Vi:void 0;for(Ee.set(w,R),Ee.set(R,w);++Et<Dt;){var tt=w[Et],Qt=R[Et];if(te)var Rr=et?te(Qt,tt,Et,R,w,Ee):te(tt,Qt,Et,w,R,Ee);if(Rr!==void 0){if(Rr)continue;rr=!1;break}if(Nt){if(!Te(R,function(vr,Mr){if(!at(Nt,Mr)&&(tt===vr||Ge(tt,vr,G,te,Ee)))return Nt.push(Mr)})){rr=!1;break}}else if(!(tt===Qt||Ge(tt,Qt,G,te,Ee))){rr=!1;break}}return Ee.delete(w),Ee.delete(R),rr}function Vo(w,R,G,te,Ge,Ee,et){switch(G){case y:if(w.byteLength!=R.byteLength||w.byteOffset!=R.byteOffset)return!1;w=w.buffer,R=R.buffer;case g:return!(w.byteLength!=R.byteLength||!Ee(new Wt(w),new Wt(R)));case $:case K:case ce:return ys(+w,+R);case X:return w.name==R.name&&w.message==R.message;case he:case ee:return w==R+"";case se:var Dt=Ye;case fe:var De=te&o;if(Dt||(Dt=ct),w.size!=R.size&&!De)return!1;var We=et.get(w);if(We)return We==R;te|=p,et.set(w,R);var Et=Ki(Dt(w),Dt(R),te,Ge,Ee,et);return et.delete(w),Et;case j:if(vt)return vt.call(w)==vt.call(R)}return!1}function us(w,R,G,te,Ge,Ee){var et=G&o,Dt=Gi(w),De=Dt.length,We=Gi(R),Et=We.length;if(De!=Et&&!et)return!1;for(var rr=De;rr--;){var Nt=Dt[rr];if(!(et?Nt in R:Ue.call(R,Nt)))return!1}var tt=Ee.get(w);if(tt&&Ee.get(R))return tt==R;var Qt=!0;Ee.set(w,R),Ee.set(R,w);for(var Rr=et;++rr<De;){Nt=Dt[rr];var vr=w[Nt],Mr=R[Nt];if(te)var xn=et?te(Mr,vr,Nt,R,w,Ee):te(vr,Mr,Nt,w,R,Ee);if(!(xn===void 0?vr===Mr||Ge(vr,Mr,G,te,Ee):xn)){Qt=!1;break}Rr||(Rr=Nt=="constructor")}if(Qt&&!Rr){var Ci=w.constructor,Mt=R.constructor;Ci!=Mt&&"constructor"in w&&"constructor"in R&&!(typeof Ci=="function"&&Ci instanceof Ci&&typeof Mt=="function"&&Mt instanceof Mt)&&(Qt=!1)}return Ee.delete(w),Ee.delete(R),Qt}function Gi(w){return bn(w,Jo,ls)}function ui(w,R){var G=w.__data__;return ps(R)?G[typeof R=="string"?"string":"hash"]:G.map}function hr(w,R){var G=Me(w,R);return ko(G)?G:void 0}function hs(w){var R=Ue.call(w,Jt),G=w[Jt];try{w[Jt]=void 0;var te=!0}catch{}var Ge=jt.call(w);return te&&(R?w[Jt]=G:delete w[Jt]),Ge}var ls=Vr?function(w){return w==null?[]:(w=Object(w),je(Vr(w),function(R){return tr.call(w,R)}))}:Ke,qr=Ai;(ft&&qr(new ft(new ArrayBuffer(1)))!=y||rt&&qr(new rt)!=se||pt&&qr(pt.resolve())!=ue||dt&&qr(new dt)!=fe||ut&&qr(new ut)!=f)&&(qr=function(w){var R=Ai(w),G=R==le?w.constructor:void 0,te=G?Gr(G):"";if(te)switch(te){case Ot:return y;case At:return se;case gt:return ue;case Rt:return fe;case yt:return f}return R});function fs(w,R){return R=R??_,!!R&&(typeof w=="number"||ot.test(w))&&w>-1&&w%1==0&&w<R}function ps(w){var R=typeof w;return R=="string"||R=="number"||R=="symbol"||R=="boolean"?w!=="__proto__":w===null}function ds(w){return!!Pt&&Pt in w}function gs(w){var R=w&&w.constructor,G=typeof R=="function"&&R.prototype||$e;return w===G}function Ko(w){return jt.call(w)}function Gr(w){if(w!=null){try{return lt.call(w)}catch{}try{return w+""}catch{}}return""}function ys(w,R){return w===R||w!==w&&R!==R}var vs=En(function(){return arguments}())?En:function(w){return Ti(w)&&Ue.call(w,"callee")&&!tr.call(w,"callee")},Wi=Array.isArray;function Go(w){return w!=null&&_s(w.length)&&!Ji(w)}var In=ci||ke;function Wo(w,R){return Ri(w,R)}function Ji(w){if(!ms(w))return!1;var R=Ai(w);return R==Q||R==F||R==D||R==ne}function _s(w){return typeof w=="number"&&w>-1&&w%1==0&&w<=_}function ms(w){var R=typeof w;return w!=null&&(R=="object"||R=="function")}function Ti(w){return w!=null&&typeof w=="object"}var ws=Pe?wt(Pe):as;function Jo(w){return Go(w)?ss(w):cs(w)}function Ke(){return[]}function ke(){return!1}a.exports=Wo})(yc,yc.exports);var O1=yc.exports;function A1(a,i){if(a.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var o=0;o<a.length;o++){var p=a.charAt(o),_=p.charCodeAt(0);if(r[_]!==255)throw new TypeError(p+" is ambiguous");r[_]=o}var b=a.length,S=a.charAt(0),D=Math.log(b)/Math.log(256),$=Math.log(256)/Math.log(b);function K(F){if(F instanceof Uint8Array||(ArrayBuffer.isView(F)?F=new Uint8Array(F.buffer,F.byteOffset,F.byteLength):Array.isArray(F)&&(F=Uint8Array.from(F))),!(F instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(F.length===0)return"";for(var se=0,ce=0,pe=0,le=F.length;pe!==le&&F[pe]===0;)pe++,se++;for(var ue=(le-pe)*$+1>>>0,ne=new Uint8Array(ue);pe!==le;){for(var he=F[pe],fe=0,ee=ue-1;(he!==0||fe<ce)&&ee!==-1;ee--,fe++)he+=256*ne[ee]>>>0,ne[ee]=he%b>>>0,he=he/b>>>0;if(he!==0)throw new Error("Non-zero carry");ce=fe,pe++}for(var j=ue-ce;j!==ue&&ne[j]===0;)j++;for(var Se=S.repeat(se);j<ue;++j)Se+=a.charAt(ne[j]);return Se}function X(F){if(typeof F!="string")throw new TypeError("Expected String");if(F.length===0)return new Uint8Array;var se=0;if(F[se]!==" "){for(var ce=0,pe=0;F[se]===S;)ce++,se++;for(var le=(F.length-se)*D+1>>>0,ue=new Uint8Array(le);F[se];){var ne=r[F.charCodeAt(se)];if(ne===255)return;for(var he=0,fe=le-1;(ne!==0||he<pe)&&fe!==-1;fe--,he++)ne+=b*ue[fe]>>>0,ue[fe]=ne%256>>>0,ne=ne/256>>>0;if(ne!==0)throw new Error("Non-zero carry");pe=he,se++}if(F[se]!==" "){for(var ee=le-pe;ee!==le&&ue[ee]===0;)ee++;for(var j=new Uint8Array(ce+(le-ee)),Se=ce;ee!==le;)j[Se++]=ue[ee++];return j}}}function Q(F){var se=X(F);if(se)return se;throw new Error(`Non-${i} character`)}return{encode:K,decodeUnsafe:X,decode:Q}}var R1=A1,T1=R1;const gf=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},C1=a=>new TextEncoder().encode(a),D1=a=>new TextDecoder().decode(a);class N1{constructor(i,r,s){this.name=i,this.prefix=r,this.baseEncode=s}encode(i){if(i instanceof Uint8Array)return`${this.prefix}${this.baseEncode(i)}`;throw Error("Unknown type, must be binary type")}}class F1{constructor(i,r,s){if(this.name=i,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(i){if(typeof i=="string"){if(i.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(i)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(i.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(i){return yf(this,i)}}class j1{constructor(i){this.decoders=i}or(i){return yf(this,i)}decode(i){const r=i[0],s=this.decoders[r];if(s)return s.decode(i);throw RangeError(`Unable to decode multibase string ${JSON.stringify(i)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const yf=(a,i)=>new j1({...a.decoders||{[a.prefix]:a},...i.decoders||{[i.prefix]:i}});class $1{constructor(i,r,s,o){this.name=i,this.prefix=r,this.baseEncode=s,this.baseDecode=o,this.encoder=new N1(i,r,s),this.decoder=new F1(i,r,o)}encode(i){return this.encoder.encode(i)}decode(i){return this.decoder.decode(i)}}const Oo=({name:a,prefix:i,encode:r,decode:s})=>new $1(a,i,r,s),ts=({prefix:a,name:i,alphabet:r})=>{const{encode:s,decode:o}=T1(r,i);return Oo({prefix:a,name:i,encode:s,decode:p=>gf(o(p))})},L1=(a,i,r,s)=>{const o={};for(let $=0;$<i.length;++$)o[i[$]]=$;let p=a.length;for(;a[p-1]==="=";)--p;const _=new Uint8Array(p*r/8|0);let b=0,S=0,D=0;for(let $=0;$<p;++$){const K=o[a[$]];if(K===void 0)throw new SyntaxError(`Non-${s} character`);S=S<<r|K,b+=r,b>=8&&(b-=8,_[D++]=255&S>>b)}if(b>=r||255&S<<8-b)throw new SyntaxError("Unexpected end of data");return _},q1=(a,i,r)=>{const s=i[i.length-1]==="=",o=(1<<r)-1;let p="",_=0,b=0;for(let S=0;S<a.length;++S)for(b=b<<8|a[S],_+=8;_>r;)_-=r,p+=i[o&b>>_];if(_&&(p+=i[o&b<<r-_]),s)for(;p.length*r&7;)p+="=";return p},kt=({name:a,prefix:i,bitsPerChar:r,alphabet:s})=>Oo({prefix:i,name:a,encode(o){return q1(o,s,r)},decode(o){return L1(o,s,r,a)}}),M1=Oo({prefix:"\0",name:"identity",encode:a=>D1(a),decode:a=>C1(a)});var z1=Object.freeze({__proto__:null,identity:M1});const U1=kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var H1=Object.freeze({__proto__:null,base2:U1});const B1=kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var k1=Object.freeze({__proto__:null,base8:B1});const V1=ts({prefix:"9",name:"base10",alphabet:"0123456789"});var K1=Object.freeze({__proto__:null,base10:V1});const G1=kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),W1=kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var J1=Object.freeze({__proto__:null,base16:G1,base16upper:W1});const Q1=kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Y1=kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),X1=kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Z1=kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ew=kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),tw=kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),rw=kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),iw=kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),nw=kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var sw=Object.freeze({__proto__:null,base32:Q1,base32upper:Y1,base32pad:X1,base32padupper:Z1,base32hex:ew,base32hexupper:tw,base32hexpad:rw,base32hexpadupper:iw,base32z:nw});const ow=ts({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),aw=ts({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var cw=Object.freeze({__proto__:null,base36:ow,base36upper:aw});const uw=ts({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),hw=ts({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var lw=Object.freeze({__proto__:null,base58btc:uw,base58flickr:hw});const fw=kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),pw=kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),dw=kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),gw=kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var yw=Object.freeze({__proto__:null,base64:fw,base64pad:pw,base64url:dw,base64urlpad:gw});const vf=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),vw=vf.reduce((a,i,r)=>(a[r]=i,a),[]),_w=vf.reduce((a,i,r)=>(a[i.codePointAt(0)]=r,a),[]);function mw(a){return a.reduce((i,r)=>(i+=vw[r],i),"")}function ww(a){const i=[];for(const r of a){const s=_w[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);i.push(s)}return new Uint8Array(i)}const bw=Oo({prefix:"\u{1F680}",name:"base256emoji",encode:mw,decode:ww});var Ew=Object.freeze({__proto__:null,base256emoji:bw}),Iw=_f,tl=128,xw=127,Sw=~xw,Pw=Math.pow(2,31);function _f(a,i,r){i=i||[],r=r||0;for(var s=r;a>=Pw;)i[r++]=a&255|tl,a/=128;for(;a&Sw;)i[r++]=a&255|tl,a>>>=7;return i[r]=a|0,_f.bytes=r-s+1,i}var Ow=vc,Aw=128,rl=127;function vc(a,s){var r=0,s=s||0,o=0,p=s,_,b=a.length;do{if(p>=b)throw vc.bytes=0,new RangeError("Could not decode varint");_=a[p++],r+=o<28?(_&rl)<<o:(_&rl)*Math.pow(2,o),o+=7}while(_>=Aw);return vc.bytes=p-s,r}var Rw=Math.pow(2,7),Tw=Math.pow(2,14),Cw=Math.pow(2,21),Dw=Math.pow(2,28),Nw=Math.pow(2,35),Fw=Math.pow(2,42),jw=Math.pow(2,49),$w=Math.pow(2,56),Lw=Math.pow(2,63),qw=function(a){return a<Rw?1:a<Tw?2:a<Cw?3:a<Dw?4:a<Nw?5:a<Fw?6:a<jw?7:a<$w?8:a<Lw?9:10},Mw={encode:Iw,decode:Ow,encodingLength:qw},mf=Mw;const il=(a,i,r=0)=>(mf.encode(a,i,r),i),nl=a=>mf.encodingLength(a),_c=(a,i)=>{const r=i.byteLength,s=nl(a),o=s+nl(r),p=new Uint8Array(o+r);return il(a,p,0),il(r,p,s),p.set(i,o),new zw(a,r,i,p)};class zw{constructor(i,r,s,o){this.code=i,this.size=r,this.digest=s,this.bytes=o}}const wf=({name:a,code:i,encode:r})=>new Uw(a,i,r);class Uw{constructor(i,r,s){this.name=i,this.code=r,this.encode=s}digest(i){if(i instanceof Uint8Array){const r=this.encode(i);return r instanceof Uint8Array?_c(this.code,r):r.then(s=>_c(this.code,s))}else throw Error("Unknown type, must be binary type")}}const bf=a=>async i=>new Uint8Array(await crypto.subtle.digest(a,i)),Hw=wf({name:"sha2-256",code:18,encode:bf("SHA-256")}),Bw=wf({name:"sha2-512",code:19,encode:bf("SHA-512")});var kw=Object.freeze({__proto__:null,sha256:Hw,sha512:Bw});const Ef=0,Vw="identity",If=gf,Kw=a=>_c(Ef,If(a)),Gw={code:Ef,name:Vw,encode:If,digest:Kw};var Ww=Object.freeze({__proto__:null,identity:Gw});new TextEncoder,new TextDecoder;const sl={...z1,...H1,...k1,...K1,...J1,...sw,...cw,...lw,...yw,...Ew};({...kw,...Ww});function xf(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function Jw(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?xf(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function Sf(a,i,r,s){return{name:a,prefix:i,encoder:{name:a,prefix:i,encode:r},decoder:{decode:s}}}const ol=Sf("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),nc=Sf("ascii","a",a=>{let i="a";for(let r=0;r<a.length;r++)i+=String.fromCharCode(a[r]);return i},a=>{a=a.substring(1);const i=Jw(a.length);for(let r=0;r<a.length;r++)i[r]=a.charCodeAt(r);return i}),Qw={utf8:ol,"utf-8":ol,hex:sl.base16,latin1:nc,ascii:nc,binary:nc,...sl};function Yw(a,i="utf8"){const r=Qw[i];if(!r)throw new Error(`Unsupported encoding "${i}"`);return(i==="utf8"||i==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?xf(globalThis.Buffer.from(a,"utf-8")):r.decoder.decode(`${r.prefix}${a}`)}const Pf="wc",Xw=2,$c="core",Ii=`${Pf}@2:${$c}:`,Zw={name:$c,logger:"error"},eb={database:":memory:"},tb="crypto",al="client_ed25519_seed",rb=de.ONE_DAY,ib="keychain",nb="0.3",sb="messages",ob="0.3",ab=de.SIX_HOURS,cb="publisher",Of="irn",ub="error",Af="wss://relay.walletconnect.com",cl="wss://relay.walletconnect.org",hb="relayer",Gt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},lb="_subscription",ii={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},fb=de.ONE_SECOND,pb="2.10.2",db=1e4,gb="0.3",yb="WALLETCONNECT_CLIENT_ID",Fr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},vb="subscription",_b="0.3",mb=de.FIVE_SECONDS*1e3,wb="pairing",bb="0.3",zn={wc_pairingDelete:{req:{ttl:de.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:de.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:de.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:de.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:de.ONE_DAY,prompt:!1,tag:0},res:{ttl:de.ONE_DAY,prompt:!1,tag:0}}},Kn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Br={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Eb="history",Ib="0.3",xb="expirer",Sr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Sb="0.3",sc="verify-api",go="https://verify.walletconnect.com",ul="https://verify.walletconnect.org";class Pb{constructor(i,r){this.core=i,this.logger=r,this.keychain=new Map,this.name=ib,this.version=nb,this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:p}=ie("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(p)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=i,this.logger=Fe.generateChildLogger(r,this.name)}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(i){await this.core.storage.setItem(this.storageKey,Ul(i))}async getKeyChain(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?Hl(i):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:i}=ie("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Ob{constructor(i,r,s){this.core=i,this.logger=r,this.name=tb,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),p=Jh(o);return rf(p.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=v_();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const p=await this.getClientSeed(),_=Jh(p),b=pc();return await s1(b,o,rb,_)},this.generateSharedKey=(o,p,_)=>{this.isInitialized();const b=this.getPrivateKey(o),S=__(b,p);return this.setSymKey(S,_)},this.setSymKey=async(o,p)=>{this.isInitialized();const _=p||m_(o);return await this.keychain.set(_,o),_},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,p,_)=>{this.isInitialized();const b=w_(_),S=Xn(p);if(Uh(b)){const X=b.senderPublicKey,Q=b.receiverPublicKey;o=await this.generateSharedKey(X,Q)}const D=this.getSymKey(o),{type:$,senderPublicKey:K}=b;return b_({type:$,symKey:D,message:S,senderPublicKey:K})},this.decode=async(o,p,_)=>{this.isInitialized();const b=E_(p,_);if(Uh(b)){const S=b.receiverPublicKey,D=b.senderPublicKey;o=await this.generateSharedKey(S,D)}try{const S=this.getSymKey(o),D=I_({symKey:S,encoded:p});return Rc(D)}catch(S){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(S)}},this.getPayloadType=o=>{const p=Hh(o);return x_(p.type)},this.getPayloadSenderPublicKey=o=>{const p=Hh(o);return p.senderPublicKey?_o(p.senderPublicKey,S_):void 0},this.core=i,this.logger=Fe.generateChildLogger(r,this.name),this.keychain=s||new Pb(this.core,this.logger)}get context(){return Fe.getLoggerContext(this.logger)}async setPrivateKey(i,r){return await this.keychain.set(i,r),i}getPrivateKey(i){return this.keychain.get(i)}async getClientSeed(){let i="";try{i=this.keychain.get(al)}catch{i=pc(),await this.keychain.set(al,i)}return Yw(i,"base16")}getSymKey(i){return this.keychain.get(i)}isInitialized(){if(!this.initialized){const{message:i}=ie("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Ab extends jm{constructor(i,r){super(i,r),this.logger=i,this.core=r,this.messages=new Map,this.name=sb,this.version=ob,this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const p=gn(o);let _=this.messages.get(s);return typeof _>"u"&&(_={}),typeof _[p]<"u"||(_[p]=o,this.messages.set(s,_),await this.persist()),p},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const p=this.get(s),_=gn(o);return typeof p[_]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Fe.generateChildLogger(i,this.name),this.core=r}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(i){await this.core.storage.setItem(this.storageKey,Ul(i))}async getRelayerMessages(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?Hl(i):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:i}=ie("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Rb extends $m{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.events=new Pr.exports.EventEmitter,this.name=cb,this.queue=new Map,this.publishTimeout=de.toMiliseconds(de.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,p)=>{var _;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:p}});try{const b=p?.ttl||ab,S=dc(p),D=p?.prompt||!1,$=p?.tag||0,K=p?.id||ff().toString(),X={topic:s,message:o,opts:{ttl:b,relay:S,prompt:D,tag:$,id:K}},Q=setTimeout(()=>this.queue.set(K,X),this.publishTimeout);try{await await Jn(this.rpcPublish(s,o,b,S,D,$,K),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(K),this.relayer.events.emit(Gt.publish,X)}catch(F){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(_=p?.internal)!=null&&_.throwOnFailedPublish)throw this.removeRequestFromQueue(K),F;return}finally{clearTimeout(Q)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:p}})}catch(b){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(b),b}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=i,this.logger=Fe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Fe.getLoggerContext(this.logger)}rpcPublish(i,r,s,o,p,_,b){var S,D,$,K;const X={method:lo(o.protocol).publish,params:{topic:i,message:r,ttl:s,prompt:p,tag:_},id:b};return wi((S=X.params)==null?void 0:S.prompt)&&((D=X.params)==null||delete D.prompt),wi(($=X.params)==null?void 0:$.tag)&&((K=X.params)==null||delete K.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:X}),this.relayer.request(X)}removeRequestFromQueue(i){this.queue.delete(i)}checkQueue(){this.queue.forEach(async i=>{const{topic:r,message:s,opts:o}=i;await this.publish(r,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(mn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Gt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Gt.message_ack,i=>{this.removeRequestFromQueue(i.id.toString())})}}class Tb{constructor(){this.map=new Map,this.set=(i,r)=>{const s=this.get(i);this.exists(i,r)||this.map.set(i,[...s,r])},this.get=i=>this.map.get(i)||[],this.exists=(i,r)=>this.get(i).includes(r),this.delete=(i,r)=>{if(typeof r>"u"){this.map.delete(i);return}if(!this.map.has(i))return;const s=this.get(i);if(!this.exists(i,r))return;const o=s.filter(p=>p!==r);if(!o.length){this.map.delete(i);return}this.map.set(i,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Cb=Object.defineProperty,Db=Object.defineProperties,Nb=Object.getOwnPropertyDescriptors,hl=Object.getOwnPropertySymbols,Fb=Object.prototype.hasOwnProperty,jb=Object.prototype.propertyIsEnumerable,ll=(a,i,r)=>i in a?Cb(a,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[i]=r,Un=(a,i)=>{for(var r in i||(i={}))Fb.call(i,r)&&ll(a,r,i[r]);if(hl)for(var r of hl(i))jb.call(i,r)&&ll(a,r,i[r]);return a},oc=(a,i)=>Db(a,Nb(i));class $b extends Mm{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.subscriptions=new Map,this.topicMap=new Tb,this.events=new Pr.exports.EventEmitter,this.name=vb,this.version=_b,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ii,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const p=dc(o),_={topic:s,relay:p};this.pending.set(s,_);const b=await this.rpcSubscribe(s,p);return this.onSubscribe(b,_),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),b}catch(p){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(p),p}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof o?.id<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,p)=>{const _=new de.Watch;_.start(this.pendingSubscriptionWatchLabel);const b=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(b),_.stop(this.pendingSubscriptionWatchLabel),o(!0)),_.elapsed(this.pendingSubscriptionWatchLabel)>=mb&&(clearInterval(b),_.stop(this.pendingSubscriptionWatchLabel),p(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=i,this.logger=Fe.generateChildLogger(r,this.name),this.clientId=""}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(i,r){let s=!1;try{s=this.getSubscription(i).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(i,r){const s=this.topicMap.get(i);await Promise.all(s.map(async o=>await this.unsubscribeById(i,o,r)))}async unsubscribeById(i,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:s}});try{const o=dc(s);await this.rpcUnsubscribe(i,r,o);const p=er("USER_DISCONNECTED",`${this.name}, ${i}`);await this.onUnsubscribe(i,r,p),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(i,r){const s={method:lo(r.protocol).subscribe,params:{topic:i}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Jn(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Gt.connection_stalled)}return gn(i+this.clientId)}async rpcBatchSubscribe(i){if(!i.length)return;const r=i[0].relay,s={method:lo(r.protocol).batchSubscribe,params:{topics:i.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Jn(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Gt.connection_stalled)}}rpcUnsubscribe(i,r,s){const o={method:lo(s.protocol).unsubscribe,params:{topic:i,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(i,r){this.setSubscription(i,oc(Un({},r),{id:i})),this.pending.delete(r.topic)}onBatchSubscribe(i){i.length&&i.forEach(r=>{this.setSubscription(r.id,Un({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(i,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,i)&&this.deleteSubscription(r,s),await this.relayer.messages.del(i)}async setRelayerSubscriptions(i){await this.relayer.core.storage.setItem(this.storageKey,i)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(i,r){this.subscriptions.has(i)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:i,subscription:r}),this.addSubscription(i,r))}addSubscription(i,r){this.subscriptions.set(i,Un({},r)),this.topicMap.set(r.topic,i),this.events.emit(Fr.created,r)}getSubscription(i){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:i});const r=this.subscriptions.get(i);if(!r){const{message:s}=ie("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return r}deleteSubscription(i,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:i,reason:r});const s=this.getSubscription(i);this.subscriptions.delete(i),this.topicMap.delete(s.topic,i),this.events.emit(Fr.deleted,oc(Un({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Fr.sync)}async reset(){if(this.cached.length){const i=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<i;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Fr.resubscribed)}async restore(){try{const i=await this.getRelayerSubscriptions();if(typeof i>"u"||!i.length)return;if(this.subscriptions.size){const{message:r}=ie("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(i){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(i)}}async batchSubscribe(i){if(!i.length)return;const r=await this.rpcBatchSubscribe(i);vn(r)&&this.onBatchSubscribe(r.map((s,o)=>oc(Un({},i[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const i=[];this.pending.forEach(r=>{i.push(r)}),await this.batchSubscribe(i)}registerEventListeners(){this.relayer.core.heartbeat.on(mn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Gt.connect,async()=>{await this.onConnect()}),this.relayer.on(Gt.disconnect,()=>{this.onDisconnect()}),this.events.on(Fr.created,async i=>{const r=Fr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()}),this.events.on(Fr.deleted,async i=>{const r=Fr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=ie("NOT_INITIALIZED",this.name);throw new Error(i)}}async restartToComplete(){this.restartInProgress&&await new Promise(i=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),i())},this.pollingInterval)})}}var Lb=Object.defineProperty,fl=Object.getOwnPropertySymbols,qb=Object.prototype.hasOwnProperty,Mb=Object.prototype.propertyIsEnumerable,pl=(a,i,r)=>i in a?Lb(a,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[i]=r,zb=(a,i)=>{for(var r in i||(i={}))qb.call(i,r)&&pl(a,r,i[r]);if(fl)for(var r of fl(i))Mb.call(i,r)&&pl(a,r,i[r]);return a};class Ub extends Lm{constructor(i){super(i),this.protocol="wc",this.version=2,this.events=new Pr.exports.EventEmitter,this.name=hb,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Gt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Gt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(ii.payload,this.onPayloadHandler),this.provider.on(ii.connect,this.onConnectHandler),this.provider.on(ii.disconnect,this.onDisconnectHandler),this.provider.on(ii.error,this.onProviderErrorHandler)},this.core=i.core,this.logger=typeof i.logger<"u"&&typeof i.logger!="string"?Fe.generateChildLogger(i.logger,this.name):Fe.pino(Fe.getDefaultLoggerOptions({level:i.logger||ub})),this.messages=new Ab(this.logger,i.core),this.subscriber=new $b(this,this.logger),this.publisher=new Rb(this,this.logger),this.relayUrl=i?.relayUrl||Af,this.projectId=i.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${cl}...`),await this.restartTransport(cl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},db)}get context(){return Fe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(i,r,s){this.isInitialized(),await this.publisher.publish(i,r,s),await this.recordMessageEvent({topic:i,message:r,publishedAt:Date.now()})}async subscribe(i,r){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(i))==null?void 0:s[0])||"";if(o)return o;let p;const _=b=>{b.topic===i&&(this.subscriber.off(Fr.created,_),p())};return await Promise.all([new Promise(b=>{p=b,this.subscriber.on(Fr.created,_)}),new Promise(async b=>{o=await this.subscriber.subscribe(i,r),b()})]),o}async unsubscribe(i,r){this.isInitialized(),await this.subscriber.unsubscribe(i,r)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Jn(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(i){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){i&&i!==this.relayUrl&&(this.relayUrl=i,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Fr.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await Jn(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(ii.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(i){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=i||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Bh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(i){return this.staleConnectionErrors.some(r=>i.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const i=await this.core.crypto.signJWT(this.relayUrl);this.provider=new oi(new P1(P_({sdkVersion:pb,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:i,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(i){const{topic:r,message:s}=i;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(i){const{topic:r,message:s}=i;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const o=this.messages.has(r,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(i){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:i}),jc(i)){if(!i.method.endsWith(lb))return;const r=i.params,{topic:s,message:o,publishedAt:p}=r.data,_={topic:s,message:o,publishedAt:p};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(zb({type:"event",event:r.id},_)),this.events.emit(r.id,_),await this.acknowledgePayload(i),await this.onMessageEvent(_)}else Po(i)&&this.events.emit(Gt.message_ack,i)}async onMessageEvent(i){await this.shouldIgnoreMessageEvent(i)||(this.events.emit(Gt.message,i),await this.recordMessageEvent(i))}async acknowledgePayload(i){const r=Fc(i.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(ii.payload,this.onPayloadHandler),this.provider.off(ii.connect,this.onConnectHandler),this.provider.off(ii.disconnect,this.onDisconnectHandler),this.provider.off(ii.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Gt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let i=await Bh();O_(async r=>{this.initialized&&i!==r&&(i=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Gt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(i=>this.logger.error(i))},de.toMiliseconds(fb)))}isInitialized(){if(!this.initialized){const{message:i}=ie("NOT_INITIALIZED",this.name);throw new Error(i)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(i=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),i())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var Hb=Object.defineProperty,dl=Object.getOwnPropertySymbols,Bb=Object.prototype.hasOwnProperty,kb=Object.prototype.propertyIsEnumerable,gl=(a,i,r)=>i in a?Hb(a,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[i]=r,yl=(a,i)=>{for(var r in i||(i={}))Bb.call(i,r)&&gl(a,r,i[r]);if(dl)for(var r of dl(i))kb.call(i,r)&&gl(a,r,i[r]);return a};class Ao extends qm{constructor(i,r,s,o=Ii,p=void 0){super(i,r,s,o),this.core=i,this.logger=r,this.name=s,this.map=new Map,this.version=gb,this.cached=[],this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(_=>{this.getKey&&_!==null&&!wi(_)?this.map.set(this.getKey(_),_):g_(_)?this.map.set(_.id,_):y_(_)&&this.map.set(_.topic,_)}),this.cached=[],this.initialized=!0)},this.set=async(_,b)=>{this.isInitialized(),this.map.has(_)?await this.update(_,b):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:_,value:b}),this.map.set(_,b),await this.persist())},this.get=_=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:_}),this.getData(_)),this.getAll=_=>(this.isInitialized(),_?this.values.filter(b=>Object.keys(_).every(S=>O1(b[S],_[S]))):this.values),this.update=async(_,b)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:_,update:b});const S=yl(yl({},this.getData(_)),b);this.map.set(_,S),await this.persist()},this.delete=async(_,b)=>{this.isInitialized(),this.map.has(_)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:_,reason:b}),this.map.delete(_),await this.persist())},this.logger=Fe.generateChildLogger(r,this.name),this.storagePrefix=o,this.getKey=p}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(i){await this.core.storage.setItem(this.storageKey,i)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(i){const r=this.map.get(i);if(!r){const{message:s}=ie("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const i=await this.getDataStore();if(typeof i>"u"||!i.length)return;if(this.map.size){const{message:r}=ie("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(i){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(i)}}isInitialized(){if(!this.initialized){const{message:i}=ie("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Vb{constructor(i,r){this.core=i,this.logger=r,this.name=wb,this.version=bb,this.events=new xc,this.initialized=!1,this.storagePrefix=Ii,this.ignoredPayloadTypes=[ql],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=pc(),o=await this.core.crypto.setSymKey(s),p=jr(de.FIVE_MINUTES),_={protocol:Of},b={topic:o,expiry:p,relay:_,active:!1},S=A_({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:_});return await this.pairings.set(o,b),await this.core.relayer.subscribe(o),this.core.expirer.set(o,p),{topic:o,uri:S}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:p,relay:_}=R_(s.uri);let b;if(this.pairings.keys.includes(o)&&(b=this.pairings.get(o),b.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(p,o),await this.core.relayer.subscribe(o,{relay:_}));const S=jr(de.FIVE_MINUTES),D={topic:o,relay:_,expiry:S,active:!1};return await this.pairings.set(o,D),this.core.expirer.set(o,S),s.activatePairing&&await this.activate({topic:o}),this.events.emit(Kn.create,D),D},this.activate=async({topic:s})=>{this.isInitialized();const o=jr(de.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const p=await this.sendRequest(o,"wc_pairingPing",{}),{done:_,resolve:b,reject:S}=fn();this.events.once(Ft("pairing_ping",p),({error:D})=>{D?S(D):b()}),await _()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",er("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,p)=>{const _=yn(o,p),b=await this.core.crypto.encode(s,_),S=zn[o].req;return this.core.history.set(s,_),this.core.relayer.publish(s,b,S),_.id},this.sendResult=async(s,o,p)=>{const _=Fc(s,p),b=await this.core.crypto.encode(o,_),S=await this.core.history.get(o,s),D=zn[S.request.method].res;await this.core.relayer.publish(o,b,D),await this.core.history.resolve(_)},this.sendError=async(s,o,p)=>{const _=So(s,p),b=await this.core.crypto.encode(o,_),S=await this.core.history.get(o,s),D=zn[S.request.method]?zn[S.request.method].res:zn.unregistered_method.res;await this.core.relayer.publish(o,b,D),await this.core.history.resolve(_)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,er("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>mi(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:p}=s;switch(p.method){case"wc_pairingPing":return this.onPairingPingRequest(o,p);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,p);default:return this.onUnknownRpcMethodRequest(o,p)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:p}=s,_=(await this.core.history.get(o,p.id)).request.method;switch(_){case"wc_pairingPing":return this.onPairingPingResponse(o,p);default:return this.onUnknownRpcMethodResponse(_)}},this.onPairingPingRequest=async(s,o)=>{const{id:p}=o;try{this.isValidPing({topic:s}),await this.sendResult(p,s,!0),this.events.emit(Kn.ping,{id:p,topic:s})}catch(_){await this.sendError(p,s,_),this.logger.error(_)}},this.onPairingPingResponse=(s,o)=>{const{id:p}=o;setTimeout(()=>{si(o)?this.events.emit(Ft("pairing_ping",p),{}):$r(o)&&this.events.emit(Ft("pairing_ping",p),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:p}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(Kn.delete,{id:p,topic:s})}catch(_){await this.sendError(p,s,_),this.logger.error(_)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:p,method:_}=o;try{if(this.registeredMethods.includes(_))return;const b=er("WC_METHOD_UNSUPPORTED",_);await this.sendError(p,s,b),this.logger.error(b)}catch(b){await this.sendError(p,s,b),this.logger.error(b)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(er("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!cr(s)){const{message:o}=ie("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(o)}if(!T_(s.uri)){const{message:o}=ie("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(o)}},this.isValidPing=async s=>{if(!cr(s)){const{message:p}=ie("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(p)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!cr(s)){const{message:p}=ie("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(p)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!pn(s,!1)){const{message:o}=ie("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=ie("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(mi(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=ie("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=i,this.logger=Fe.generateChildLogger(r,this.name),this.pairings=new Ao(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Fe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:i}=ie("NOT_INITIALIZED",this.name);throw new Error(i)}}registerRelayerEvents(){this.core.relayer.on(Gt.message,async i=>{const{topic:r,message:s}=i;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(r,s);try{jc(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Po(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.core.history.delete(r,o.id))}catch(p){this.logger.error(p)}})}registerExpirerEvents(){this.core.expirer.on(Sr.expired,async i=>{const{topic:r}=Ml(i.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(Kn.expire,{topic:r}))})}}class Kb extends Fm{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.records=new Map,this.events=new Pr.exports.EventEmitter,this.name=Eb,this.version=Ib,this.cached=[],this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,p)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:p}),this.records.has(o.id))return;const _={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:p,expiry:jr(de.THIRTY_DAYS)};this.records.set(_.id,_),this.events.emit(Br.created,_)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=$r(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(Br.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(p=>{if(p.topic===s){if(typeof o<"u"&&p.id!==o)return;this.records.delete(p.id),this.events.emit(Br.deleted,p)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Fe.generateChildLogger(r,this.name)}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const i=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:yn(r.request.method,r.request.params,r.id),chainId:r.chainId};return i.push(s)}),i}async setJsonRpcRecords(i){await this.core.storage.setItem(this.storageKey,i)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(i){this.isInitialized();const r=this.records.get(i);if(!r){const{message:s}=ie("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Br.sync)}async restore(){try{const i=await this.getJsonRpcRecords();if(typeof i>"u"||!i.length)return;if(this.records.size){const{message:r}=ie("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}}registerEventListeners(){this.events.on(Br.created,i=>{const r=Br.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(Br.updated,i=>{const r=Br.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(Br.deleted,i=>{const r=Br.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.core.heartbeat.on(mn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(i=>{de.toMiliseconds(i.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${i.id}`),this.delete(i.topic,i.id))})}catch(i){this.logger.warn(i)}}isInitialized(){if(!this.initialized){const{message:i}=ie("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Gb extends zm{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.expirations=new Map,this.events=new Pr.exports.EventEmitter,this.name=xb,this.version=Sb,this.cached=[],this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const p=this.formatTarget(s),_={target:p,expiry:o};this.expirations.set(p,_),this.checkExpiry(p,_),this.events.emit(Sr.created,{target:p,expiration:_})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),p=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Sr.deleted,{target:o,expiration:p})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Fe.generateChildLogger(r,this.name)}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(i){if(typeof i=="string")return C_(i);if(typeof i=="number")return D_(i);const{message:r}=ie("UNKNOWN_TYPE",`Target type: ${typeof i}`);throw new Error(r)}async setExpirations(i){await this.core.storage.setItem(this.storageKey,i)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Sr.sync)}async restore(){try{const i=await this.getExpirations();if(typeof i>"u"||!i.length)return;if(this.expirations.size){const{message:r}=ie("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(i){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(i)}}getExpiration(i){const r=this.expirations.get(i);if(!r){const{message:s}=ie("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(i,r){const{expiry:s}=r;de.toMiliseconds(s)-Date.now()<=0&&this.expire(i,r)}expire(i,r){this.expirations.delete(i),this.events.emit(Sr.expired,{target:i,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((i,r)=>this.checkExpiry(r,i))}registerEventListeners(){this.core.heartbeat.on(mn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Sr.created,i=>{const r=Sr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Sr.expired,i=>{const r=Sr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Sr.deleted,i=>{const r=Sr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=ie("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Wb extends Um{constructor(i,r){super(i,r),this.projectId=i,this.logger=r,this.name=sc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async()=>{if(this.verifyDisabled||N_()||!zl())return;const s=go;this.verifyUrl!==s&&this.removeIframe(),this.verifyUrl=s;try{await this.createIframe()}catch(o){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(o)}if(!this.initialized){this.removeIframe(),this.verifyUrl=ul;try{await this.createIframe()}catch(o){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(o),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=s?.verifyUrl||go;let p;try{p=await this.fetchAttestation(s.attestationId,o)}catch(_){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(_),p=await this.fetchAttestation(s.attestationId,ul)}return p},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const p=this.startAbortTimer(de.ONE_SECOND*2),_=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(p),_.status===200?await _.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=p=>{p.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(p=>{if(document.getElementById(sc))return p();window.addEventListener("message",o);const _=document.createElement("iframe");_.id=sc,_.src=`${this.verifyUrl}/${this.projectId}`,_.style.display="none",document.body.append(_),this.iframe=_,s=p}),new Promise((p,_)=>setTimeout(()=>{window.removeEventListener("message",o),_("verify iframe load timeout")},de.toMiliseconds(de.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=Fe.generateChildLogger(r,this.name),this.verifyUrl=go,this.abortController=new AbortController,this.isDevEnv=F_()&&{}.IS_VITEST}get context(){return Fe.getLoggerContext(this.logger)}startAbortTimer(i){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),de.toMiliseconds(i))}}var Jb=Object.defineProperty,vl=Object.getOwnPropertySymbols,Qb=Object.prototype.hasOwnProperty,Yb=Object.prototype.propertyIsEnumerable,_l=(a,i,r)=>i in a?Jb(a,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[i]=r,ml=(a,i)=>{for(var r in i||(i={}))Qb.call(i,r)&&_l(a,r,i[r]);if(vl)for(var r of vl(i))Yb.call(i,r)&&_l(a,r,i[r]);return a};class Lc extends Nm{constructor(i){super(i),this.protocol=Pf,this.version=Xw,this.name=$c,this.events=new Pr.exports.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=i?.projectId,this.relayUrl=i?.relayUrl||Af,this.customStoragePrefix=i!=null&&i.customStoragePrefix?`:${i.customStoragePrefix}`:"";const r=typeof i?.logger<"u"&&typeof i?.logger!="string"?i.logger:Fe.pino(Fe.getDefaultLoggerOptions({level:i?.logger||Zw.logger}));this.logger=Fe.generateChildLogger(r,this.name),this.heartbeat=new mn.HeartBeat,this.crypto=new Ob(this,this.logger,i?.keychain),this.history=new Kb(this,this.logger),this.expirer=new Gb(this,this.logger),this.storage=i!=null&&i.storage?i.storage:new cm(ml(ml({},eb),i?.storageOptions)),this.relayer=new Ub({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Vb(this,this.logger),this.verify=new Wb(this.projectId||"",this.logger)}static async init(i){const r=new Lc(i);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(yb,s),r}get context(){return Fe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(i){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,i),this.logger.error(i.message),i}}}const Xb=Lc,Rf="wc",Tf=2,Cf="client",qc=`${Rf}@${Tf}:${Cf}:`,ac={name:Cf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},wl="WALLETCONNECT_DEEPLINK_CHOICE",Zb="proposal",Df="Proposal expired",eE="session",co=de.SEVEN_DAYS,tE="engine",Hn={wc_sessionPropose:{req:{ttl:de.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:de.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:de.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:de.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:de.ONE_DAY,prompt:!1,tag:1104},res:{ttl:de.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:de.ONE_DAY,prompt:!1,tag:1106},res:{ttl:de.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:de.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:de.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:de.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:de.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:de.ONE_DAY,prompt:!1,tag:1112},res:{ttl:de.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:de.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:de.THIRTY_SECONDS,prompt:!1,tag:1115}}},cc={min:de.FIVE_MINUTES,max:de.SEVEN_DAYS},ni={idle:"IDLE",active:"ACTIVE"},rE="request",iE=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var nE=Object.defineProperty,sE=Object.defineProperties,oE=Object.getOwnPropertyDescriptors,bl=Object.getOwnPropertySymbols,aE=Object.prototype.hasOwnProperty,cE=Object.prototype.propertyIsEnumerable,El=(a,i,r)=>i in a?nE(a,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[i]=r,ar=(a,i)=>{for(var r in i||(i={}))aE.call(i,r)&&El(a,r,i[r]);if(bl)for(var r of bl(i))cE.call(i,r)&&El(a,r,i[r]);return a},Bn=(a,i)=>sE(a,oE(i));class uE extends Bm{constructor(i){super(i),this.name=tE,this.events=new xc,this.initialized=!1,this.ignoredPayloadTypes=[ql],this.requestQueue={state:ni.idle,queue:[]},this.sessionRequestQueue={state:ni.idle,queue:[]},this.requestQueueDelay=de.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Hn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},de.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=Bn(ar({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:p,optionalNamespaces:_,sessionProperties:b,relays:S}=s;let D=o,$,K=!1;if(D&&(K=this.client.core.pairing.pairings.get(D).active),!D||!K){const{topic:ue,uri:ne}=await this.client.core.pairing.create();D=ue,$=ne}const X=await this.client.core.crypto.generateKeyPair(),Q=ar({requiredNamespaces:p,optionalNamespaces:_,relays:S??[{protocol:Of}],proposer:{publicKey:X,metadata:this.client.metadata}},b&&{sessionProperties:b}),{reject:F,resolve:se,done:ce}=fn(de.FIVE_MINUTES,Df);if(this.events.once(Ft("session_connect"),async({error:ue,session:ne})=>{if(ue)F(ue);else if(ne){ne.self.publicKey=X;const he=Bn(ar({},ne),{requiredNamespaces:ne.requiredNamespaces,optionalNamespaces:ne.optionalNamespaces});await this.client.session.set(ne.topic,he),await this.setExpiry(ne.topic,ne.expiry),D&&await this.client.core.pairing.updateMetadata({topic:D,metadata:ne.peer.metadata}),se(he)}}),!D){const{message:ue}=ie("NO_MATCHING_KEY",`connect() pairing topic: ${D}`);throw new Error(ue)}const pe=await this.sendRequest({topic:D,method:"wc_sessionPropose",params:Q}),le=jr(de.FIVE_MINUTES);return await this.setProposal(pe,ar({id:pe,expiry:le},Q)),{uri:$,approval:ce}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:o,namespaces:p,sessionProperties:_}=r,b=this.client.proposal.get(s);let{pairingTopic:S,proposer:D,requiredNamespaces:$,optionalNamespaces:K}=b;S=S||"",fo($)||($=j_(p,"approve()"));const X=await this.client.core.crypto.generateKeyPair(),Q=D.publicKey,F=await this.client.core.crypto.generateSharedKey(X,Q);S&&s&&(await this.client.core.pairing.updateMetadata({topic:S,metadata:D.metadata}),await this.sendResult({id:s,topic:S,result:{relay:{protocol:o??"irn"},responderPublicKey:X}}),await this.client.proposal.delete(s,er("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:S}));const se=ar({relay:{protocol:o??"irn"},namespaces:p,requiredNamespaces:$,optionalNamespaces:K,pairingTopic:S,controller:{publicKey:X,metadata:this.client.metadata},expiry:jr(co)},_&&{sessionProperties:_});await this.client.core.relayer.subscribe(F),await this.sendRequest({topic:F,method:"wc_sessionSettle",params:se,throwOnFailedPublish:!0});const ce=Bn(ar({},se),{topic:F,pairingTopic:S,acknowledged:!1,self:se.controller,peer:{publicKey:D.publicKey,metadata:D.metadata},controller:X});return await this.client.session.set(F,ce),await this.setExpiry(F,jr(co)),{topic:F,acknowledged:()=>new Promise(pe=>setTimeout(()=>pe(this.client.session.get(F)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:o}=r,{pairingTopic:p}=this.client.proposal.get(s);p&&(await this.sendError(s,p,o),await this.client.proposal.delete(s,er("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:o}=r,p=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:_,resolve:b,reject:S}=fn();return this.events.once(Ft("session_update",p),({error:D})=>{D?S(D):b()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:_}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:p,resolve:_,reject:b}=fn();return this.events.once(Ft("session_extend",o),({error:S})=>{S?b(S):_()}),await this.setExpiry(s,jr(co)),{acknowledged:p}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:o,topic:p,expiry:_}=r,b=Nc(),{done:S,resolve:D,reject:$}=fn(_,"Request expired. Please try again.");return this.events.once(Ft("session_request",b),({error:K,result:X})=>{K?$(K):D(X)}),await Promise.all([new Promise(async K=>{await this.sendRequest({clientRpcId:b,topic:p,method:"wc_sessionRequest",params:{request:o,chainId:s},expiry:_,throwOnFailedPublish:!0}).catch(X=>$(X)),this.client.events.emit("session_request_sent",{topic:p,request:o,chainId:s,id:b}),K()}),new Promise(async K=>{const X=await this.client.core.storage.getItem(wl);$_({id:b,topic:p,wcDeepLink:X}),K()}),S()]).then(K=>K[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:o}=r,{id:p}=o;si(o)?await this.sendResult({id:p,topic:s,result:o.result,throwOnFailedPublish:!0}):$r(o)&&await this.sendError(p,s,o.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:p,resolve:_,reject:b}=fn();this.events.once(Ft("session_ping",o),({error:S})=>{S?b(S):_()}),await p()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:o,chainId:p}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:p}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:er("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>L_(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(p=>{var _,b;return((_=p.peerMetadata)==null?void 0:_.url)&&((b=p.peerMetadata)==null?void 0:b.url)===r.peer.metadata.url&&p.topic&&p.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(p=>this.client.core.pairing.disconnect({topic:p.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,er("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(wl).catch(p=>this.client.logger.warn(p))},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,er("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),o?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(p=>p.id!==r),o&&(this.sessionRequestQueue.state=ni.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=Hn.wc_sessionRequest.req.ttl,{id:o,topic:p,params:_,verifyContext:b}=r;await this.client.pendingRequest.set(o,{id:o,topic:p,params:_,verifyContext:b}),s&&this.client.core.expirer.set(o,jr(s))},this.sendRequest=async r=>{const{topic:s,method:o,params:p,expiry:_,relayRpcId:b,clientRpcId:S,throwOnFailedPublish:D}=r,$=yn(o,p,S);if(zl()&&iE.includes(o)){const Q=gn(JSON.stringify($));this.client.core.verify.register({attestationId:Q})}const K=await this.client.core.crypto.encode(s,$),X=Hn[o].req;return _&&(X.ttl=_),b&&(X.id=b),this.client.core.history.set(s,$),D?(X.internal=Bn(ar({},X.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,K,X)):this.client.core.relayer.publish(s,K,X).catch(Q=>this.client.logger.error(Q)),$.id},this.sendResult=async r=>{const{id:s,topic:o,result:p,throwOnFailedPublish:_}=r,b=Fc(s,p),S=await this.client.core.crypto.encode(o,b),D=await this.client.core.history.get(o,s),$=Hn[D.request.method].res;_?($.internal=Bn(ar({},$.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,S,$)):this.client.core.relayer.publish(o,S,$).catch(K=>this.client.logger.error(K)),await this.client.core.history.resolve(b)},this.sendError=async(r,s,o)=>{const p=So(r,o),_=await this.client.core.crypto.encode(s,p),b=await this.client.core.history.get(s,r),S=Hn[b.request.method].res;this.client.core.relayer.publish(s,_,S),await this.client.core.history.resolve(p)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(o=>{mi(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{mi(o.expiry)&&s.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ni.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ni.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=ni.idle},this.processRequest=r=>{const{topic:s,payload:o}=r,p=o.method;switch(p){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${p}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:o}=r,p=(await this.client.core.history.get(s,o.id)).request.method;switch(p){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${p}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:o}=ie("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,s)=>{const{params:o,id:p}=s;try{this.isValidConnect(ar({},s.params));const _=jr(de.FIVE_MINUTES),b=ar({id:p,pairingTopic:r,expiry:_},o);await this.setProposal(p,b);const S=gn(JSON.stringify(s)),D=await this.getVerifyContext(S,b.proposer.metadata);this.client.events.emit("session_proposal",{id:p,params:b,verifyContext:D})}catch(_){await this.sendError(p,r,_),this.client.logger.error(_)}},this.onSessionProposeResponse=async(r,s)=>{const{id:o}=s;if(si(s)){const{result:p}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:p});const _=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:_});const b=_.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:b});const S=p.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:S});const D=await this.client.core.crypto.generateSharedKey(b,S);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:D});const $=await this.client.core.relayer.subscribe(D);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:$}),await this.client.core.pairing.activate({topic:r})}else $r(s)&&(await this.client.proposal.delete(o,er("USER_DISCONNECTED")),this.events.emit(Ft("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:o,params:p}=s;try{this.isValidSessionSettleRequest(p);const{relay:_,controller:b,expiry:S,namespaces:D,requiredNamespaces:$,optionalNamespaces:K,sessionProperties:X,pairingTopic:Q}=s.params,F=ar({topic:r,relay:_,expiry:S,namespaces:D,acknowledged:!0,pairingTopic:Q,requiredNamespaces:$,optionalNamespaces:K,controller:b.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:b.publicKey,metadata:b.metadata}},X&&{sessionProperties:X});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(Ft("session_connect"),{session:F}),this.cleanupDuplicatePairings(F)}catch(_){await this.sendError(o,r,_),this.client.logger.error(_)}},this.onSessionSettleResponse=async(r,s)=>{const{id:o}=s;si(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ft("session_approve",o),{})):$r(s)&&(await this.client.session.delete(r,er("USER_DISCONNECTED")),this.events.emit(Ft("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:o,id:p}=s;try{const _=`${r}_session_update`,b=oo.get(_);if(b&&this.isRequestOutOfSync(b,p)){this.client.logger.info(`Discarding out of sync request - ${p}`);return}this.isValidUpdate(ar({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult({id:p,topic:r,result:!0}),this.client.events.emit("session_update",{id:p,topic:r,params:o}),oo.set(_,p)}catch(_){await this.sendError(p,r,_),this.client.logger.error(_)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:o}=s;si(s)?this.events.emit(Ft("session_update",o),{}):$r(s)&&this.events.emit(Ft("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:o}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,jr(co)),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_extend",{id:o,topic:r})}catch(p){await this.sendError(o,r,p),this.client.logger.error(p)}},this.onSessionExtendResponse=(r,s)=>{const{id:o}=s;si(s)?this.events.emit(Ft("session_extend",o),{}):$r(s)&&this.events.emit(Ft("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:o}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_ping",{id:o,topic:r})}catch(p){await this.sendError(o,r,p),this.client.logger.error(p)}},this.onSessionPingResponse=(r,s)=>{const{id:o}=s;setTimeout(()=>{si(s)?this.events.emit(Ft("session_ping",o),{}):$r(s)&&this.events.emit(Ft("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(p=>{this.client.core.relayer.once(Gt.publish,async()=>{p(await this.deleteSession(r))})}),this.sendResult({id:o,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(p){this.client.logger.error(p)}},this.onSessionRequest=async(r,s)=>{const{id:o,params:p}=s;try{this.isValidRequest(ar({topic:r},p));const _=gn(JSON.stringify(yn("wc_sessionRequest",p,o))),b=this.client.session.get(r),S=await this.getVerifyContext(_,b.peer.metadata),D={id:o,topic:r,params:p,verifyContext:S};await this.setPendingSessionRequest(D),this.addSessionRequestToSessionRequestQueue(D),this.processSessionRequestQueue()}catch(_){await this.sendError(o,r,_),this.client.logger.error(_)}},this.onSessionRequestResponse=(r,s)=>{const{id:o}=s;si(s)?this.events.emit(Ft("session_request",o),{result:s.result}):$r(s)&&this.events.emit(Ft("session_request",o),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:o,params:p}=s;try{const _=`${r}_session_event_${p.event.name}`,b=oo.get(_);if(b&&this.isRequestOutOfSync(b,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(ar({topic:r},p)),this.client.events.emit("session_event",{id:o,topic:r,params:p}),oo.set(_,o)}catch(_){await this.sendError(o,r,_),this.client.logger.error(_)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ni.idle,this.processSessionRequestQueue()},de.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===ni.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=ni.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,yn("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer},s.id))},this.isValidConnect=async r=>{if(!cr(r)){const{message:S}=ie("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(S)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:p,sessionProperties:_,relays:b}=r;if(wi(s)||await this.isValidPairingTopic(s),!q_(b,!0)){const{message:S}=ie("MISSING_OR_INVALID",`connect() relays: ${b}`);throw new Error(S)}!wi(o)&&fo(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!wi(p)&&fo(p)!==0&&this.validateNamespaces(p,"optionalNamespaces"),wi(_)||this.validateSessionProps(_,"sessionProperties")},this.validateNamespaces=(r,s)=>{const o=M_(r,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!cr(r))throw new Error(ie("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:o,relayProtocol:p,sessionProperties:_}=r;await this.isValidProposalId(s);const b=this.client.proposal.get(s),S=Za(o,"approve()");if(S)throw new Error(S.message);const D=kh(b.requiredNamespaces,o,"approve()");if(D)throw new Error(D.message);if(!pn(p,!0)){const{message:$}=ie("MISSING_OR_INVALID",`approve() relayProtocol: ${p}`);throw new Error($)}wi(_)||this.validateSessionProps(_,"sessionProperties")},this.isValidReject=async r=>{if(!cr(r)){const{message:p}=ie("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(p)}const{id:s,reason:o}=r;if(await this.isValidProposalId(s),!z_(o)){const{message:p}=ie("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(p)}},this.isValidSessionSettleRequest=r=>{if(!cr(r)){const{message:D}=ie("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(D)}const{relay:s,controller:o,namespaces:p,expiry:_}=r;if(!U_(s)){const{message:D}=ie("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(D)}const b=H_(o,"onSessionSettleRequest()");if(b)throw new Error(b.message);const S=Za(p,"onSessionSettleRequest()");if(S)throw new Error(S.message);if(mi(_)){const{message:D}=ie("EXPIRED","onSessionSettleRequest()");throw new Error(D)}},this.isValidUpdate=async r=>{if(!cr(r)){const{message:S}=ie("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(S)}const{topic:s,namespaces:o}=r;await this.isValidSessionTopic(s);const p=this.client.session.get(s),_=Za(o,"update()");if(_)throw new Error(_.message);const b=kh(p.requiredNamespaces,o,"update()");if(b)throw new Error(b.message)},this.isValidExtend=async r=>{if(!cr(r)){const{message:o}=ie("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!cr(r)){const{message:S}=ie("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(S)}const{topic:s,request:o,chainId:p,expiry:_}=r;await this.isValidSessionTopic(s);const{namespaces:b}=this.client.session.get(s);if(!Vh(b,p)){const{message:S}=ie("MISSING_OR_INVALID",`request() chainId: ${p}`);throw new Error(S)}if(!B_(o)){const{message:S}=ie("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(S)}if(!k_(b,p,o.method)){const{message:S}=ie("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(S)}if(_&&!V_(_,cc)){const{message:S}=ie("MISSING_OR_INVALID",`request() expiry: ${_}. Expiry must be a number (in seconds) between ${cc.min} and ${cc.max}`);throw new Error(S)}},this.isValidRespond=async r=>{if(!cr(r)){const{message:p}=ie("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(p)}const{topic:s,response:o}=r;if(await this.isValidSessionTopic(s),!K_(o)){const{message:p}=ie("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(p)}},this.isValidPing=async r=>{if(!cr(r)){const{message:o}=ie("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!cr(r)){const{message:b}=ie("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(b)}const{topic:s,event:o,chainId:p}=r;await this.isValidSessionTopic(s);const{namespaces:_}=this.client.session.get(s);if(!Vh(_,p)){const{message:b}=ie("MISSING_OR_INVALID",`emit() chainId: ${p}`);throw new Error(b)}if(!G_(o)){const{message:b}=ie("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(b)}if(!W_(_,p,o.name)){const{message:b}=ie("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(b)}},this.isValidDisconnect=async r=>{if(!cr(r)){const{message:o}=ie("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const o={verified:{verifyUrl:s.verifyUrl||go,validation:"UNKNOWN",origin:s.url||""}};try{const p=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});p&&(o.verified.origin=p.origin,o.verified.isScam=p.isScam,o.verified.validation=p.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(p){this.client.logger.info(p)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(o=>{if(!pn(o,!1)){const{message:p}=ie("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(p)}})}}async isInitialized(){if(!this.initialized){const{message:i}=ie("NOT_INITIALIZED",this.name);throw new Error(i)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Gt.message,async i=>{const{topic:r,message:s}=i;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(r,s);try{jc(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Po(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.client.core.history.delete(r,o.id)):this.onRelayEventUnknownPayload({topic:r,payload:o})}catch(p){this.client.logger.error(p)}})}registerExpirerEvents(){this.client.core.expirer.on(Sr.expired,async i=>{const{topic:r,id:s}=Ml(i.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ie("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(Kn.create,i=>this.onPairingCreated(i))}isValidPairingTopic(i){if(!pn(i,!1)){const{message:r}=ie("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(i)){const{message:r}=ie("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(r)}if(mi(this.client.core.pairing.pairings.get(i).expiry)){const{message:r}=ie("EXPIRED",`pairing topic: ${i}`);throw new Error(r)}}async isValidSessionTopic(i){if(!pn(i,!1)){const{message:r}=ie("MISSING_OR_INVALID",`session topic should be a string: ${i}`);throw new Error(r)}if(!this.client.session.keys.includes(i)){const{message:r}=ie("NO_MATCHING_KEY",`session topic doesn't exist: ${i}`);throw new Error(r)}if(mi(this.client.session.get(i).expiry)){await this.deleteSession(i);const{message:r}=ie("EXPIRED",`session topic: ${i}`);throw new Error(r)}}async isValidSessionOrPairingTopic(i){if(this.client.session.keys.includes(i))await this.isValidSessionTopic(i);else if(this.client.core.pairing.pairings.keys.includes(i))this.isValidPairingTopic(i);else if(pn(i,!1)){const{message:r}=ie("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${i}`);throw new Error(r)}else{const{message:r}=ie("MISSING_OR_INVALID",`session or pairing topic should be a string: ${i}`);throw new Error(r)}}async isValidProposalId(i){if(!J_(i)){const{message:r}=ie("MISSING_OR_INVALID",`proposal id should be a number: ${i}`);throw new Error(r)}if(!this.client.proposal.keys.includes(i)){const{message:r}=ie("NO_MATCHING_KEY",`proposal id doesn't exist: ${i}`);throw new Error(r)}if(mi(this.client.proposal.get(i).expiry)){await this.deleteProposal(i);const{message:r}=ie("EXPIRED",`proposal id: ${i}`);throw new Error(r)}}}class hE extends Ao{constructor(i,r){super(i,r,Zb,qc),this.core=i,this.logger=r}}class lE extends Ao{constructor(i,r){super(i,r,eE,qc),this.core=i,this.logger=r}}class fE extends Ao{constructor(i,r){super(i,r,rE,qc,s=>s.id),this.core=i,this.logger=r}}class Mc extends Hm{constructor(i){super(i),this.protocol=Rf,this.version=Tf,this.name=ac.name,this.events=new Pr.exports.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=i?.name||ac.name,this.metadata=i?.metadata||Q_();const r=typeof i?.logger<"u"&&typeof i?.logger!="string"?i.logger:Fe.pino(Fe.getDefaultLoggerOptions({level:i?.logger||ac.logger}));this.core=i?.core||new Xb(i),this.logger=Fe.generateChildLogger(r,this.name),this.session=new lE(this.core,this.logger),this.proposal=new hE(this.core,this.logger),this.pendingRequest=new fE(this.core,this.logger),this.engine=new uE(this)}static async init(i){const r=new Mc(i);return await r.initialize(),r}get context(){return Fe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(i){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(i.message),i}}}var mc={exports:{}};(function(a,i){var r=typeof self<"u"?self:mt,s=function(){function p(){this.fetch=!1,this.DOMException=r.DOMException}return p.prototype=r,new p}();(function(p){(function(_){var b={searchParams:"URLSearchParams"in p,iterable:"Symbol"in p&&"iterator"in Symbol,blob:"FileReader"in p&&"Blob"in p&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in p,arrayBuffer:"ArrayBuffer"in p};function S(l){return l&&DataView.prototype.isPrototypeOf(l)}if(b.arrayBuffer)var D=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],$=ArrayBuffer.isView||function(l){return l&&D.indexOf(Object.prototype.toString.call(l))>-1};function K(l){if(typeof l!="string"&&(l=String(l)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(l))throw new TypeError("Invalid character in header field name");return l.toLowerCase()}function X(l){return typeof l!="string"&&(l=String(l)),l}function Q(l){var h={next:function(){var P=l.shift();return{done:P===void 0,value:P}}};return b.iterable&&(h[Symbol.iterator]=function(){return h}),h}function F(l){this.map={},l instanceof F?l.forEach(function(h,P){this.append(P,h)},this):Array.isArray(l)?l.forEach(function(h){this.append(h[0],h[1])},this):l&&Object.getOwnPropertyNames(l).forEach(function(h){this.append(h,l[h])},this)}F.prototype.append=function(l,h){l=K(l),h=X(h);var P=this.map[l];this.map[l]=P?P+", "+h:h},F.prototype.delete=function(l){delete this.map[K(l)]},F.prototype.get=function(l){return l=K(l),this.has(l)?this.map[l]:null},F.prototype.has=function(l){return this.map.hasOwnProperty(K(l))},F.prototype.set=function(l,h){this.map[K(l)]=X(h)},F.prototype.forEach=function(l,h){for(var P in this.map)this.map.hasOwnProperty(P)&&l.call(h,this.map[P],P,this)},F.prototype.keys=function(){var l=[];return this.forEach(function(h,P){l.push(P)}),Q(l)},F.prototype.values=function(){var l=[];return this.forEach(function(h){l.push(h)}),Q(l)},F.prototype.entries=function(){var l=[];return this.forEach(function(h,P){l.push([P,h])}),Q(l)},b.iterable&&(F.prototype[Symbol.iterator]=F.prototype.entries);function se(l){if(l.bodyUsed)return Promise.reject(new TypeError("Already read"));l.bodyUsed=!0}function ce(l){return new Promise(function(h,P){l.onload=function(){h(l.result)},l.onerror=function(){P(l.error)}})}function pe(l){var h=new FileReader,P=ce(h);return h.readAsArrayBuffer(l),P}function le(l){var h=new FileReader,P=ce(h);return h.readAsText(l),P}function ue(l){for(var h=new Uint8Array(l),P=new Array(h.length),M=0;M<h.length;M++)P[M]=String.fromCharCode(h[M]);return P.join("")}function ne(l){if(l.slice)return l.slice(0);var h=new Uint8Array(l.byteLength);return h.set(new Uint8Array(l)),h.buffer}function he(){return this.bodyUsed=!1,this._initBody=function(l){this._bodyInit=l,l?typeof l=="string"?this._bodyText=l:b.blob&&Blob.prototype.isPrototypeOf(l)?this._bodyBlob=l:b.formData&&FormData.prototype.isPrototypeOf(l)?this._bodyFormData=l:b.searchParams&&URLSearchParams.prototype.isPrototypeOf(l)?this._bodyText=l.toString():b.arrayBuffer&&b.blob&&S(l)?(this._bodyArrayBuffer=ne(l.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):b.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(l)||$(l))?this._bodyArrayBuffer=ne(l):this._bodyText=l=Object.prototype.toString.call(l):this._bodyText="",this.headers.get("content-type")||(typeof l=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):b.searchParams&&URLSearchParams.prototype.isPrototypeOf(l)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},b.blob&&(this.blob=function(){var l=se(this);if(l)return l;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?se(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(pe)}),this.text=function(){var l=se(this);if(l)return l;if(this._bodyBlob)return le(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(ue(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},b.formData&&(this.formData=function(){return this.text().then(Se)}),this.json=function(){return this.text().then(JSON.parse)},this}var fe=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function ee(l){var h=l.toUpperCase();return fe.indexOf(h)>-1?h:l}function j(l,h){h=h||{};var P=h.body;if(l instanceof j){if(l.bodyUsed)throw new TypeError("Already read");this.url=l.url,this.credentials=l.credentials,h.headers||(this.headers=new F(l.headers)),this.method=l.method,this.mode=l.mode,this.signal=l.signal,!P&&l._bodyInit!=null&&(P=l._bodyInit,l.bodyUsed=!0)}else this.url=String(l);if(this.credentials=h.credentials||this.credentials||"same-origin",(h.headers||!this.headers)&&(this.headers=new F(h.headers)),this.method=ee(h.method||this.method||"GET"),this.mode=h.mode||this.mode||null,this.signal=h.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&P)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(P)}j.prototype.clone=function(){return new j(this,{body:this._bodyInit})};function Se(l){var h=new FormData;return l.trim().split("&").forEach(function(P){if(P){var M=P.split("="),H=M.shift().replace(/\+/g," "),E=M.join("=").replace(/\+/g," ");h.append(decodeURIComponent(H),decodeURIComponent(E))}}),h}function f(l){var h=new F,P=l.replace(/\r?\n[\t ]+/g," ");return P.split(/\r?\n/).forEach(function(M){var H=M.split(":"),E=H.shift().trim();if(E){var q=H.join(":").trim();h.append(E,q)}}),h}he.call(j.prototype);function g(l,h){h||(h={}),this.type="default",this.status=h.status===void 0?200:h.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in h?h.statusText:"OK",this.headers=new F(h.headers),this.url=h.url||"",this._initBody(l)}he.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new F(this.headers),url:this.url})},g.error=function(){var l=new g(null,{status:0,statusText:""});return l.type="error",l};var y=[301,302,303,307,308];g.redirect=function(l,h){if(y.indexOf(h)===-1)throw new RangeError("Invalid status code");return new g(null,{status:h,headers:{location:l}})},_.DOMException=p.DOMException;try{new _.DOMException}catch{_.DOMException=function(h,P){this.message=h,this.name=P;var M=Error(h);this.stack=M.stack},_.DOMException.prototype=Object.create(Error.prototype),_.DOMException.prototype.constructor=_.DOMException}function I(l,h){return new Promise(function(P,M){var H=new j(l,h);if(H.signal&&H.signal.aborted)return M(new _.DOMException("Aborted","AbortError"));var E=new XMLHttpRequest;function q(){E.abort()}E.onload=function(){var W={status:E.status,statusText:E.statusText,headers:f(E.getAllResponseHeaders()||"")};W.url="responseURL"in E?E.responseURL:W.headers.get("X-Request-URL");var Y="response"in E?E.response:E.responseText;P(new g(Y,W))},E.onerror=function(){M(new TypeError("Network request failed"))},E.ontimeout=function(){M(new TypeError("Network request failed"))},E.onabort=function(){M(new _.DOMException("Aborted","AbortError"))},E.open(H.method,H.url,!0),H.credentials==="include"?E.withCredentials=!0:H.credentials==="omit"&&(E.withCredentials=!1),"responseType"in E&&b.blob&&(E.responseType="blob"),H.headers.forEach(function(W,Y){E.setRequestHeader(Y,W)}),H.signal&&(H.signal.addEventListener("abort",q),E.onreadystatechange=function(){E.readyState===4&&H.signal.removeEventListener("abort",q)}),E.send(typeof H._bodyInit>"u"?null:H._bodyInit)})}return I.polyfill=!0,p.fetch||(p.fetch=I,p.Headers=F,p.Request=j,p.Response=g),_.Headers=F,_.Request=j,_.Response=g,_.fetch=I,Object.defineProperty(_,"__esModule",{value:!0}),_})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;i=o.fetch,i.default=o.fetch,i.fetch=o.fetch,i.Headers=o.Headers,i.Request=o.Request,i.Response=o.Response,a.exports=i})(mc,mc.exports);var Il=Y_(mc.exports);const pE={Accept:"application/json","Content-Type":"application/json"},dE="POST",xl={headers:pE,method:dE},Sl=10;class Si{constructor(i,r=!1){if(this.url=i,this.disableProviderPing=r,this.events=new Pr.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!Yh(i))throw new Error(`Provided URL is not compatible with HTTP connection: ${i}`);this.url=i,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async open(i=this.url){await this.register(i)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(i,r){this.isAvailable||await this.register();try{const s=Xn(i),p=await(await Il(this.url,Object.assign(Object.assign({},xl),{body:s}))).json();this.onPayload({data:p})}catch(s){this.onError(i.id,s)}}async register(i=this.url){if(!Yh(i))throw new Error(`Provided URL is not compatible with HTTP connection: ${i}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",p=>{this.resetMaxListeners(),o(p)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=i,this.registering=!0;try{if(!this.disableProviderPing){const r=Xn({id:1,jsonrpc:"2.0",method:"test",params:[]});await Il(i,Object.assign(Object.assign({},xl),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(i){if(typeof i.data>"u")return;const r=typeof i.data=="string"?Rc(i.data):i.data;this.events.emit("payload",r)}onError(i,r){const s=this.parseError(r),o=s.message||s.toString(),p=So(i,o);this.events.emit("payload",p)}parseError(i,r=this.url){return of(i,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Sl&&this.events.setMaxListeners(Sl)}}const Pl="error",gE="wss://relay.walletconnect.com",yE="wc",vE="universal_provider",Ol=`${yE}@2:${vE}:`,_E="https://rpc.walletconnect.com/v1/",ai={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var kn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},wc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,i){(function(){var r,s="4.17.21",o=200,p="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",_="Expected a function",b="Invalid `variable` option passed into `_.template`",S="__lodash_hash_undefined__",D=500,$="__lodash_placeholder__",K=1,X=2,Q=4,F=1,se=2,ce=1,pe=2,le=4,ue=8,ne=16,he=32,fe=64,ee=128,j=256,Se=512,f=30,g="...",y=800,I=16,l=1,h=2,P=3,M=1/0,H=9007199254740991,E=17976931348623157e292,q=0/0,W=4294967295,Y=W-1,ye=W>>>1,ot=[["ary",ee],["bind",ce],["bindKey",pe],["curry",ue],["curryRight",ne],["flip",Se],["partial",he],["partialRight",fe],["rearg",j]],we="[object Arguments]",Or="[object Array]",U="[object AsyncFunction]",z="[object Boolean]",N="[object Date]",u="[object DOMException]",A="[object Error]",oe="[object Function]",me="[object GeneratorFunction]",Pe="[object Map]",je="[object Number]",Le="[object Null]",Te="[object Object]",St="[object Promise]",wt="[object Proxy]",at="[object RegExp]",Me="[object Set]",Ye="[object String]",Xe="[object Symbol]",ct="[object Undefined]",Be="[object WeakMap]",Ze="[object WeakSet]",$e="[object ArrayBuffer]",Ve="[object DataView]",lt="[object Float32Array]",Ue="[object Float64Array]",Pt="[object Int8Array]",jt="[object Int16Array]",Ut="[object Int32Array]",Ht="[object Uint8Array]",qt="[object Uint8ClampedArray]",Wt="[object Uint16Array]",tr="[object Uint32Array]",Lr=/\b__p \+= '';/g,Jt=/\b(__p \+=) '' \+/g,Vr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ci=/&(?:amp|lt|gt|quot|#39);/g,Pi=/[&<>"']/g,ft=RegExp(ci.source),rt=RegExp(Pi.source),pt=/<%-([\s\S]+?)%>/g,dt=/<%([\s\S]+?)%>/g,ut=/<%=([\s\S]+?)%>/g,it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ot=/^\w*$/,At=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,gt=/[\\^$.*+?()[\]{}|]/g,Rt=RegExp(gt.source),yt=/^\s+/,bt=/\s/,vt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qe=/\{\n\/\* \[wrapped with (.+)\] \*/,Tt=/,? & /,Ct=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ro=/[()=,{}\[\]\/\s]/,To=/\\(\\)?/g,Co=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yr=/\w*$/,Do=/^[-+]0x[0-9a-f]+$/i,No=/^0b[01]+$/i,Fo=/^\[object .+?Constructor\]$/,jo=/^0o[0-7]+$/i,$o=/^(?:0|[1-9]\d*)$/,Kr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Bi=/($^)/,Lo=/['\n\r\u2028\u2029\\]/g,ki="\\ud800-\\udfff",qo="\\u0300-\\u036f",Mo="\\ufe20-\\ufe2f",Vi="\\u20d0-\\u20ff",rs=qo+Mo+Vi,is="\\u2700-\\u27bf",Ar="a-z\\xdf-\\xf6\\xf8-\\xff",zo="\\xac\\xb1\\xd7\\xf7",Uo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ho="\\u2000-\\u206f",Bo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ns="A-Z\\xc0-\\xd6\\xd8-\\xde",ss="\\ufe0e\\ufe0f",Oi=zo+Uo+Ho+Bo,bn="['\u2019]",Ai="["+ki+"]",En="["+Oi+"]",Ri="["+rs+"]",os="\\d+",ko="["+is+"]",as="["+Ar+"]",cs="[^"+ki+Oi+os+is+Ar+ns+"]",Ki="\\ud83c[\\udffb-\\udfff]",Vo="(?:"+Ri+"|"+Ki+")",us="[^"+ki+"]",Gi="(?:\\ud83c[\\udde6-\\uddff]){2}",ui="[\\ud800-\\udbff][\\udc00-\\udfff]",hr="["+ns+"]",hs="\\u200d",ls="(?:"+as+"|"+cs+")",qr="(?:"+hr+"|"+cs+")",fs="(?:"+bn+"(?:d|ll|m|re|s|t|ve))?",ps="(?:"+bn+"(?:D|LL|M|RE|S|T|VE))?",ds=Vo+"?",gs="["+ss+"]?",Ko="(?:"+hs+"(?:"+[us,Gi,ui].join("|")+")"+gs+ds+")*",Gr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ys="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",vs=gs+ds+Ko,Wi="(?:"+[ko,Gi,ui].join("|")+")"+vs,Go="(?:"+[us+Ri+"?",Ri,Gi,ui,Ai].join("|")+")",In=RegExp(bn,"g"),Wo=RegExp(Ri,"g"),Ji=RegExp(Ki+"(?="+Ki+")|"+Go+vs,"g"),_s=RegExp([hr+"?"+as+"+"+fs+"(?="+[En,hr,"$"].join("|")+")",qr+"+"+ps+"(?="+[En,hr+ls,"$"].join("|")+")",hr+"?"+ls+"+"+fs,hr+"+"+ps,ys,Gr,os,Wi].join("|"),"g"),ms=RegExp("["+hs+ki+rs+ss+"]"),Ti=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ws=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Jo=-1,Ke={};Ke[lt]=Ke[Ue]=Ke[Pt]=Ke[jt]=Ke[Ut]=Ke[Ht]=Ke[qt]=Ke[Wt]=Ke[tr]=!0,Ke[we]=Ke[Or]=Ke[$e]=Ke[z]=Ke[Ve]=Ke[N]=Ke[A]=Ke[oe]=Ke[Pe]=Ke[je]=Ke[Te]=Ke[at]=Ke[Me]=Ke[Ye]=Ke[Be]=!1;var ke={};ke[we]=ke[Or]=ke[$e]=ke[Ve]=ke[z]=ke[N]=ke[lt]=ke[Ue]=ke[Pt]=ke[jt]=ke[Ut]=ke[Pe]=ke[je]=ke[Te]=ke[at]=ke[Me]=ke[Ye]=ke[Xe]=ke[Ht]=ke[qt]=ke[Wt]=ke[tr]=!0,ke[A]=ke[oe]=ke[Be]=!1;var w={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},R={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},G={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},te={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ge=parseFloat,Ee=parseInt,et=typeof kn=="object"&&kn&&kn.Object===Object&&kn,Dt=typeof self=="object"&&self&&self.Object===Object&&self,De=et||Dt||Function("return this")(),We=i&&!i.nodeType&&i,Et=We&&!0&&a&&!a.nodeType&&a,rr=Et&&Et.exports===We,Nt=rr&&et.process,tt=function(){try{var T=Et&&Et.require&&Et.require("util").types;return T||Nt&&Nt.binding&&Nt.binding("util")}catch{}}(),Qt=tt&&tt.isArrayBuffer,Rr=tt&&tt.isDate,vr=tt&&tt.isMap,Mr=tt&&tt.isRegExp,xn=tt&&tt.isSet,Ci=tt&&tt.isTypedArray;function Mt(T,B,L){switch(L.length){case 0:return T.call(B);case 1:return T.call(B,L[0]);case 2:return T.call(B,L[0],L[1]);case 3:return T.call(B,L[0],L[1],L[2])}return T.apply(B,L)}function jf(T,B,L,re){for(var be=-1,qe=T==null?0:T.length;++be<qe;){var $t=T[be];B(re,$t,L($t),T)}return re}function _r(T,B){for(var L=-1,re=T==null?0:T.length;++L<re&&B(T[L],L,T)!==!1;);return T}function $f(T,B){for(var L=T==null?0:T.length;L--&&B(T[L],L,T)!==!1;);return T}function Hc(T,B){for(var L=-1,re=T==null?0:T.length;++L<re;)if(!B(T[L],L,T))return!1;return!0}function hi(T,B){for(var L=-1,re=T==null?0:T.length,be=0,qe=[];++L<re;){var $t=T[L];B($t,L,T)&&(qe[be++]=$t)}return qe}function bs(T,B){var L=T==null?0:T.length;return!!L&&Qi(T,B,0)>-1}function Qo(T,B,L){for(var re=-1,be=T==null?0:T.length;++re<be;)if(L(B,T[re]))return!0;return!1}function nt(T,B){for(var L=-1,re=T==null?0:T.length,be=Array(re);++L<re;)be[L]=B(T[L],L,T);return be}function li(T,B){for(var L=-1,re=B.length,be=T.length;++L<re;)T[be+L]=B[L];return T}function Yo(T,B,L,re){var be=-1,qe=T==null?0:T.length;for(re&&qe&&(L=T[++be]);++be<qe;)L=B(L,T[be],be,T);return L}function Lf(T,B,L,re){var be=T==null?0:T.length;for(re&&be&&(L=T[--be]);be--;)L=B(L,T[be],be,T);return L}function Xo(T,B){for(var L=-1,re=T==null?0:T.length;++L<re;)if(B(T[L],L,T))return!0;return!1}var qf=Zo("length");function Mf(T){return T.split("")}function zf(T){return T.match(Ct)||[]}function Bc(T,B,L){var re;return L(T,function(be,qe,$t){if(B(be,qe,$t))return re=qe,!1}),re}function Es(T,B,L,re){for(var be=T.length,qe=L+(re?1:-1);re?qe--:++qe<be;)if(B(T[qe],qe,T))return qe;return-1}function Qi(T,B,L){return B===B?Xf(T,B,L):Es(T,kc,L)}function Uf(T,B,L,re){for(var be=L-1,qe=T.length;++be<qe;)if(re(T[be],B))return be;return-1}function kc(T){return T!==T}function Vc(T,B){var L=T==null?0:T.length;return L?ta(T,B)/L:q}function Zo(T){return function(B){return B==null?r:B[T]}}function ea(T){return function(B){return T==null?r:T[B]}}function Kc(T,B,L,re,be){return be(T,function(qe,$t,Je){L=re?(re=!1,qe):B(L,qe,$t,Je)}),L}function Hf(T,B){var L=T.length;for(T.sort(B);L--;)T[L]=T[L].value;return T}function ta(T,B){for(var L,re=-1,be=T.length;++re<be;){var qe=B(T[re]);qe!==r&&(L=L===r?qe:L+qe)}return L}function ra(T,B){for(var L=-1,re=Array(T);++L<T;)re[L]=B(L);return re}function Bf(T,B){return nt(B,function(L){return[L,T[L]]})}function Gc(T){return T&&T.slice(0,Yc(T)+1).replace(yt,"")}function lr(T){return function(B){return T(B)}}function ia(T,B){return nt(B,function(L){return T[L]})}function Sn(T,B){return T.has(B)}function Wc(T,B){for(var L=-1,re=T.length;++L<re&&Qi(B,T[L],0)>-1;);return L}function Jc(T,B){for(var L=T.length;L--&&Qi(B,T[L],0)>-1;);return L}function kf(T,B){for(var L=T.length,re=0;L--;)T[L]===B&&++re;return re}var Vf=ea(w),Kf=ea(R);function Gf(T){return"\\"+te[T]}function Wf(T,B){return T==null?r:T[B]}function Yi(T){return ms.test(T)}function Jf(T){return Ti.test(T)}function Qf(T){for(var B,L=[];!(B=T.next()).done;)L.push(B.value);return L}function na(T){var B=-1,L=Array(T.size);return T.forEach(function(re,be){L[++B]=[be,re]}),L}function Qc(T,B){return function(L){return T(B(L))}}function fi(T,B){for(var L=-1,re=T.length,be=0,qe=[];++L<re;){var $t=T[L];($t===B||$t===$)&&(T[L]=$,qe[be++]=L)}return qe}function Is(T){var B=-1,L=Array(T.size);return T.forEach(function(re){L[++B]=re}),L}function Yf(T){var B=-1,L=Array(T.size);return T.forEach(function(re){L[++B]=[re,re]}),L}function Xf(T,B,L){for(var re=L-1,be=T.length;++re<be;)if(T[re]===B)return re;return-1}function Zf(T,B,L){for(var re=L+1;re--;)if(T[re]===B)return re;return re}function Xi(T){return Yi(T)?tp(T):qf(T)}function Tr(T){return Yi(T)?rp(T):Mf(T)}function Yc(T){for(var B=T.length;B--&&bt.test(T.charAt(B)););return B}var ep=ea(G);function tp(T){for(var B=Ji.lastIndex=0;Ji.test(T);)++B;return B}function rp(T){return T.match(Ji)||[]}function ip(T){return T.match(_s)||[]}var np=function T(B){B=B==null?De:Zi.defaults(De.Object(),B,Zi.pick(De,ws));var L=B.Array,re=B.Date,be=B.Error,qe=B.Function,$t=B.Math,Je=B.Object,sa=B.RegExp,sp=B.String,mr=B.TypeError,xs=L.prototype,op=qe.prototype,en=Je.prototype,Ss=B["__core-js_shared__"],Ps=op.toString,He=en.hasOwnProperty,ap=0,Xc=function(){var e=/[^.]+$/.exec(Ss&&Ss.keys&&Ss.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Os=en.toString,cp=Ps.call(Je),up=De._,hp=sa("^"+Ps.call(He).replace(gt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),As=rr?B.Buffer:r,pi=B.Symbol,Rs=B.Uint8Array,Zc=As?As.allocUnsafe:r,Ts=Qc(Je.getPrototypeOf,Je),eu=Je.create,tu=en.propertyIsEnumerable,Cs=xs.splice,ru=pi?pi.isConcatSpreadable:r,Pn=pi?pi.iterator:r,Di=pi?pi.toStringTag:r,Ds=function(){try{var e=Li(Je,"defineProperty");return e({},"",{}),e}catch{}}(),lp=B.clearTimeout!==De.clearTimeout&&B.clearTimeout,fp=re&&re.now!==De.Date.now&&re.now,pp=B.setTimeout!==De.setTimeout&&B.setTimeout,Ns=$t.ceil,Fs=$t.floor,oa=Je.getOwnPropertySymbols,dp=As?As.isBuffer:r,iu=B.isFinite,gp=xs.join,yp=Qc(Je.keys,Je),Lt=$t.max,Vt=$t.min,vp=re.now,_p=B.parseInt,nu=$t.random,mp=xs.reverse,aa=Li(B,"DataView"),On=Li(B,"Map"),ca=Li(B,"Promise"),tn=Li(B,"Set"),An=Li(B,"WeakMap"),Rn=Li(Je,"create"),js=An&&new An,rn={},wp=qi(aa),bp=qi(On),Ep=qi(ca),Ip=qi(tn),xp=qi(An),$s=pi?pi.prototype:r,Tn=$s?$s.valueOf:r,su=$s?$s.toString:r;function v(e){if(_t(e)&&!Ie(e)&&!(e instanceof Ce)){if(e instanceof wr)return e;if(He.call(e,"__wrapped__"))return oh(e)}return new wr(e)}var nn=function(){function e(){}return function(t){if(!ht(t))return{};if(eu)return eu(t);e.prototype=t;var n=new e;return e.prototype=r,n}}();function Ls(){}function wr(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=r}v.templateSettings={escape:pt,evaluate:dt,interpolate:ut,variable:"",imports:{_:v}},v.prototype=Ls.prototype,v.prototype.constructor=v,wr.prototype=nn(Ls.prototype),wr.prototype.constructor=wr;function Ce(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=W,this.__views__=[]}function Sp(){var e=new Ce(this.__wrapped__);return e.__actions__=ir(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ir(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ir(this.__views__),e}function Pp(){if(this.__filtered__){var e=new Ce(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Op(){var e=this.__wrapped__.value(),t=this.__dir__,n=Ie(e),c=t<0,d=n?e.length:0,m=Md(0,d,this.__views__),x=m.start,O=m.end,C=O-x,k=c?O:x-1,V=this.__iteratees__,J=V.length,Z=0,ae=Vt(C,this.__takeCount__);if(!n||!c&&d==C&&ae==C)return Ru(e,this.__actions__);var ve=[];e:for(;C--&&Z<ae;){k+=t;for(var Oe=-1,_e=e[k];++Oe<J;){var Re=V[Oe],Ne=Re.iteratee,dr=Re.type,Zt=Ne(_e);if(dr==h)_e=Zt;else if(!Zt){if(dr==l)continue e;break e}}ve[Z++]=_e}return ve}Ce.prototype=nn(Ls.prototype),Ce.prototype.constructor=Ce;function Ni(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var c=e[t];this.set(c[0],c[1])}}function Ap(){this.__data__=Rn?Rn(null):{},this.size=0}function Rp(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Tp(e){var t=this.__data__;if(Rn){var n=t[e];return n===S?r:n}return He.call(t,e)?t[e]:r}function Cp(e){var t=this.__data__;return Rn?t[e]!==r:He.call(t,e)}function Dp(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Rn&&t===r?S:t,this}Ni.prototype.clear=Ap,Ni.prototype.delete=Rp,Ni.prototype.get=Tp,Ni.prototype.has=Cp,Ni.prototype.set=Dp;function Wr(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var c=e[t];this.set(c[0],c[1])}}function Np(){this.__data__=[],this.size=0}function Fp(e){var t=this.__data__,n=qs(t,e);if(n<0)return!1;var c=t.length-1;return n==c?t.pop():Cs.call(t,n,1),--this.size,!0}function jp(e){var t=this.__data__,n=qs(t,e);return n<0?r:t[n][1]}function $p(e){return qs(this.__data__,e)>-1}function Lp(e,t){var n=this.__data__,c=qs(n,e);return c<0?(++this.size,n.push([e,t])):n[c][1]=t,this}Wr.prototype.clear=Np,Wr.prototype.delete=Fp,Wr.prototype.get=jp,Wr.prototype.has=$p,Wr.prototype.set=Lp;function Jr(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var c=e[t];this.set(c[0],c[1])}}function qp(){this.size=0,this.__data__={hash:new Ni,map:new(On||Wr),string:new Ni}}function Mp(e){var t=Qs(this,e).delete(e);return this.size-=t?1:0,t}function zp(e){return Qs(this,e).get(e)}function Up(e){return Qs(this,e).has(e)}function Hp(e,t){var n=Qs(this,e),c=n.size;return n.set(e,t),this.size+=n.size==c?0:1,this}Jr.prototype.clear=qp,Jr.prototype.delete=Mp,Jr.prototype.get=zp,Jr.prototype.has=Up,Jr.prototype.set=Hp;function Fi(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new Jr;++t<n;)this.add(e[t])}function Bp(e){return this.__data__.set(e,S),this}function kp(e){return this.__data__.has(e)}Fi.prototype.add=Fi.prototype.push=Bp,Fi.prototype.has=kp;function Cr(e){var t=this.__data__=new Wr(e);this.size=t.size}function Vp(){this.__data__=new Wr,this.size=0}function Kp(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Gp(e){return this.__data__.get(e)}function Wp(e){return this.__data__.has(e)}function Jp(e,t){var n=this.__data__;if(n instanceof Wr){var c=n.__data__;if(!On||c.length<o-1)return c.push([e,t]),this.size=++n.size,this;n=this.__data__=new Jr(c)}return n.set(e,t),this.size=n.size,this}Cr.prototype.clear=Vp,Cr.prototype.delete=Kp,Cr.prototype.get=Gp,Cr.prototype.has=Wp,Cr.prototype.set=Jp;function ou(e,t){var n=Ie(e),c=!n&&Mi(e),d=!n&&!c&&_i(e),m=!n&&!c&&!d&&cn(e),x=n||c||d||m,O=x?ra(e.length,sp):[],C=O.length;for(var k in e)(t||He.call(e,k))&&!(x&&(k=="length"||d&&(k=="offset"||k=="parent")||m&&(k=="buffer"||k=="byteLength"||k=="byteOffset")||Zr(k,C)))&&O.push(k);return O}function au(e){var t=e.length;return t?e[ma(0,t-1)]:r}function Qp(e,t){return Ys(ir(e),ji(t,0,e.length))}function Yp(e){return Ys(ir(e))}function ua(e,t,n){(n!==r&&!Dr(e[t],n)||n===r&&!(t in e))&&Qr(e,t,n)}function Cn(e,t,n){var c=e[t];(!(He.call(e,t)&&Dr(c,n))||n===r&&!(t in e))&&Qr(e,t,n)}function qs(e,t){for(var n=e.length;n--;)if(Dr(e[n][0],t))return n;return-1}function Xp(e,t,n,c){return di(e,function(d,m,x){t(c,d,n(d),x)}),c}function cu(e,t){return e&&Ur(t,zt(t),e)}function Zp(e,t){return e&&Ur(t,sr(t),e)}function Qr(e,t,n){t=="__proto__"&&Ds?Ds(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ha(e,t){for(var n=-1,c=t.length,d=L(c),m=e==null;++n<c;)d[n]=m?r:ka(e,t[n]);return d}function ji(e,t,n){return e===e&&(n!==r&&(e=e<=n?e:n),t!==r&&(e=e>=t?e:t)),e}function br(e,t,n,c,d,m){var x,O=t&K,C=t&X,k=t&Q;if(n&&(x=d?n(e,c,d,m):n(e)),x!==r)return x;if(!ht(e))return e;var V=Ie(e);if(V){if(x=Ud(e),!O)return ir(e,x)}else{var J=Kt(e),Z=J==oe||J==me;if(_i(e))return Du(e,O);if(J==Te||J==we||Z&&!d){if(x=C||Z?{}:Yu(e),!O)return C?Td(e,Zp(x,e)):Rd(e,cu(x,e))}else{if(!ke[J])return d?e:{};x=Hd(e,J,O)}}m||(m=new Cr);var ae=m.get(e);if(ae)return ae;m.set(e,x),Ph(e)?e.forEach(function(_e){x.add(br(_e,t,n,_e,e,m))}):xh(e)&&e.forEach(function(_e,Re){x.set(Re,br(_e,t,n,Re,e,m))});var ve=k?C?Ta:Ra:C?sr:zt,Oe=V?r:ve(e);return _r(Oe||e,function(_e,Re){Oe&&(Re=_e,_e=e[Re]),Cn(x,Re,br(_e,t,n,Re,e,m))}),x}function ed(e){var t=zt(e);return function(n){return uu(n,e,t)}}function uu(e,t,n){var c=n.length;if(e==null)return!c;for(e=Je(e);c--;){var d=n[c],m=t[d],x=e[d];if(x===r&&!(d in e)||!m(x))return!1}return!0}function hu(e,t,n){if(typeof e!="function")throw new mr(_);return qn(function(){e.apply(r,n)},t)}function Dn(e,t,n,c){var d=-1,m=bs,x=!0,O=e.length,C=[],k=t.length;if(!O)return C;n&&(t=nt(t,lr(n))),c?(m=Qo,x=!1):t.length>=o&&(m=Sn,x=!1,t=new Fi(t));e:for(;++d<O;){var V=e[d],J=n==null?V:n(V);if(V=c||V!==0?V:0,x&&J===J){for(var Z=k;Z--;)if(t[Z]===J)continue e;C.push(V)}else m(t,J,c)||C.push(V)}return C}var di=Lu(zr),lu=Lu(fa,!0);function td(e,t){var n=!0;return di(e,function(c,d,m){return n=!!t(c,d,m),n}),n}function Ms(e,t,n){for(var c=-1,d=e.length;++c<d;){var m=e[c],x=t(m);if(x!=null&&(O===r?x===x&&!pr(x):n(x,O)))var O=x,C=m}return C}function rd(e,t,n,c){var d=e.length;for(n=xe(n),n<0&&(n=-n>d?0:d+n),c=c===r||c>d?d:xe(c),c<0&&(c+=d),c=n>c?0:Ah(c);n<c;)e[n++]=t;return e}function fu(e,t){var n=[];return di(e,function(c,d,m){t(c,d,m)&&n.push(c)}),n}function Bt(e,t,n,c,d){var m=-1,x=e.length;for(n||(n=kd),d||(d=[]);++m<x;){var O=e[m];t>0&&n(O)?t>1?Bt(O,t-1,n,c,d):li(d,O):c||(d[d.length]=O)}return d}var la=qu(),pu=qu(!0);function zr(e,t){return e&&la(e,t,zt)}function fa(e,t){return e&&pu(e,t,zt)}function zs(e,t){return hi(t,function(n){return ei(e[n])})}function $i(e,t){t=yi(t,e);for(var n=0,c=t.length;e!=null&&n<c;)e=e[Hr(t[n++])];return n&&n==c?e:r}function du(e,t,n){var c=t(e);return Ie(e)?c:li(c,n(e))}function Yt(e){return e==null?e===r?ct:Le:Di&&Di in Je(e)?qd(e):Yd(e)}function pa(e,t){return e>t}function id(e,t){return e!=null&&He.call(e,t)}function nd(e,t){return e!=null&&t in Je(e)}function sd(e,t,n){return e>=Vt(t,n)&&e<Lt(t,n)}function da(e,t,n){for(var c=n?Qo:bs,d=e[0].length,m=e.length,x=m,O=L(m),C=1/0,k=[];x--;){var V=e[x];x&&t&&(V=nt(V,lr(t))),C=Vt(V.length,C),O[x]=!n&&(t||d>=120&&V.length>=120)?new Fi(x&&V):r}V=e[0];var J=-1,Z=O[0];e:for(;++J<d&&k.length<C;){var ae=V[J],ve=t?t(ae):ae;if(ae=n||ae!==0?ae:0,!(Z?Sn(Z,ve):c(k,ve,n))){for(x=m;--x;){var Oe=O[x];if(!(Oe?Sn(Oe,ve):c(e[x],ve,n)))continue e}Z&&Z.push(ve),k.push(ae)}}return k}function od(e,t,n,c){return zr(e,function(d,m,x){t(c,n(d),m,x)}),c}function Nn(e,t,n){t=yi(t,e),e=th(e,t);var c=e==null?e:e[Hr(Ir(t))];return c==null?r:Mt(c,e,n)}function gu(e){return _t(e)&&Yt(e)==we}function ad(e){return _t(e)&&Yt(e)==$e}function cd(e){return _t(e)&&Yt(e)==N}function Fn(e,t,n,c,d){return e===t?!0:e==null||t==null||!_t(e)&&!_t(t)?e!==e&&t!==t:ud(e,t,n,c,Fn,d)}function ud(e,t,n,c,d,m){var x=Ie(e),O=Ie(t),C=x?Or:Kt(e),k=O?Or:Kt(t);C=C==we?Te:C,k=k==we?Te:k;var V=C==Te,J=k==Te,Z=C==k;if(Z&&_i(e)){if(!_i(t))return!1;x=!0,V=!1}if(Z&&!V)return m||(m=new Cr),x||cn(e)?Wu(e,t,n,c,d,m):$d(e,t,C,n,c,d,m);if(!(n&F)){var ae=V&&He.call(e,"__wrapped__"),ve=J&&He.call(t,"__wrapped__");if(ae||ve){var Oe=ae?e.value():e,_e=ve?t.value():t;return m||(m=new Cr),d(Oe,_e,n,c,m)}}return Z?(m||(m=new Cr),Ld(e,t,n,c,d,m)):!1}function hd(e){return _t(e)&&Kt(e)==Pe}function ga(e,t,n,c){var d=n.length,m=d,x=!c;if(e==null)return!m;for(e=Je(e);d--;){var O=n[d];if(x&&O[2]?O[1]!==e[O[0]]:!(O[0]in e))return!1}for(;++d<m;){O=n[d];var C=O[0],k=e[C],V=O[1];if(x&&O[2]){if(k===r&&!(C in e))return!1}else{var J=new Cr;if(c)var Z=c(k,V,C,e,t,J);if(!(Z===r?Fn(V,k,F|se,c,J):Z))return!1}}return!0}function yu(e){if(!ht(e)||Kd(e))return!1;var t=ei(e)?hp:Fo;return t.test(qi(e))}function ld(e){return _t(e)&&Yt(e)==at}function fd(e){return _t(e)&&Kt(e)==Me}function pd(e){return _t(e)&&io(e.length)&&!!Ke[Yt(e)]}function vu(e){return typeof e=="function"?e:e==null?or:typeof e=="object"?Ie(e)?wu(e[0],e[1]):mu(e):Mh(e)}function ya(e){if(!Ln(e))return yp(e);var t=[];for(var n in Je(e))He.call(e,n)&&n!="constructor"&&t.push(n);return t}function dd(e){if(!ht(e))return Qd(e);var t=Ln(e),n=[];for(var c in e)c=="constructor"&&(t||!He.call(e,c))||n.push(c);return n}function va(e,t){return e<t}function _u(e,t){var n=-1,c=nr(e)?L(e.length):[];return di(e,function(d,m,x){c[++n]=t(d,m,x)}),c}function mu(e){var t=Da(e);return t.length==1&&t[0][2]?Zu(t[0][0],t[0][1]):function(n){return n===e||ga(n,e,t)}}function wu(e,t){return Fa(e)&&Xu(t)?Zu(Hr(e),t):function(n){var c=ka(n,e);return c===r&&c===t?Va(n,e):Fn(t,c,F|se)}}function Us(e,t,n,c,d){e!==t&&la(t,function(m,x){if(d||(d=new Cr),ht(m))gd(e,t,x,n,Us,c,d);else{var O=c?c($a(e,x),m,x+"",e,t,d):r;O===r&&(O=m),ua(e,x,O)}},sr)}function gd(e,t,n,c,d,m,x){var O=$a(e,n),C=$a(t,n),k=x.get(C);if(k){ua(e,n,k);return}var V=m?m(O,C,n+"",e,t,x):r,J=V===r;if(J){var Z=Ie(C),ae=!Z&&_i(C),ve=!Z&&!ae&&cn(C);V=C,Z||ae||ve?Ie(O)?V=O:It(O)?V=ir(O):ae?(J=!1,V=Du(C,!0)):ve?(J=!1,V=Nu(C,!0)):V=[]:Mn(C)||Mi(C)?(V=O,Mi(O)?V=Rh(O):(!ht(O)||ei(O))&&(V=Yu(C))):J=!1}J&&(x.set(C,V),d(V,C,c,m,x),x.delete(C)),ua(e,n,V)}function bu(e,t){var n=e.length;if(n)return t+=t<0?n:0,Zr(t,n)?e[t]:r}function Eu(e,t,n){t.length?t=nt(t,function(m){return Ie(m)?function(x){return $i(x,m.length===1?m[0]:m)}:m}):t=[or];var c=-1;t=nt(t,lr(ge()));var d=_u(e,function(m,x,O){var C=nt(t,function(k){return k(m)});return{criteria:C,index:++c,value:m}});return Hf(d,function(m,x){return Ad(m,x,n)})}function yd(e,t){return Iu(e,t,function(n,c){return Va(e,c)})}function Iu(e,t,n){for(var c=-1,d=t.length,m={};++c<d;){var x=t[c],O=$i(e,x);n(O,x)&&jn(m,yi(x,e),O)}return m}function vd(e){return function(t){return $i(t,e)}}function _a(e,t,n,c){var d=c?Uf:Qi,m=-1,x=t.length,O=e;for(e===t&&(t=ir(t)),n&&(O=nt(e,lr(n)));++m<x;)for(var C=0,k=t[m],V=n?n(k):k;(C=d(O,V,C,c))>-1;)O!==e&&Cs.call(O,C,1),Cs.call(e,C,1);return e}function xu(e,t){for(var n=e?t.length:0,c=n-1;n--;){var d=t[n];if(n==c||d!==m){var m=d;Zr(d)?Cs.call(e,d,1):Ea(e,d)}}return e}function ma(e,t){return e+Fs(nu()*(t-e+1))}function _d(e,t,n,c){for(var d=-1,m=Lt(Ns((t-e)/(n||1)),0),x=L(m);m--;)x[c?m:++d]=e,e+=n;return x}function wa(e,t){var n="";if(!e||t<1||t>H)return n;do t%2&&(n+=e),t=Fs(t/2),t&&(e+=e);while(t);return n}function Ae(e,t){return La(eh(e,t,or),e+"")}function md(e){return au(un(e))}function wd(e,t){var n=un(e);return Ys(n,ji(t,0,n.length))}function jn(e,t,n,c){if(!ht(e))return e;t=yi(t,e);for(var d=-1,m=t.length,x=m-1,O=e;O!=null&&++d<m;){var C=Hr(t[d]),k=n;if(C==="__proto__"||C==="constructor"||C==="prototype")return e;if(d!=x){var V=O[C];k=c?c(V,C,O):r,k===r&&(k=ht(V)?V:Zr(t[d+1])?[]:{})}Cn(O,C,k),O=O[C]}return e}var Su=js?function(e,t){return js.set(e,t),e}:or,bd=Ds?function(e,t){return Ds(e,"toString",{configurable:!0,enumerable:!1,value:Ga(t),writable:!0})}:or;function Ed(e){return Ys(un(e))}function Er(e,t,n){var c=-1,d=e.length;t<0&&(t=-t>d?0:d+t),n=n>d?d:n,n<0&&(n+=d),d=t>n?0:n-t>>>0,t>>>=0;for(var m=L(d);++c<d;)m[c]=e[c+t];return m}function Id(e,t){var n;return di(e,function(c,d,m){return n=t(c,d,m),!n}),!!n}function Hs(e,t,n){var c=0,d=e==null?c:e.length;if(typeof t=="number"&&t===t&&d<=ye){for(;c<d;){var m=c+d>>>1,x=e[m];x!==null&&!pr(x)&&(n?x<=t:x<t)?c=m+1:d=m}return d}return ba(e,t,or,n)}function ba(e,t,n,c){var d=0,m=e==null?0:e.length;if(m===0)return 0;t=n(t);for(var x=t!==t,O=t===null,C=pr(t),k=t===r;d<m;){var V=Fs((d+m)/2),J=n(e[V]),Z=J!==r,ae=J===null,ve=J===J,Oe=pr(J);if(x)var _e=c||ve;else k?_e=ve&&(c||Z):O?_e=ve&&Z&&(c||!ae):C?_e=ve&&Z&&!ae&&(c||!Oe):ae||Oe?_e=!1:_e=c?J<=t:J<t;_e?d=V+1:m=V}return Vt(m,Y)}function Pu(e,t){for(var n=-1,c=e.length,d=0,m=[];++n<c;){var x=e[n],O=t?t(x):x;if(!n||!Dr(O,C)){var C=O;m[d++]=x===0?0:x}}return m}function Ou(e){return typeof e=="number"?e:pr(e)?q:+e}function fr(e){if(typeof e=="string")return e;if(Ie(e))return nt(e,fr)+"";if(pr(e))return su?su.call(e):"";var t=e+"";return t=="0"&&1/e==-M?"-0":t}function gi(e,t,n){var c=-1,d=bs,m=e.length,x=!0,O=[],C=O;if(n)x=!1,d=Qo;else if(m>=o){var k=t?null:Fd(e);if(k)return Is(k);x=!1,d=Sn,C=new Fi}else C=t?[]:O;e:for(;++c<m;){var V=e[c],J=t?t(V):V;if(V=n||V!==0?V:0,x&&J===J){for(var Z=C.length;Z--;)if(C[Z]===J)continue e;t&&C.push(J),O.push(V)}else d(C,J,n)||(C!==O&&C.push(J),O.push(V))}return O}function Ea(e,t){return t=yi(t,e),e=th(e,t),e==null||delete e[Hr(Ir(t))]}function Au(e,t,n,c){return jn(e,t,n($i(e,t)),c)}function Bs(e,t,n,c){for(var d=e.length,m=c?d:-1;(c?m--:++m<d)&&t(e[m],m,e););return n?Er(e,c?0:m,c?m+1:d):Er(e,c?m+1:0,c?d:m)}function Ru(e,t){var n=e;return n instanceof Ce&&(n=n.value()),Yo(t,function(c,d){return d.func.apply(d.thisArg,li([c],d.args))},n)}function Ia(e,t,n){var c=e.length;if(c<2)return c?gi(e[0]):[];for(var d=-1,m=L(c);++d<c;)for(var x=e[d],O=-1;++O<c;)O!=d&&(m[d]=Dn(m[d]||x,e[O],t,n));return gi(Bt(m,1),t,n)}function Tu(e,t,n){for(var c=-1,d=e.length,m=t.length,x={};++c<d;){var O=c<m?t[c]:r;n(x,e[c],O)}return x}function xa(e){return It(e)?e:[]}function Sa(e){return typeof e=="function"?e:or}function yi(e,t){return Ie(e)?e:Fa(e,t)?[e]:sh(ze(e))}var xd=Ae;function vi(e,t,n){var c=e.length;return n=n===r?c:n,!t&&n>=c?e:Er(e,t,n)}var Cu=lp||function(e){return De.clearTimeout(e)};function Du(e,t){if(t)return e.slice();var n=e.length,c=Zc?Zc(n):new e.constructor(n);return e.copy(c),c}function Pa(e){var t=new e.constructor(e.byteLength);return new Rs(t).set(new Rs(e)),t}function Sd(e,t){var n=t?Pa(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Pd(e){var t=new e.constructor(e.source,yr.exec(e));return t.lastIndex=e.lastIndex,t}function Od(e){return Tn?Je(Tn.call(e)):{}}function Nu(e,t){var n=t?Pa(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Fu(e,t){if(e!==t){var n=e!==r,c=e===null,d=e===e,m=pr(e),x=t!==r,O=t===null,C=t===t,k=pr(t);if(!O&&!k&&!m&&e>t||m&&x&&C&&!O&&!k||c&&x&&C||!n&&C||!d)return 1;if(!c&&!m&&!k&&e<t||k&&n&&d&&!c&&!m||O&&n&&d||!x&&d||!C)return-1}return 0}function Ad(e,t,n){for(var c=-1,d=e.criteria,m=t.criteria,x=d.length,O=n.length;++c<x;){var C=Fu(d[c],m[c]);if(C){if(c>=O)return C;var k=n[c];return C*(k=="desc"?-1:1)}}return e.index-t.index}function ju(e,t,n,c){for(var d=-1,m=e.length,x=n.length,O=-1,C=t.length,k=Lt(m-x,0),V=L(C+k),J=!c;++O<C;)V[O]=t[O];for(;++d<x;)(J||d<m)&&(V[n[d]]=e[d]);for(;k--;)V[O++]=e[d++];return V}function $u(e,t,n,c){for(var d=-1,m=e.length,x=-1,O=n.length,C=-1,k=t.length,V=Lt(m-O,0),J=L(V+k),Z=!c;++d<V;)J[d]=e[d];for(var ae=d;++C<k;)J[ae+C]=t[C];for(;++x<O;)(Z||d<m)&&(J[ae+n[x]]=e[d++]);return J}function ir(e,t){var n=-1,c=e.length;for(t||(t=L(c));++n<c;)t[n]=e[n];return t}function Ur(e,t,n,c){var d=!n;n||(n={});for(var m=-1,x=t.length;++m<x;){var O=t[m],C=c?c(n[O],e[O],O,n,e):r;C===r&&(C=e[O]),d?Qr(n,O,C):Cn(n,O,C)}return n}function Rd(e,t){return Ur(e,Na(e),t)}function Td(e,t){return Ur(e,Ju(e),t)}function ks(e,t){return function(n,c){var d=Ie(n)?jf:Xp,m=t?t():{};return d(n,e,ge(c,2),m)}}function sn(e){return Ae(function(t,n){var c=-1,d=n.length,m=d>1?n[d-1]:r,x=d>2?n[2]:r;for(m=e.length>3&&typeof m=="function"?(d--,m):r,x&&Xt(n[0],n[1],x)&&(m=d<3?r:m,d=1),t=Je(t);++c<d;){var O=n[c];O&&e(t,O,c,m)}return t})}function Lu(e,t){return function(n,c){if(n==null)return n;if(!nr(n))return e(n,c);for(var d=n.length,m=t?d:-1,x=Je(n);(t?m--:++m<d)&&c(x[m],m,x)!==!1;);return n}}function qu(e){return function(t,n,c){for(var d=-1,m=Je(t),x=c(t),O=x.length;O--;){var C=x[e?O:++d];if(n(m[C],C,m)===!1)break}return t}}function Cd(e,t,n){var c=t&ce,d=$n(e);function m(){var x=this&&this!==De&&this instanceof m?d:e;return x.apply(c?n:this,arguments)}return m}function Mu(e){return function(t){t=ze(t);var n=Yi(t)?Tr(t):r,c=n?n[0]:t.charAt(0),d=n?vi(n,1).join(""):t.slice(1);return c[e]()+d}}function on(e){return function(t){return Yo(Lh($h(t).replace(In,"")),e,"")}}function $n(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=nn(e.prototype),c=e.apply(n,t);return ht(c)?c:n}}function Dd(e,t,n){var c=$n(e);function d(){for(var m=arguments.length,x=L(m),O=m,C=an(d);O--;)x[O]=arguments[O];var k=m<3&&x[0]!==C&&x[m-1]!==C?[]:fi(x,C);if(m-=k.length,m<n)return ku(e,t,Vs,d.placeholder,r,x,k,r,r,n-m);var V=this&&this!==De&&this instanceof d?c:e;return Mt(V,this,x)}return d}function zu(e){return function(t,n,c){var d=Je(t);if(!nr(t)){var m=ge(n,3);t=zt(t),n=function(O){return m(d[O],O,d)}}var x=e(t,n,c);return x>-1?d[m?t[x]:x]:r}}function Uu(e){return Xr(function(t){var n=t.length,c=n,d=wr.prototype.thru;for(e&&t.reverse();c--;){var m=t[c];if(typeof m!="function")throw new mr(_);if(d&&!x&&Js(m)=="wrapper")var x=new wr([],!0)}for(c=x?c:n;++c<n;){m=t[c];var O=Js(m),C=O=="wrapper"?Ca(m):r;C&&ja(C[0])&&C[1]==(ee|ue|he|j)&&!C[4].length&&C[9]==1?x=x[Js(C[0])].apply(x,C[3]):x=m.length==1&&ja(m)?x[O]():x.thru(m)}return function(){var k=arguments,V=k[0];if(x&&k.length==1&&Ie(V))return x.plant(V).value();for(var J=0,Z=n?t[J].apply(this,k):V;++J<n;)Z=t[J].call(this,Z);return Z}})}function Vs(e,t,n,c,d,m,x,O,C,k){var V=t&ee,J=t&ce,Z=t&pe,ae=t&(ue|ne),ve=t&Se,Oe=Z?r:$n(e);function _e(){for(var Re=arguments.length,Ne=L(Re),dr=Re;dr--;)Ne[dr]=arguments[dr];if(ae)var Zt=an(_e),gr=kf(Ne,Zt);if(c&&(Ne=ju(Ne,c,d,ae)),m&&(Ne=$u(Ne,m,x,ae)),Re-=gr,ae&&Re<k){var xt=fi(Ne,Zt);return ku(e,t,Vs,_e.placeholder,n,Ne,xt,O,C,k-Re)}var Nr=J?n:this,ri=Z?Nr[e]:e;return Re=Ne.length,O?Ne=Xd(Ne,O):ve&&Re>1&&Ne.reverse(),V&&C<Re&&(Ne.length=C),this&&this!==De&&this instanceof _e&&(ri=Oe||$n(ri)),ri.apply(Nr,Ne)}return _e}function Hu(e,t){return function(n,c){return od(n,e,t(c),{})}}function Ks(e,t){return function(n,c){var d;if(n===r&&c===r)return t;if(n!==r&&(d=n),c!==r){if(d===r)return c;typeof n=="string"||typeof c=="string"?(n=fr(n),c=fr(c)):(n=Ou(n),c=Ou(c)),d=e(n,c)}return d}}function Oa(e){return Xr(function(t){return t=nt(t,lr(ge())),Ae(function(n){var c=this;return e(t,function(d){return Mt(d,c,n)})})})}function Gs(e,t){t=t===r?" ":fr(t);var n=t.length;if(n<2)return n?wa(t,e):t;var c=wa(t,Ns(e/Xi(t)));return Yi(t)?vi(Tr(c),0,e).join(""):c.slice(0,e)}function Nd(e,t,n,c){var d=t&ce,m=$n(e);function x(){for(var O=-1,C=arguments.length,k=-1,V=c.length,J=L(V+C),Z=this&&this!==De&&this instanceof x?m:e;++k<V;)J[k]=c[k];for(;C--;)J[k++]=arguments[++O];return Mt(Z,d?n:this,J)}return x}function Bu(e){return function(t,n,c){return c&&typeof c!="number"&&Xt(t,n,c)&&(n=c=r),t=ti(t),n===r?(n=t,t=0):n=ti(n),c=c===r?t<n?1:-1:ti(c),_d(t,n,c,e)}}function Ws(e){return function(t,n){return typeof t=="string"&&typeof n=="string"||(t=xr(t),n=xr(n)),e(t,n)}}function ku(e,t,n,c,d,m,x,O,C,k){var V=t&ue,J=V?x:r,Z=V?r:x,ae=V?m:r,ve=V?r:m;t|=V?he:fe,t&=~(V?fe:he),t&le||(t&=~(ce|pe));var Oe=[e,t,d,ae,J,ve,Z,O,C,k],_e=n.apply(r,Oe);return ja(e)&&rh(_e,Oe),_e.placeholder=c,ih(_e,e,t)}function Aa(e){var t=$t[e];return function(n,c){if(n=xr(n),c=c==null?0:Vt(xe(c),292),c&&iu(n)){var d=(ze(n)+"e").split("e"),m=t(d[0]+"e"+(+d[1]+c));return d=(ze(m)+"e").split("e"),+(d[0]+"e"+(+d[1]-c))}return t(n)}}var Fd=tn&&1/Is(new tn([,-0]))[1]==M?function(e){return new tn(e)}:Qa;function Vu(e){return function(t){var n=Kt(t);return n==Pe?na(t):n==Me?Yf(t):Bf(t,e(t))}}function Yr(e,t,n,c,d,m,x,O){var C=t&pe;if(!C&&typeof e!="function")throw new mr(_);var k=c?c.length:0;if(k||(t&=~(he|fe),c=d=r),x=x===r?x:Lt(xe(x),0),O=O===r?O:xe(O),k-=d?d.length:0,t&fe){var V=c,J=d;c=d=r}var Z=C?r:Ca(e),ae=[e,t,n,c,d,V,J,m,x,O];if(Z&&Jd(ae,Z),e=ae[0],t=ae[1],n=ae[2],c=ae[3],d=ae[4],O=ae[9]=ae[9]===r?C?0:e.length:Lt(ae[9]-k,0),!O&&t&(ue|ne)&&(t&=~(ue|ne)),!t||t==ce)var ve=Cd(e,t,n);else t==ue||t==ne?ve=Dd(e,t,O):(t==he||t==(ce|he))&&!d.length?ve=Nd(e,t,n,c):ve=Vs.apply(r,ae);var Oe=Z?Su:rh;return ih(Oe(ve,ae),e,t)}function Ku(e,t,n,c){return e===r||Dr(e,en[n])&&!He.call(c,n)?t:e}function Gu(e,t,n,c,d,m){return ht(e)&&ht(t)&&(m.set(t,e),Us(e,t,r,Gu,m),m.delete(t)),e}function jd(e){return Mn(e)?r:e}function Wu(e,t,n,c,d,m){var x=n&F,O=e.length,C=t.length;if(O!=C&&!(x&&C>O))return!1;var k=m.get(e),V=m.get(t);if(k&&V)return k==t&&V==e;var J=-1,Z=!0,ae=n&se?new Fi:r;for(m.set(e,t),m.set(t,e);++J<O;){var ve=e[J],Oe=t[J];if(c)var _e=x?c(Oe,ve,J,t,e,m):c(ve,Oe,J,e,t,m);if(_e!==r){if(_e)continue;Z=!1;break}if(ae){if(!Xo(t,function(Re,Ne){if(!Sn(ae,Ne)&&(ve===Re||d(ve,Re,n,c,m)))return ae.push(Ne)})){Z=!1;break}}else if(!(ve===Oe||d(ve,Oe,n,c,m))){Z=!1;break}}return m.delete(e),m.delete(t),Z}function $d(e,t,n,c,d,m,x){switch(n){case Ve:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case $e:return!(e.byteLength!=t.byteLength||!m(new Rs(e),new Rs(t)));case z:case N:case je:return Dr(+e,+t);case A:return e.name==t.name&&e.message==t.message;case at:case Ye:return e==t+"";case Pe:var O=na;case Me:var C=c&F;if(O||(O=Is),e.size!=t.size&&!C)return!1;var k=x.get(e);if(k)return k==t;c|=se,x.set(e,t);var V=Wu(O(e),O(t),c,d,m,x);return x.delete(e),V;case Xe:if(Tn)return Tn.call(e)==Tn.call(t)}return!1}function Ld(e,t,n,c,d,m){var x=n&F,O=Ra(e),C=O.length,k=Ra(t),V=k.length;if(C!=V&&!x)return!1;for(var J=C;J--;){var Z=O[J];if(!(x?Z in t:He.call(t,Z)))return!1}var ae=m.get(e),ve=m.get(t);if(ae&&ve)return ae==t&&ve==e;var Oe=!0;m.set(e,t),m.set(t,e);for(var _e=x;++J<C;){Z=O[J];var Re=e[Z],Ne=t[Z];if(c)var dr=x?c(Ne,Re,Z,t,e,m):c(Re,Ne,Z,e,t,m);if(!(dr===r?Re===Ne||d(Re,Ne,n,c,m):dr)){Oe=!1;break}_e||(_e=Z=="constructor")}if(Oe&&!_e){var Zt=e.constructor,gr=t.constructor;Zt!=gr&&"constructor"in e&&"constructor"in t&&!(typeof Zt=="function"&&Zt instanceof Zt&&typeof gr=="function"&&gr instanceof gr)&&(Oe=!1)}return m.delete(e),m.delete(t),Oe}function Xr(e){return La(eh(e,r,uh),e+"")}function Ra(e){return du(e,zt,Na)}function Ta(e){return du(e,sr,Ju)}var Ca=js?function(e){return js.get(e)}:Qa;function Js(e){for(var t=e.name+"",n=rn[t],c=He.call(rn,t)?n.length:0;c--;){var d=n[c],m=d.func;if(m==null||m==e)return d.name}return t}function an(e){var t=He.call(v,"placeholder")?v:e;return t.placeholder}function ge(){var e=v.iteratee||Wa;return e=e===Wa?vu:e,arguments.length?e(arguments[0],arguments[1]):e}function Qs(e,t){var n=e.__data__;return Vd(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Da(e){for(var t=zt(e),n=t.length;n--;){var c=t[n],d=e[c];t[n]=[c,d,Xu(d)]}return t}function Li(e,t){var n=Wf(e,t);return yu(n)?n:r}function qd(e){var t=He.call(e,Di),n=e[Di];try{e[Di]=r;var c=!0}catch{}var d=Os.call(e);return c&&(t?e[Di]=n:delete e[Di]),d}var Na=oa?function(e){return e==null?[]:(e=Je(e),hi(oa(e),function(t){return tu.call(e,t)}))}:Ya,Ju=oa?function(e){for(var t=[];e;)li(t,Na(e)),e=Ts(e);return t}:Ya,Kt=Yt;(aa&&Kt(new aa(new ArrayBuffer(1)))!=Ve||On&&Kt(new On)!=Pe||ca&&Kt(ca.resolve())!=St||tn&&Kt(new tn)!=Me||An&&Kt(new An)!=Be)&&(Kt=function(e){var t=Yt(e),n=t==Te?e.constructor:r,c=n?qi(n):"";if(c)switch(c){case wp:return Ve;case bp:return Pe;case Ep:return St;case Ip:return Me;case xp:return Be}return t});function Md(e,t,n){for(var c=-1,d=n.length;++c<d;){var m=n[c],x=m.size;switch(m.type){case"drop":e+=x;break;case"dropRight":t-=x;break;case"take":t=Vt(t,e+x);break;case"takeRight":e=Lt(e,t-x);break}}return{start:e,end:t}}function zd(e){var t=e.match(Qe);return t?t[1].split(Tt):[]}function Qu(e,t,n){t=yi(t,e);for(var c=-1,d=t.length,m=!1;++c<d;){var x=Hr(t[c]);if(!(m=e!=null&&n(e,x)))break;e=e[x]}return m||++c!=d?m:(d=e==null?0:e.length,!!d&&io(d)&&Zr(x,d)&&(Ie(e)||Mi(e)))}function Ud(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&He.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Yu(e){return typeof e.constructor=="function"&&!Ln(e)?nn(Ts(e)):{}}function Hd(e,t,n){var c=e.constructor;switch(t){case $e:return Pa(e);case z:case N:return new c(+e);case Ve:return Sd(e,n);case lt:case Ue:case Pt:case jt:case Ut:case Ht:case qt:case Wt:case tr:return Nu(e,n);case Pe:return new c;case je:case Ye:return new c(e);case at:return Pd(e);case Me:return new c;case Xe:return Od(e)}}function Bd(e,t){var n=t.length;if(!n)return e;var c=n-1;return t[c]=(n>1?"& ":"")+t[c],t=t.join(n>2?", ":" "),e.replace(vt,`{
/* [wrapped with `+t+`] */
`)}function kd(e){return Ie(e)||Mi(e)||!!(ru&&e&&e[ru])}function Zr(e,t){var n=typeof e;return t=t??H,!!t&&(n=="number"||n!="symbol"&&$o.test(e))&&e>-1&&e%1==0&&e<t}function Xt(e,t,n){if(!ht(n))return!1;var c=typeof t;return(c=="number"?nr(n)&&Zr(t,n.length):c=="string"&&t in n)?Dr(n[t],e):!1}function Fa(e,t){if(Ie(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||pr(e)?!0:Ot.test(e)||!it.test(e)||t!=null&&e in Je(t)}function Vd(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function ja(e){var t=Js(e),n=v[t];if(typeof n!="function"||!(t in Ce.prototype))return!1;if(e===n)return!0;var c=Ca(n);return!!c&&e===c[0]}function Kd(e){return!!Xc&&Xc in e}var Gd=Ss?ei:Xa;function Ln(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||en;return e===n}function Xu(e){return e===e&&!ht(e)}function Zu(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==r||e in Je(n))}}function Wd(e){var t=to(e,function(c){return n.size===D&&n.clear(),c}),n=t.cache;return t}function Jd(e,t){var n=e[1],c=t[1],d=n|c,m=d<(ce|pe|ee),x=c==ee&&n==ue||c==ee&&n==j&&e[7].length<=t[8]||c==(ee|j)&&t[7].length<=t[8]&&n==ue;if(!(m||x))return e;c&ce&&(e[2]=t[2],d|=n&ce?0:le);var O=t[3];if(O){var C=e[3];e[3]=C?ju(C,O,t[4]):O,e[4]=C?fi(e[3],$):t[4]}return O=t[5],O&&(C=e[5],e[5]=C?$u(C,O,t[6]):O,e[6]=C?fi(e[5],$):t[6]),O=t[7],O&&(e[7]=O),c&ee&&(e[8]=e[8]==null?t[8]:Vt(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=d,e}function Qd(e){var t=[];if(e!=null)for(var n in Je(e))t.push(n);return t}function Yd(e){return Os.call(e)}function eh(e,t,n){return t=Lt(t===r?e.length-1:t,0),function(){for(var c=arguments,d=-1,m=Lt(c.length-t,0),x=L(m);++d<m;)x[d]=c[t+d];d=-1;for(var O=L(t+1);++d<t;)O[d]=c[d];return O[t]=n(x),Mt(e,this,O)}}function th(e,t){return t.length<2?e:$i(e,Er(t,0,-1))}function Xd(e,t){for(var n=e.length,c=Vt(t.length,n),d=ir(e);c--;){var m=t[c];e[c]=Zr(m,n)?d[m]:r}return e}function $a(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var rh=nh(Su),qn=pp||function(e,t){return De.setTimeout(e,t)},La=nh(bd);function ih(e,t,n){var c=t+"";return La(e,Bd(c,Zd(zd(c),n)))}function nh(e){var t=0,n=0;return function(){var c=vp(),d=I-(c-n);if(n=c,d>0){if(++t>=y)return arguments[0]}else t=0;return e.apply(r,arguments)}}function Ys(e,t){var n=-1,c=e.length,d=c-1;for(t=t===r?c:t;++n<t;){var m=ma(n,d),x=e[m];e[m]=e[n],e[n]=x}return e.length=t,e}var sh=Wd(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(At,function(n,c,d,m){t.push(d?m.replace(To,"$1"):c||n)}),t});function Hr(e){if(typeof e=="string"||pr(e))return e;var t=e+"";return t=="0"&&1/e==-M?"-0":t}function qi(e){if(e!=null){try{return Ps.call(e)}catch{}try{return e+""}catch{}}return""}function Zd(e,t){return _r(ot,function(n){var c="_."+n[0];t&n[1]&&!bs(e,c)&&e.push(c)}),e.sort()}function oh(e){if(e instanceof Ce)return e.clone();var t=new wr(e.__wrapped__,e.__chain__);return t.__actions__=ir(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function eg(e,t,n){(n?Xt(e,t,n):t===r)?t=1:t=Lt(xe(t),0);var c=e==null?0:e.length;if(!c||t<1)return[];for(var d=0,m=0,x=L(Ns(c/t));d<c;)x[m++]=Er(e,d,d+=t);return x}function tg(e){for(var t=-1,n=e==null?0:e.length,c=0,d=[];++t<n;){var m=e[t];m&&(d[c++]=m)}return d}function rg(){var e=arguments.length;if(!e)return[];for(var t=L(e-1),n=arguments[0],c=e;c--;)t[c-1]=arguments[c];return li(Ie(n)?ir(n):[n],Bt(t,1))}var ig=Ae(function(e,t){return It(e)?Dn(e,Bt(t,1,It,!0)):[]}),ng=Ae(function(e,t){var n=Ir(t);return It(n)&&(n=r),It(e)?Dn(e,Bt(t,1,It,!0),ge(n,2)):[]}),sg=Ae(function(e,t){var n=Ir(t);return It(n)&&(n=r),It(e)?Dn(e,Bt(t,1,It,!0),r,n):[]});function og(e,t,n){var c=e==null?0:e.length;return c?(t=n||t===r?1:xe(t),Er(e,t<0?0:t,c)):[]}function ag(e,t,n){var c=e==null?0:e.length;return c?(t=n||t===r?1:xe(t),t=c-t,Er(e,0,t<0?0:t)):[]}function cg(e,t){return e&&e.length?Bs(e,ge(t,3),!0,!0):[]}function ug(e,t){return e&&e.length?Bs(e,ge(t,3),!0):[]}function hg(e,t,n,c){var d=e==null?0:e.length;return d?(n&&typeof n!="number"&&Xt(e,t,n)&&(n=0,c=d),rd(e,t,n,c)):[]}function ah(e,t,n){var c=e==null?0:e.length;if(!c)return-1;var d=n==null?0:xe(n);return d<0&&(d=Lt(c+d,0)),Es(e,ge(t,3),d)}function ch(e,t,n){var c=e==null?0:e.length;if(!c)return-1;var d=c-1;return n!==r&&(d=xe(n),d=n<0?Lt(c+d,0):Vt(d,c-1)),Es(e,ge(t,3),d,!0)}function uh(e){var t=e==null?0:e.length;return t?Bt(e,1):[]}function lg(e){var t=e==null?0:e.length;return t?Bt(e,M):[]}function fg(e,t){var n=e==null?0:e.length;return n?(t=t===r?1:xe(t),Bt(e,t)):[]}function pg(e){for(var t=-1,n=e==null?0:e.length,c={};++t<n;){var d=e[t];c[d[0]]=d[1]}return c}function hh(e){return e&&e.length?e[0]:r}function dg(e,t,n){var c=e==null?0:e.length;if(!c)return-1;var d=n==null?0:xe(n);return d<0&&(d=Lt(c+d,0)),Qi(e,t,d)}function gg(e){var t=e==null?0:e.length;return t?Er(e,0,-1):[]}var yg=Ae(function(e){var t=nt(e,xa);return t.length&&t[0]===e[0]?da(t):[]}),vg=Ae(function(e){var t=Ir(e),n=nt(e,xa);return t===Ir(n)?t=r:n.pop(),n.length&&n[0]===e[0]?da(n,ge(t,2)):[]}),_g=Ae(function(e){var t=Ir(e),n=nt(e,xa);return t=typeof t=="function"?t:r,t&&n.pop(),n.length&&n[0]===e[0]?da(n,r,t):[]});function mg(e,t){return e==null?"":gp.call(e,t)}function Ir(e){var t=e==null?0:e.length;return t?e[t-1]:r}function wg(e,t,n){var c=e==null?0:e.length;if(!c)return-1;var d=c;return n!==r&&(d=xe(n),d=d<0?Lt(c+d,0):Vt(d,c-1)),t===t?Zf(e,t,d):Es(e,kc,d,!0)}function bg(e,t){return e&&e.length?bu(e,xe(t)):r}var Eg=Ae(lh);function lh(e,t){return e&&e.length&&t&&t.length?_a(e,t):e}function Ig(e,t,n){return e&&e.length&&t&&t.length?_a(e,t,ge(n,2)):e}function xg(e,t,n){return e&&e.length&&t&&t.length?_a(e,t,r,n):e}var Sg=Xr(function(e,t){var n=e==null?0:e.length,c=ha(e,t);return xu(e,nt(t,function(d){return Zr(d,n)?+d:d}).sort(Fu)),c});function Pg(e,t){var n=[];if(!(e&&e.length))return n;var c=-1,d=[],m=e.length;for(t=ge(t,3);++c<m;){var x=e[c];t(x,c,e)&&(n.push(x),d.push(c))}return xu(e,d),n}function qa(e){return e==null?e:mp.call(e)}function Og(e,t,n){var c=e==null?0:e.length;return c?(n&&typeof n!="number"&&Xt(e,t,n)?(t=0,n=c):(t=t==null?0:xe(t),n=n===r?c:xe(n)),Er(e,t,n)):[]}function Ag(e,t){return Hs(e,t)}function Rg(e,t,n){return ba(e,t,ge(n,2))}function Tg(e,t){var n=e==null?0:e.length;if(n){var c=Hs(e,t);if(c<n&&Dr(e[c],t))return c}return-1}function Cg(e,t){return Hs(e,t,!0)}function Dg(e,t,n){return ba(e,t,ge(n,2),!0)}function Ng(e,t){var n=e==null?0:e.length;if(n){var c=Hs(e,t,!0)-1;if(Dr(e[c],t))return c}return-1}function Fg(e){return e&&e.length?Pu(e):[]}function jg(e,t){return e&&e.length?Pu(e,ge(t,2)):[]}function $g(e){var t=e==null?0:e.length;return t?Er(e,1,t):[]}function Lg(e,t,n){return e&&e.length?(t=n||t===r?1:xe(t),Er(e,0,t<0?0:t)):[]}function qg(e,t,n){var c=e==null?0:e.length;return c?(t=n||t===r?1:xe(t),t=c-t,Er(e,t<0?0:t,c)):[]}function Mg(e,t){return e&&e.length?Bs(e,ge(t,3),!1,!0):[]}function zg(e,t){return e&&e.length?Bs(e,ge(t,3)):[]}var Ug=Ae(function(e){return gi(Bt(e,1,It,!0))}),Hg=Ae(function(e){var t=Ir(e);return It(t)&&(t=r),gi(Bt(e,1,It,!0),ge(t,2))}),Bg=Ae(function(e){var t=Ir(e);return t=typeof t=="function"?t:r,gi(Bt(e,1,It,!0),r,t)});function kg(e){return e&&e.length?gi(e):[]}function Vg(e,t){return e&&e.length?gi(e,ge(t,2)):[]}function Kg(e,t){return t=typeof t=="function"?t:r,e&&e.length?gi(e,r,t):[]}function Ma(e){if(!(e&&e.length))return[];var t=0;return e=hi(e,function(n){if(It(n))return t=Lt(n.length,t),!0}),ra(t,function(n){return nt(e,Zo(n))})}function fh(e,t){if(!(e&&e.length))return[];var n=Ma(e);return t==null?n:nt(n,function(c){return Mt(t,r,c)})}var Gg=Ae(function(e,t){return It(e)?Dn(e,t):[]}),Wg=Ae(function(e){return Ia(hi(e,It))}),Jg=Ae(function(e){var t=Ir(e);return It(t)&&(t=r),Ia(hi(e,It),ge(t,2))}),Qg=Ae(function(e){var t=Ir(e);return t=typeof t=="function"?t:r,Ia(hi(e,It),r,t)}),Yg=Ae(Ma);function Xg(e,t){return Tu(e||[],t||[],Cn)}function Zg(e,t){return Tu(e||[],t||[],jn)}var ey=Ae(function(e){var t=e.length,n=t>1?e[t-1]:r;return n=typeof n=="function"?(e.pop(),n):r,fh(e,n)});function ph(e){var t=v(e);return t.__chain__=!0,t}function ty(e,t){return t(e),e}function Xs(e,t){return t(e)}var ry=Xr(function(e){var t=e.length,n=t?e[0]:0,c=this.__wrapped__,d=function(m){return ha(m,e)};return t>1||this.__actions__.length||!(c instanceof Ce)||!Zr(n)?this.thru(d):(c=c.slice(n,+n+(t?1:0)),c.__actions__.push({func:Xs,args:[d],thisArg:r}),new wr(c,this.__chain__).thru(function(m){return t&&!m.length&&m.push(r),m}))});function iy(){return ph(this)}function ny(){return new wr(this.value(),this.__chain__)}function sy(){this.__values__===r&&(this.__values__=Oh(this.value()));var e=this.__index__>=this.__values__.length,t=e?r:this.__values__[this.__index__++];return{done:e,value:t}}function oy(){return this}function ay(e){for(var t,n=this;n instanceof Ls;){var c=oh(n);c.__index__=0,c.__values__=r,t?d.__wrapped__=c:t=c;var d=c;n=n.__wrapped__}return d.__wrapped__=e,t}function cy(){var e=this.__wrapped__;if(e instanceof Ce){var t=e;return this.__actions__.length&&(t=new Ce(this)),t=t.reverse(),t.__actions__.push({func:Xs,args:[qa],thisArg:r}),new wr(t,this.__chain__)}return this.thru(qa)}function uy(){return Ru(this.__wrapped__,this.__actions__)}var hy=ks(function(e,t,n){He.call(e,n)?++e[n]:Qr(e,n,1)});function ly(e,t,n){var c=Ie(e)?Hc:td;return n&&Xt(e,t,n)&&(t=r),c(e,ge(t,3))}function fy(e,t){var n=Ie(e)?hi:fu;return n(e,ge(t,3))}var py=zu(ah),dy=zu(ch);function gy(e,t){return Bt(Zs(e,t),1)}function yy(e,t){return Bt(Zs(e,t),M)}function vy(e,t,n){return n=n===r?1:xe(n),Bt(Zs(e,t),n)}function dh(e,t){var n=Ie(e)?_r:di;return n(e,ge(t,3))}function gh(e,t){var n=Ie(e)?$f:lu;return n(e,ge(t,3))}var _y=ks(function(e,t,n){He.call(e,n)?e[n].push(t):Qr(e,n,[t])});function my(e,t,n,c){e=nr(e)?e:un(e),n=n&&!c?xe(n):0;var d=e.length;return n<0&&(n=Lt(d+n,0)),no(e)?n<=d&&e.indexOf(t,n)>-1:!!d&&Qi(e,t,n)>-1}var wy=Ae(function(e,t,n){var c=-1,d=typeof t=="function",m=nr(e)?L(e.length):[];return di(e,function(x){m[++c]=d?Mt(t,x,n):Nn(x,t,n)}),m}),by=ks(function(e,t,n){Qr(e,n,t)});function Zs(e,t){var n=Ie(e)?nt:_u;return n(e,ge(t,3))}function Ey(e,t,n,c){return e==null?[]:(Ie(t)||(t=t==null?[]:[t]),n=c?r:n,Ie(n)||(n=n==null?[]:[n]),Eu(e,t,n))}var Iy=ks(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});function xy(e,t,n){var c=Ie(e)?Yo:Kc,d=arguments.length<3;return c(e,ge(t,4),n,d,di)}function Sy(e,t,n){var c=Ie(e)?Lf:Kc,d=arguments.length<3;return c(e,ge(t,4),n,d,lu)}function Py(e,t){var n=Ie(e)?hi:fu;return n(e,ro(ge(t,3)))}function Oy(e){var t=Ie(e)?au:md;return t(e)}function Ay(e,t,n){(n?Xt(e,t,n):t===r)?t=1:t=xe(t);var c=Ie(e)?Qp:wd;return c(e,t)}function Ry(e){var t=Ie(e)?Yp:Ed;return t(e)}function Ty(e){if(e==null)return 0;if(nr(e))return no(e)?Xi(e):e.length;var t=Kt(e);return t==Pe||t==Me?e.size:ya(e).length}function Cy(e,t,n){var c=Ie(e)?Xo:Id;return n&&Xt(e,t,n)&&(t=r),c(e,ge(t,3))}var Dy=Ae(function(e,t){if(e==null)return[];var n=t.length;return n>1&&Xt(e,t[0],t[1])?t=[]:n>2&&Xt(t[0],t[1],t[2])&&(t=[t[0]]),Eu(e,Bt(t,1),[])}),eo=fp||function(){return De.Date.now()};function Ny(e,t){if(typeof t!="function")throw new mr(_);return e=xe(e),function(){if(--e<1)return t.apply(this,arguments)}}function yh(e,t,n){return t=n?r:t,t=e&&t==null?e.length:t,Yr(e,ee,r,r,r,r,t)}function vh(e,t){var n;if(typeof t!="function")throw new mr(_);return e=xe(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=r),n}}var za=Ae(function(e,t,n){var c=ce;if(n.length){var d=fi(n,an(za));c|=he}return Yr(e,c,t,n,d)}),_h=Ae(function(e,t,n){var c=ce|pe;if(n.length){var d=fi(n,an(_h));c|=he}return Yr(t,c,e,n,d)});function mh(e,t,n){t=n?r:t;var c=Yr(e,ue,r,r,r,r,r,t);return c.placeholder=mh.placeholder,c}function wh(e,t,n){t=n?r:t;var c=Yr(e,ne,r,r,r,r,r,t);return c.placeholder=wh.placeholder,c}function bh(e,t,n){var c,d,m,x,O,C,k=0,V=!1,J=!1,Z=!0;if(typeof e!="function")throw new mr(_);t=xr(t)||0,ht(n)&&(V=!!n.leading,J="maxWait"in n,m=J?Lt(xr(n.maxWait)||0,t):m,Z="trailing"in n?!!n.trailing:Z);function ae(xt){var Nr=c,ri=d;return c=d=r,k=xt,x=e.apply(ri,Nr),x}function ve(xt){return k=xt,O=qn(Re,t),V?ae(xt):x}function Oe(xt){var Nr=xt-C,ri=xt-k,zh=t-Nr;return J?Vt(zh,m-ri):zh}function _e(xt){var Nr=xt-C,ri=xt-k;return C===r||Nr>=t||Nr<0||J&&ri>=m}function Re(){var xt=eo();if(_e(xt))return Ne(xt);O=qn(Re,Oe(xt))}function Ne(xt){return O=r,Z&&c?ae(xt):(c=d=r,x)}function dr(){O!==r&&Cu(O),k=0,c=C=d=O=r}function Zt(){return O===r?x:Ne(eo())}function gr(){var xt=eo(),Nr=_e(xt);if(c=arguments,d=this,C=xt,Nr){if(O===r)return ve(C);if(J)return Cu(O),O=qn(Re,t),ae(C)}return O===r&&(O=qn(Re,t)),x}return gr.cancel=dr,gr.flush=Zt,gr}var Fy=Ae(function(e,t){return hu(e,1,t)}),jy=Ae(function(e,t,n){return hu(e,xr(t)||0,n)});function $y(e){return Yr(e,Se)}function to(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new mr(_);var n=function(){var c=arguments,d=t?t.apply(this,c):c[0],m=n.cache;if(m.has(d))return m.get(d);var x=e.apply(this,c);return n.cache=m.set(d,x)||m,x};return n.cache=new(to.Cache||Jr),n}to.Cache=Jr;function ro(e){if(typeof e!="function")throw new mr(_);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function Ly(e){return vh(2,e)}var qy=xd(function(e,t){t=t.length==1&&Ie(t[0])?nt(t[0],lr(ge())):nt(Bt(t,1),lr(ge()));var n=t.length;return Ae(function(c){for(var d=-1,m=Vt(c.length,n);++d<m;)c[d]=t[d].call(this,c[d]);return Mt(e,this,c)})}),Ua=Ae(function(e,t){var n=fi(t,an(Ua));return Yr(e,he,r,t,n)}),Eh=Ae(function(e,t){var n=fi(t,an(Eh));return Yr(e,fe,r,t,n)}),My=Xr(function(e,t){return Yr(e,j,r,r,r,t)});function zy(e,t){if(typeof e!="function")throw new mr(_);return t=t===r?t:xe(t),Ae(e,t)}function Uy(e,t){if(typeof e!="function")throw new mr(_);return t=t==null?0:Lt(xe(t),0),Ae(function(n){var c=n[t],d=vi(n,0,t);return c&&li(d,c),Mt(e,this,d)})}function Hy(e,t,n){var c=!0,d=!0;if(typeof e!="function")throw new mr(_);return ht(n)&&(c="leading"in n?!!n.leading:c,d="trailing"in n?!!n.trailing:d),bh(e,t,{leading:c,maxWait:t,trailing:d})}function By(e){return yh(e,1)}function ky(e,t){return Ua(Sa(t),e)}function Vy(){if(!arguments.length)return[];var e=arguments[0];return Ie(e)?e:[e]}function Ky(e){return br(e,Q)}function Gy(e,t){return t=typeof t=="function"?t:r,br(e,Q,t)}function Wy(e){return br(e,K|Q)}function Jy(e,t){return t=typeof t=="function"?t:r,br(e,K|Q,t)}function Qy(e,t){return t==null||uu(e,t,zt(t))}function Dr(e,t){return e===t||e!==e&&t!==t}var Yy=Ws(pa),Xy=Ws(function(e,t){return e>=t}),Mi=gu(function(){return arguments}())?gu:function(e){return _t(e)&&He.call(e,"callee")&&!tu.call(e,"callee")},Ie=L.isArray,Zy=Qt?lr(Qt):ad;function nr(e){return e!=null&&io(e.length)&&!ei(e)}function It(e){return _t(e)&&nr(e)}function ev(e){return e===!0||e===!1||_t(e)&&Yt(e)==z}var _i=dp||Xa,tv=Rr?lr(Rr):cd;function rv(e){return _t(e)&&e.nodeType===1&&!Mn(e)}function iv(e){if(e==null)return!0;if(nr(e)&&(Ie(e)||typeof e=="string"||typeof e.splice=="function"||_i(e)||cn(e)||Mi(e)))return!e.length;var t=Kt(e);if(t==Pe||t==Me)return!e.size;if(Ln(e))return!ya(e).length;for(var n in e)if(He.call(e,n))return!1;return!0}function nv(e,t){return Fn(e,t)}function sv(e,t,n){n=typeof n=="function"?n:r;var c=n?n(e,t):r;return c===r?Fn(e,t,r,n):!!c}function Ha(e){if(!_t(e))return!1;var t=Yt(e);return t==A||t==u||typeof e.message=="string"&&typeof e.name=="string"&&!Mn(e)}function ov(e){return typeof e=="number"&&iu(e)}function ei(e){if(!ht(e))return!1;var t=Yt(e);return t==oe||t==me||t==U||t==wt}function Ih(e){return typeof e=="number"&&e==xe(e)}function io(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=H}function ht(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function _t(e){return e!=null&&typeof e=="object"}var xh=vr?lr(vr):hd;function av(e,t){return e===t||ga(e,t,Da(t))}function cv(e,t,n){return n=typeof n=="function"?n:r,ga(e,t,Da(t),n)}function uv(e){return Sh(e)&&e!=+e}function hv(e){if(Gd(e))throw new be(p);return yu(e)}function lv(e){return e===null}function fv(e){return e==null}function Sh(e){return typeof e=="number"||_t(e)&&Yt(e)==je}function Mn(e){if(!_t(e)||Yt(e)!=Te)return!1;var t=Ts(e);if(t===null)return!0;var n=He.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Ps.call(n)==cp}var Ba=Mr?lr(Mr):ld;function pv(e){return Ih(e)&&e>=-H&&e<=H}var Ph=xn?lr(xn):fd;function no(e){return typeof e=="string"||!Ie(e)&&_t(e)&&Yt(e)==Ye}function pr(e){return typeof e=="symbol"||_t(e)&&Yt(e)==Xe}var cn=Ci?lr(Ci):pd;function dv(e){return e===r}function gv(e){return _t(e)&&Kt(e)==Be}function yv(e){return _t(e)&&Yt(e)==Ze}var vv=Ws(va),_v=Ws(function(e,t){return e<=t});function Oh(e){if(!e)return[];if(nr(e))return no(e)?Tr(e):ir(e);if(Pn&&e[Pn])return Qf(e[Pn]());var t=Kt(e),n=t==Pe?na:t==Me?Is:un;return n(e)}function ti(e){if(!e)return e===0?e:0;if(e=xr(e),e===M||e===-M){var t=e<0?-1:1;return t*E}return e===e?e:0}function xe(e){var t=ti(e),n=t%1;return t===t?n?t-n:t:0}function Ah(e){return e?ji(xe(e),0,W):0}function xr(e){if(typeof e=="number")return e;if(pr(e))return q;if(ht(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ht(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Gc(e);var n=No.test(e);return n||jo.test(e)?Ee(e.slice(2),n?2:8):Do.test(e)?q:+e}function Rh(e){return Ur(e,sr(e))}function mv(e){return e?ji(xe(e),-H,H):e===0?e:0}function ze(e){return e==null?"":fr(e)}var wv=sn(function(e,t){if(Ln(t)||nr(t)){Ur(t,zt(t),e);return}for(var n in t)He.call(t,n)&&Cn(e,n,t[n])}),Th=sn(function(e,t){Ur(t,sr(t),e)}),so=sn(function(e,t,n,c){Ur(t,sr(t),e,c)}),bv=sn(function(e,t,n,c){Ur(t,zt(t),e,c)}),Ev=Xr(ha);function Iv(e,t){var n=nn(e);return t==null?n:cu(n,t)}var xv=Ae(function(e,t){e=Je(e);var n=-1,c=t.length,d=c>2?t[2]:r;for(d&&Xt(t[0],t[1],d)&&(c=1);++n<c;)for(var m=t[n],x=sr(m),O=-1,C=x.length;++O<C;){var k=x[O],V=e[k];(V===r||Dr(V,en[k])&&!He.call(e,k))&&(e[k]=m[k])}return e}),Sv=Ae(function(e){return e.push(r,Gu),Mt(Ch,r,e)});function Pv(e,t){return Bc(e,ge(t,3),zr)}function Ov(e,t){return Bc(e,ge(t,3),fa)}function Av(e,t){return e==null?e:la(e,ge(t,3),sr)}function Rv(e,t){return e==null?e:pu(e,ge(t,3),sr)}function Tv(e,t){return e&&zr(e,ge(t,3))}function Cv(e,t){return e&&fa(e,ge(t,3))}function Dv(e){return e==null?[]:zs(e,zt(e))}function Nv(e){return e==null?[]:zs(e,sr(e))}function ka(e,t,n){var c=e==null?r:$i(e,t);return c===r?n:c}function Fv(e,t){return e!=null&&Qu(e,t,id)}function Va(e,t){return e!=null&&Qu(e,t,nd)}var jv=Hu(function(e,t,n){t!=null&&typeof t.toString!="function"&&(t=Os.call(t)),e[t]=n},Ga(or)),$v=Hu(function(e,t,n){t!=null&&typeof t.toString!="function"&&(t=Os.call(t)),He.call(e,t)?e[t].push(n):e[t]=[n]},ge),Lv=Ae(Nn);function zt(e){return nr(e)?ou(e):ya(e)}function sr(e){return nr(e)?ou(e,!0):dd(e)}function qv(e,t){var n={};return t=ge(t,3),zr(e,function(c,d,m){Qr(n,t(c,d,m),c)}),n}function Mv(e,t){var n={};return t=ge(t,3),zr(e,function(c,d,m){Qr(n,d,t(c,d,m))}),n}var zv=sn(function(e,t,n){Us(e,t,n)}),Ch=sn(function(e,t,n,c){Us(e,t,n,c)}),Uv=Xr(function(e,t){var n={};if(e==null)return n;var c=!1;t=nt(t,function(m){return m=yi(m,e),c||(c=m.length>1),m}),Ur(e,Ta(e),n),c&&(n=br(n,K|X|Q,jd));for(var d=t.length;d--;)Ea(n,t[d]);return n});function Hv(e,t){return Dh(e,ro(ge(t)))}var Bv=Xr(function(e,t){return e==null?{}:yd(e,t)});function Dh(e,t){if(e==null)return{};var n=nt(Ta(e),function(c){return[c]});return t=ge(t),Iu(e,n,function(c,d){return t(c,d[0])})}function kv(e,t,n){t=yi(t,e);var c=-1,d=t.length;for(d||(d=1,e=r);++c<d;){var m=e==null?r:e[Hr(t[c])];m===r&&(c=d,m=n),e=ei(m)?m.call(e):m}return e}function Vv(e,t,n){return e==null?e:jn(e,t,n)}function Kv(e,t,n,c){return c=typeof c=="function"?c:r,e==null?e:jn(e,t,n,c)}var Nh=Vu(zt),Fh=Vu(sr);function Gv(e,t,n){var c=Ie(e),d=c||_i(e)||cn(e);if(t=ge(t,4),n==null){var m=e&&e.constructor;d?n=c?new m:[]:ht(e)?n=ei(m)?nn(Ts(e)):{}:n={}}return(d?_r:zr)(e,function(x,O,C){return t(n,x,O,C)}),n}function Wv(e,t){return e==null?!0:Ea(e,t)}function Jv(e,t,n){return e==null?e:Au(e,t,Sa(n))}function Qv(e,t,n,c){return c=typeof c=="function"?c:r,e==null?e:Au(e,t,Sa(n),c)}function un(e){return e==null?[]:ia(e,zt(e))}function Yv(e){return e==null?[]:ia(e,sr(e))}function Xv(e,t,n){return n===r&&(n=t,t=r),n!==r&&(n=xr(n),n=n===n?n:0),t!==r&&(t=xr(t),t=t===t?t:0),ji(xr(e),t,n)}function Zv(e,t,n){return t=ti(t),n===r?(n=t,t=0):n=ti(n),e=xr(e),sd(e,t,n)}function e0(e,t,n){if(n&&typeof n!="boolean"&&Xt(e,t,n)&&(t=n=r),n===r&&(typeof t=="boolean"?(n=t,t=r):typeof e=="boolean"&&(n=e,e=r)),e===r&&t===r?(e=0,t=1):(e=ti(e),t===r?(t=e,e=0):t=ti(t)),e>t){var c=e;e=t,t=c}if(n||e%1||t%1){var d=nu();return Vt(e+d*(t-e+Ge("1e-"+((d+"").length-1))),t)}return ma(e,t)}var t0=on(function(e,t,n){return t=t.toLowerCase(),e+(n?jh(t):t)});function jh(e){return Ka(ze(e).toLowerCase())}function $h(e){return e=ze(e),e&&e.replace(Kr,Vf).replace(Wo,"")}function r0(e,t,n){e=ze(e),t=fr(t);var c=e.length;n=n===r?c:ji(xe(n),0,c);var d=n;return n-=t.length,n>=0&&e.slice(n,d)==t}function i0(e){return e=ze(e),e&&rt.test(e)?e.replace(Pi,Kf):e}function n0(e){return e=ze(e),e&&Rt.test(e)?e.replace(gt,"\\$&"):e}var s0=on(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),o0=on(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),a0=Mu("toLowerCase");function c0(e,t,n){e=ze(e),t=xe(t);var c=t?Xi(e):0;if(!t||c>=t)return e;var d=(t-c)/2;return Gs(Fs(d),n)+e+Gs(Ns(d),n)}function u0(e,t,n){e=ze(e),t=xe(t);var c=t?Xi(e):0;return t&&c<t?e+Gs(t-c,n):e}function h0(e,t,n){e=ze(e),t=xe(t);var c=t?Xi(e):0;return t&&c<t?Gs(t-c,n)+e:e}function l0(e,t,n){return n||t==null?t=0:t&&(t=+t),_p(ze(e).replace(yt,""),t||0)}function f0(e,t,n){return(n?Xt(e,t,n):t===r)?t=1:t=xe(t),wa(ze(e),t)}function p0(){var e=arguments,t=ze(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var d0=on(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});function g0(e,t,n){return n&&typeof n!="number"&&Xt(e,t,n)&&(t=n=r),n=n===r?W:n>>>0,n?(e=ze(e),e&&(typeof t=="string"||t!=null&&!Ba(t))&&(t=fr(t),!t&&Yi(e))?vi(Tr(e),0,n):e.split(t,n)):[]}var y0=on(function(e,t,n){return e+(n?" ":"")+Ka(t)});function v0(e,t,n){return e=ze(e),n=n==null?0:ji(xe(n),0,e.length),t=fr(t),e.slice(n,n+t.length)==t}function _0(e,t,n){var c=v.templateSettings;n&&Xt(e,t,n)&&(t=r),e=ze(e),t=so({},t,c,Ku);var d=so({},t.imports,c.imports,Ku),m=zt(d),x=ia(d,m),O,C,k=0,V=t.interpolate||Bi,J="__p += '",Z=sa((t.escape||Bi).source+"|"+V.source+"|"+(V===ut?Co:Bi).source+"|"+(t.evaluate||Bi).source+"|$","g"),ae="//# sourceURL="+(He.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Jo+"]")+`
`;e.replace(Z,function(_e,Re,Ne,dr,Zt,gr){return Ne||(Ne=dr),J+=e.slice(k,gr).replace(Lo,Gf),Re&&(O=!0,J+=`' +
__e(`+Re+`) +
'`),Zt&&(C=!0,J+=`';
`+Zt+`;
__p += '`),Ne&&(J+=`' +
((__t = (`+Ne+`)) == null ? '' : __t) +
'`),k=gr+_e.length,_e}),J+=`';
`;var ve=He.call(t,"variable")&&t.variable;if(!ve)J=`with (obj) {
`+J+`
}
`;else if(Ro.test(ve))throw new be(b);J=(C?J.replace(Lr,""):J).replace(Jt,"$1").replace(Vr,"$1;"),J="function("+(ve||"obj")+`) {
`+(ve?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(O?", __e = _.escape":"")+(C?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+J+`return __p
}`;var Oe=qh(function(){return qe(m,ae+"return "+J).apply(r,x)});if(Oe.source=J,Ha(Oe))throw Oe;return Oe}function m0(e){return ze(e).toLowerCase()}function w0(e){return ze(e).toUpperCase()}function b0(e,t,n){if(e=ze(e),e&&(n||t===r))return Gc(e);if(!e||!(t=fr(t)))return e;var c=Tr(e),d=Tr(t),m=Wc(c,d),x=Jc(c,d)+1;return vi(c,m,x).join("")}function E0(e,t,n){if(e=ze(e),e&&(n||t===r))return e.slice(0,Yc(e)+1);if(!e||!(t=fr(t)))return e;var c=Tr(e),d=Jc(c,Tr(t))+1;return vi(c,0,d).join("")}function I0(e,t,n){if(e=ze(e),e&&(n||t===r))return e.replace(yt,"");if(!e||!(t=fr(t)))return e;var c=Tr(e),d=Wc(c,Tr(t));return vi(c,d).join("")}function x0(e,t){var n=f,c=g;if(ht(t)){var d="separator"in t?t.separator:d;n="length"in t?xe(t.length):n,c="omission"in t?fr(t.omission):c}e=ze(e);var m=e.length;if(Yi(e)){var x=Tr(e);m=x.length}if(n>=m)return e;var O=n-Xi(c);if(O<1)return c;var C=x?vi(x,0,O).join(""):e.slice(0,O);if(d===r)return C+c;if(x&&(O+=C.length-O),Ba(d)){if(e.slice(O).search(d)){var k,V=C;for(d.global||(d=sa(d.source,ze(yr.exec(d))+"g")),d.lastIndex=0;k=d.exec(V);)var J=k.index;C=C.slice(0,J===r?O:J)}}else if(e.indexOf(fr(d),O)!=O){var Z=C.lastIndexOf(d);Z>-1&&(C=C.slice(0,Z))}return C+c}function S0(e){return e=ze(e),e&&ft.test(e)?e.replace(ci,ep):e}var P0=on(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),Ka=Mu("toUpperCase");function Lh(e,t,n){return e=ze(e),t=n?r:t,t===r?Jf(e)?ip(e):zf(e):e.match(t)||[]}var qh=Ae(function(e,t){try{return Mt(e,r,t)}catch(n){return Ha(n)?n:new be(n)}}),O0=Xr(function(e,t){return _r(t,function(n){n=Hr(n),Qr(e,n,za(e[n],e))}),e});function A0(e){var t=e==null?0:e.length,n=ge();return e=t?nt(e,function(c){if(typeof c[1]!="function")throw new mr(_);return[n(c[0]),c[1]]}):[],Ae(function(c){for(var d=-1;++d<t;){var m=e[d];if(Mt(m[0],this,c))return Mt(m[1],this,c)}})}function R0(e){return ed(br(e,K))}function Ga(e){return function(){return e}}function T0(e,t){return e==null||e!==e?t:e}var C0=Uu(),D0=Uu(!0);function or(e){return e}function Wa(e){return vu(typeof e=="function"?e:br(e,K))}function N0(e){return mu(br(e,K))}function F0(e,t){return wu(e,br(t,K))}var j0=Ae(function(e,t){return function(n){return Nn(n,e,t)}}),$0=Ae(function(e,t){return function(n){return Nn(e,n,t)}});function Ja(e,t,n){var c=zt(t),d=zs(t,c);n==null&&!(ht(t)&&(d.length||!c.length))&&(n=t,t=e,e=this,d=zs(t,zt(t)));var m=!(ht(n)&&"chain"in n)||!!n.chain,x=ei(e);return _r(d,function(O){var C=t[O];e[O]=C,x&&(e.prototype[O]=function(){var k=this.__chain__;if(m||k){var V=e(this.__wrapped__),J=V.__actions__=ir(this.__actions__);return J.push({func:C,args:arguments,thisArg:e}),V.__chain__=k,V}return C.apply(e,li([this.value()],arguments))})}),e}function L0(){return De._===this&&(De._=up),this}function Qa(){}function q0(e){return e=xe(e),Ae(function(t){return bu(t,e)})}var M0=Oa(nt),z0=Oa(Hc),U0=Oa(Xo);function Mh(e){return Fa(e)?Zo(Hr(e)):vd(e)}function H0(e){return function(t){return e==null?r:$i(e,t)}}var B0=Bu(),k0=Bu(!0);function Ya(){return[]}function Xa(){return!1}function V0(){return{}}function K0(){return""}function G0(){return!0}function W0(e,t){if(e=xe(e),e<1||e>H)return[];var n=W,c=Vt(e,W);t=ge(t),e-=W;for(var d=ra(c,t);++n<e;)t(n);return d}function J0(e){return Ie(e)?nt(e,Hr):pr(e)?[e]:ir(sh(ze(e)))}function Q0(e){var t=++ap;return ze(e)+t}var Y0=Ks(function(e,t){return e+t},0),X0=Aa("ceil"),Z0=Ks(function(e,t){return e/t},1),e_=Aa("floor");function t_(e){return e&&e.length?Ms(e,or,pa):r}function r_(e,t){return e&&e.length?Ms(e,ge(t,2),pa):r}function i_(e){return Vc(e,or)}function n_(e,t){return Vc(e,ge(t,2))}function s_(e){return e&&e.length?Ms(e,or,va):r}function o_(e,t){return e&&e.length?Ms(e,ge(t,2),va):r}var a_=Ks(function(e,t){return e*t},1),c_=Aa("round"),u_=Ks(function(e,t){return e-t},0);function h_(e){return e&&e.length?ta(e,or):0}function l_(e,t){return e&&e.length?ta(e,ge(t,2)):0}return v.after=Ny,v.ary=yh,v.assign=wv,v.assignIn=Th,v.assignInWith=so,v.assignWith=bv,v.at=Ev,v.before=vh,v.bind=za,v.bindAll=O0,v.bindKey=_h,v.castArray=Vy,v.chain=ph,v.chunk=eg,v.compact=tg,v.concat=rg,v.cond=A0,v.conforms=R0,v.constant=Ga,v.countBy=hy,v.create=Iv,v.curry=mh,v.curryRight=wh,v.debounce=bh,v.defaults=xv,v.defaultsDeep=Sv,v.defer=Fy,v.delay=jy,v.difference=ig,v.differenceBy=ng,v.differenceWith=sg,v.drop=og,v.dropRight=ag,v.dropRightWhile=cg,v.dropWhile=ug,v.fill=hg,v.filter=fy,v.flatMap=gy,v.flatMapDeep=yy,v.flatMapDepth=vy,v.flatten=uh,v.flattenDeep=lg,v.flattenDepth=fg,v.flip=$y,v.flow=C0,v.flowRight=D0,v.fromPairs=pg,v.functions=Dv,v.functionsIn=Nv,v.groupBy=_y,v.initial=gg,v.intersection=yg,v.intersectionBy=vg,v.intersectionWith=_g,v.invert=jv,v.invertBy=$v,v.invokeMap=wy,v.iteratee=Wa,v.keyBy=by,v.keys=zt,v.keysIn=sr,v.map=Zs,v.mapKeys=qv,v.mapValues=Mv,v.matches=N0,v.matchesProperty=F0,v.memoize=to,v.merge=zv,v.mergeWith=Ch,v.method=j0,v.methodOf=$0,v.mixin=Ja,v.negate=ro,v.nthArg=q0,v.omit=Uv,v.omitBy=Hv,v.once=Ly,v.orderBy=Ey,v.over=M0,v.overArgs=qy,v.overEvery=z0,v.overSome=U0,v.partial=Ua,v.partialRight=Eh,v.partition=Iy,v.pick=Bv,v.pickBy=Dh,v.property=Mh,v.propertyOf=H0,v.pull=Eg,v.pullAll=lh,v.pullAllBy=Ig,v.pullAllWith=xg,v.pullAt=Sg,v.range=B0,v.rangeRight=k0,v.rearg=My,v.reject=Py,v.remove=Pg,v.rest=zy,v.reverse=qa,v.sampleSize=Ay,v.set=Vv,v.setWith=Kv,v.shuffle=Ry,v.slice=Og,v.sortBy=Dy,v.sortedUniq=Fg,v.sortedUniqBy=jg,v.split=g0,v.spread=Uy,v.tail=$g,v.take=Lg,v.takeRight=qg,v.takeRightWhile=Mg,v.takeWhile=zg,v.tap=ty,v.throttle=Hy,v.thru=Xs,v.toArray=Oh,v.toPairs=Nh,v.toPairsIn=Fh,v.toPath=J0,v.toPlainObject=Rh,v.transform=Gv,v.unary=By,v.union=Ug,v.unionBy=Hg,v.unionWith=Bg,v.uniq=kg,v.uniqBy=Vg,v.uniqWith=Kg,v.unset=Wv,v.unzip=Ma,v.unzipWith=fh,v.update=Jv,v.updateWith=Qv,v.values=un,v.valuesIn=Yv,v.without=Gg,v.words=Lh,v.wrap=ky,v.xor=Wg,v.xorBy=Jg,v.xorWith=Qg,v.zip=Yg,v.zipObject=Xg,v.zipObjectDeep=Zg,v.zipWith=ey,v.entries=Nh,v.entriesIn=Fh,v.extend=Th,v.extendWith=so,Ja(v,v),v.add=Y0,v.attempt=qh,v.camelCase=t0,v.capitalize=jh,v.ceil=X0,v.clamp=Xv,v.clone=Ky,v.cloneDeep=Wy,v.cloneDeepWith=Jy,v.cloneWith=Gy,v.conformsTo=Qy,v.deburr=$h,v.defaultTo=T0,v.divide=Z0,v.endsWith=r0,v.eq=Dr,v.escape=i0,v.escapeRegExp=n0,v.every=ly,v.find=py,v.findIndex=ah,v.findKey=Pv,v.findLast=dy,v.findLastIndex=ch,v.findLastKey=Ov,v.floor=e_,v.forEach=dh,v.forEachRight=gh,v.forIn=Av,v.forInRight=Rv,v.forOwn=Tv,v.forOwnRight=Cv,v.get=ka,v.gt=Yy,v.gte=Xy,v.has=Fv,v.hasIn=Va,v.head=hh,v.identity=or,v.includes=my,v.indexOf=dg,v.inRange=Zv,v.invoke=Lv,v.isArguments=Mi,v.isArray=Ie,v.isArrayBuffer=Zy,v.isArrayLike=nr,v.isArrayLikeObject=It,v.isBoolean=ev,v.isBuffer=_i,v.isDate=tv,v.isElement=rv,v.isEmpty=iv,v.isEqual=nv,v.isEqualWith=sv,v.isError=Ha,v.isFinite=ov,v.isFunction=ei,v.isInteger=Ih,v.isLength=io,v.isMap=xh,v.isMatch=av,v.isMatchWith=cv,v.isNaN=uv,v.isNative=hv,v.isNil=fv,v.isNull=lv,v.isNumber=Sh,v.isObject=ht,v.isObjectLike=_t,v.isPlainObject=Mn,v.isRegExp=Ba,v.isSafeInteger=pv,v.isSet=Ph,v.isString=no,v.isSymbol=pr,v.isTypedArray=cn,v.isUndefined=dv,v.isWeakMap=gv,v.isWeakSet=yv,v.join=mg,v.kebabCase=s0,v.last=Ir,v.lastIndexOf=wg,v.lowerCase=o0,v.lowerFirst=a0,v.lt=vv,v.lte=_v,v.max=t_,v.maxBy=r_,v.mean=i_,v.meanBy=n_,v.min=s_,v.minBy=o_,v.stubArray=Ya,v.stubFalse=Xa,v.stubObject=V0,v.stubString=K0,v.stubTrue=G0,v.multiply=a_,v.nth=bg,v.noConflict=L0,v.noop=Qa,v.now=eo,v.pad=c0,v.padEnd=u0,v.padStart=h0,v.parseInt=l0,v.random=e0,v.reduce=xy,v.reduceRight=Sy,v.repeat=f0,v.replace=p0,v.result=kv,v.round=c_,v.runInContext=T,v.sample=Oy,v.size=Ty,v.snakeCase=d0,v.some=Cy,v.sortedIndex=Ag,v.sortedIndexBy=Rg,v.sortedIndexOf=Tg,v.sortedLastIndex=Cg,v.sortedLastIndexBy=Dg,v.sortedLastIndexOf=Ng,v.startCase=y0,v.startsWith=v0,v.subtract=u_,v.sum=h_,v.sumBy=l_,v.template=_0,v.times=W0,v.toFinite=ti,v.toInteger=xe,v.toLength=Ah,v.toLower=m0,v.toNumber=xr,v.toSafeInteger=mv,v.toString=ze,v.toUpper=w0,v.trim=b0,v.trimEnd=E0,v.trimStart=I0,v.truncate=x0,v.unescape=S0,v.uniqueId=Q0,v.upperCase=P0,v.upperFirst=Ka,v.each=dh,v.eachRight=gh,v.first=hh,Ja(v,function(){var e={};return zr(v,function(t,n){He.call(v.prototype,n)||(e[n]=t)}),e}(),{chain:!1}),v.VERSION=s,_r(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){v[e].placeholder=v}),_r(["drop","take"],function(e,t){Ce.prototype[e]=function(n){n=n===r?1:Lt(xe(n),0);var c=this.__filtered__&&!t?new Ce(this):this.clone();return c.__filtered__?c.__takeCount__=Vt(n,c.__takeCount__):c.__views__.push({size:Vt(n,W),type:e+(c.__dir__<0?"Right":"")}),c},Ce.prototype[e+"Right"]=function(n){return this.reverse()[e](n).reverse()}}),_r(["filter","map","takeWhile"],function(e,t){var n=t+1,c=n==l||n==P;Ce.prototype[e]=function(d){var m=this.clone();return m.__iteratees__.push({iteratee:ge(d,3),type:n}),m.__filtered__=m.__filtered__||c,m}}),_r(["head","last"],function(e,t){var n="take"+(t?"Right":"");Ce.prototype[e]=function(){return this[n](1).value()[0]}}),_r(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");Ce.prototype[e]=function(){return this.__filtered__?new Ce(this):this[n](1)}}),Ce.prototype.compact=function(){return this.filter(or)},Ce.prototype.find=function(e){return this.filter(e).head()},Ce.prototype.findLast=function(e){return this.reverse().find(e)},Ce.prototype.invokeMap=Ae(function(e,t){return typeof e=="function"?new Ce(this):this.map(function(n){return Nn(n,e,t)})}),Ce.prototype.reject=function(e){return this.filter(ro(ge(e)))},Ce.prototype.slice=function(e,t){e=xe(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Ce(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==r&&(t=xe(t),n=t<0?n.dropRight(-t):n.take(t-e)),n)},Ce.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ce.prototype.toArray=function(){return this.take(W)},zr(Ce.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),c=/^(?:head|last)$/.test(t),d=v[c?"take"+(t=="last"?"Right":""):t],m=c||/^find/.test(t);d&&(v.prototype[t]=function(){var x=this.__wrapped__,O=c?[1]:arguments,C=x instanceof Ce,k=O[0],V=C||Ie(x),J=function(Re){var Ne=d.apply(v,li([Re],O));return c&&Z?Ne[0]:Ne};V&&n&&typeof k=="function"&&k.length!=1&&(C=V=!1);var Z=this.__chain__,ae=!!this.__actions__.length,ve=m&&!Z,Oe=C&&!ae;if(!m&&V){x=Oe?x:new Ce(this);var _e=e.apply(x,O);return _e.__actions__.push({func:Xs,args:[J],thisArg:r}),new wr(_e,Z)}return ve&&Oe?e.apply(this,O):(_e=this.thru(J),ve?c?_e.value()[0]:_e.value():_e)})}),_r(["pop","push","shift","sort","splice","unshift"],function(e){var t=xs[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);v.prototype[e]=function(){var d=arguments;if(c&&!this.__chain__){var m=this.value();return t.apply(Ie(m)?m:[],d)}return this[n](function(x){return t.apply(Ie(x)?x:[],d)})}}),zr(Ce.prototype,function(e,t){var n=v[t];if(n){var c=n.name+"";He.call(rn,c)||(rn[c]=[]),rn[c].push({name:t,func:n})}}),rn[Vs(r,pe).name]=[{name:"wrapper",func:r}],Ce.prototype.clone=Sp,Ce.prototype.reverse=Pp,Ce.prototype.value=Op,v.prototype.at=ry,v.prototype.chain=iy,v.prototype.commit=ny,v.prototype.next=sy,v.prototype.plant=ay,v.prototype.reverse=cy,v.prototype.toJSON=v.prototype.valueOf=v.prototype.value=uy,v.prototype.first=v.prototype.head,Pn&&(v.prototype[Pn]=oy),v},Zi=np();Et?((Et.exports=Zi)._=Zi,We._=Zi):De._=Zi}).call(kn)})(wc,wc.exports);var mE=Object.defineProperty,wE=Object.defineProperties,bE=Object.getOwnPropertyDescriptors,Al=Object.getOwnPropertySymbols,EE=Object.prototype.hasOwnProperty,IE=Object.prototype.propertyIsEnumerable,Rl=(a,i,r)=>i in a?mE(a,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[i]=r,uo=(a,i)=>{for(var r in i||(i={}))EE.call(i,r)&&Rl(a,r,i[r]);if(Al)for(var r of Al(i))IE.call(i,r)&&Rl(a,r,i[r]);return a},xE=(a,i)=>wE(a,bE(i));function xi(a,i,r){var s;const o=X_(a);return((s=i.rpcMap)==null?void 0:s[o.reference])||`${_E}?chainId=${o.namespace}:${o.reference}&projectId=${r}`}function Hi(a){return a.includes(":")?a.split(":")[1]:a}function Nf(a){return a.map(i=>`${i.split(":")[0]}:${i.split(":")[1]}`)}function SE(a,i){const r=Object.keys(i.namespaces).filter(o=>o.includes(a));if(!r.length)return[];const s=[];return r.forEach(o=>{const p=i.namespaces[o].accounts;s.push(...p)}),s}function PE(a={},i={}){const r=Tl(a),s=Tl(i);return wc.exports.merge(r,s)}function Tl(a){var i,r,s,o;const p={};if(!fo(a))return p;for(const[_,b]of Object.entries(a)){const S=Bl(_)?[_]:b.chains,D=b.methods||[],$=b.events||[],K=b.rpcMap||{},X=Vn(_);p[X]=xE(uo(uo({},p[X]),b),{chains:ec(S,(i=p[X])==null?void 0:i.chains),methods:ec(D,(r=p[X])==null?void 0:r.methods),events:ec($,(s=p[X])==null?void 0:s.events),rpcMap:uo(uo({},K),(o=p[X])==null?void 0:o.rpcMap)})}return p}function OE(a){return a.includes(":")?a.split(":")[2]:a}function AE(a){const i={};for(const[r,s]of Object.entries(a)){const o=s.methods||[],p=s.events||[],_=s.accounts||[],b=Bl(r)?[r]:s.chains?s.chains:Nf(s.accounts);i[r]={chains:b,methods:o,events:p,accounts:_}}return i}function uc(a){return typeof a=="number"?a:a.includes("0x")?parseInt(a,16):a.includes(":")?Number(a.split(":")[1]):Number(a)}const Ff={},st=a=>Ff[a],hc=(a,i)=>{Ff[a]=i};class RE{constructor(i){this.name="polkadot",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getAccounts(){const i=this.namespace.accounts;return i?i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;const o=Hi(r);i[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||xi(i,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);return new oi(new Si(s,st("disableProviderPing")))}}class TE{constructor(i){this.name="eip155",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(i){switch(i.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(i);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(i.request.method)?await this.client.request(i):this.getHttpProvider().request(i.request)}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(parseInt(i),r),this.chainId=parseInt(i),this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}createHttpProvider(i,r){const s=r||xi(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);return new oi(new Si(s,st("disableProviderPing")))}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;const o=parseInt(Hi(r));i[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const i=this.chainId,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}async handleSwitchChain(i){var r,s;let o=i.request.params?(r=i.request.params[0])==null?void 0:r.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const p=parseInt(o,16);if(this.isChainApproved(p))this.setDefaultChain(`${p}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:i.topic,request:{method:i.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${p}`);else throw new Error(`Failed to switch to chain 'eip155:${p}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(i){return this.namespace.chains.includes(`${this.name}:${i}`)}}class CE{constructor(i){this.name="solana",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;const o=Hi(r);i[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||xi(i,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);return new oi(new Si(s,st("disableProviderPing")))}}class DE{constructor(i){this.name="cosmos",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;const o=Hi(r);i[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||xi(i,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);return new oi(new Si(s,st("disableProviderPing")))}}class NE{constructor(i){this.name="cip34",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r),o=Hi(r);i[o]=this.createHttpProvider(o,s)}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}getCardanoRPCUrl(i){const r=this.namespace.rpcMap;if(r)return r[i]}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||this.getCardanoRPCUrl(i);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);return new oi(new Si(s,st("disableProviderPing")))}}class FE{constructor(i){this.name="elrond",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;const o=Hi(r);i[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||xi(i,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);return new oi(new Si(s,st("disableProviderPing")))}}class jE{constructor(i){this.name="multiversx",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;const o=Hi(r);i[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||xi(i,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);return new oi(new Si(s,st("disableProviderPing")))}}class $E{constructor(i){this.name="near",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){const s=r||xi(`${this.name}:${i}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,s)}this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;i[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||xi(i,this.namespace);return typeof s>"u"?void 0:new oi(new Si(s,st("disableProviderPing")))}}var LE=Object.defineProperty,qE=Object.defineProperties,ME=Object.getOwnPropertyDescriptors,Cl=Object.getOwnPropertySymbols,zE=Object.prototype.hasOwnProperty,UE=Object.prototype.propertyIsEnumerable,Dl=(a,i,r)=>i in a?LE(a,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[i]=r,ho=(a,i)=>{for(var r in i||(i={}))zE.call(i,r)&&Dl(a,r,i[r]);if(Cl)for(var r of Cl(i))UE.call(i,r)&&Dl(a,r,i[r]);return a},lc=(a,i)=>qE(a,ME(i));class zc{constructor(i){this.events=new xc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=i,this.logger=typeof i?.logger<"u"&&typeof i?.logger!="string"?i.logger:Fe.pino(Fe.getDefaultLoggerOptions({level:i?.logger||Pl})),this.disableProviderPing=i?.disableProviderPing||!1}static async init(i){const r=new zc(i);return await r.initialize(),r}async request(i,r){const[s,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:ho({},i),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(i,r,s){this.request(i,s).then(o=>r(null,o)).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var i;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(i=this.session)==null?void 0:i.topic,reason:er("USER_DISCONNECTED")}),await this.cleanup()}async connect(i){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(i),await this.cleanupPendingPairings(),!i.skipPairing)return await this.pair(i.pairingTopic)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}removeListener(i,r){this.events.removeListener(i,r)}off(i,r){this.events.off(i,r)}get isWalletConnect(){return!0}async pair(i){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:i,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(p=>{this.session=p,this.namespaces||(this.namespaces=AE(p.namespaces),this.persist("namespaces",this.namespaces))}).catch(p=>{if(p.message!==Df)throw p;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(i,r){try{if(!this.session)return;const[s,o]=this.validateChain(i);this.getProvider(s).setDefaultChain(o,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(i={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(vn(r)){for(const s of r)i.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const i=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[i]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Mc.init({logger:this.providerOpts.logger||Pl,relayUrl:this.providerOpts.relayUrl||gE,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const i=[...new Set(Object.keys(this.session.namespaces).map(r=>Vn(r)))];hc("client",this.client),hc("events",this.events),hc("disableProviderPing",this.disableProviderPing),i.forEach(r=>{if(!this.session)return;const s=SE(r,this.session),o=Nf(s),p=PE(this.namespaces,this.optionalNamespaces),_=lc(ho({},p[r]),{accounts:s,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new TE({namespace:_});break;case"solana":this.rpcProviders[r]=new CE({namespace:_});break;case"cosmos":this.rpcProviders[r]=new DE({namespace:_});break;case"polkadot":this.rpcProviders[r]=new RE({namespace:_});break;case"cip34":this.rpcProviders[r]=new NE({namespace:_});break;case"elrond":this.rpcProviders[r]=new FE({namespace:_});break;case"multiversx":this.rpcProviders[r]=new jE({namespace:_});break;case"near":this.rpcProviders[r]=new $E({namespace:_});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",i=>{this.events.emit("session_ping",i)}),this.client.on("session_event",i=>{const{params:r}=i,{event:s}=r;if(s.name==="accountsChanged"){const o=s.data;o&&vn(o)&&this.events.emit("accountsChanged",o.map(OE))}else if(s.name==="chainChanged"){const o=r.chainId,p=r.event.data,_=Vn(o),b=uc(o)!==uc(p)?`${_}:${uc(p)}`:o;this.onChainChanged(b)}else this.events.emit(s.name,s.data);this.events.emit("session_event",i)}),this.client.on("session_update",({topic:i,params:r})=>{var s;const{namespaces:o}=r,p=(s=this.client)==null?void 0:s.session.get(i);this.session=lc(ho({},p),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:i,params:r})}),this.client.on("session_delete",async i=>{await this.cleanup(),this.events.emit("session_delete",i),this.events.emit("disconnect",lc(ho({},er("USER_DISCONNECTED")),{data:i.topic}))}),this.on(ai.DEFAULT_CHAIN_CHANGED,i=>{this.onChainChanged(i,!0)})}getProvider(i){if(!this.rpcProviders[i])throw new Error(`Provider not found: ${i}`);return this.rpcProviders[i]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(i=>{var r;this.getProvider(i).updateNamespace((r=this.session)==null?void 0:r.namespaces[i])})}setNamespaces(i){const{namespaces:r,optionalNamespaces:s,sessionProperties:o}=i;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(i){const[r,s]=i?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(_=>Vn(_)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const o=Vn(Object.keys(this.namespaces)[0]),p=this.rpcProviders[o].getDefaultChain();return[o,p]}async requestAccounts(){const[i]=this.validateChain();return await this.getProvider(i).requestAccounts()}onChainChanged(i,r=!1){var s;if(!this.namespaces)return;const[o,p]=this.validateChain(i);r||this.getProvider(o).setDefaultChain(p),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${p}`]).defaultChain=p,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",p)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(i,r){this.client.core.storage.setItem(`${Ol}/${i}`,r)}async getFromStore(i){return await this.client.core.storage.getItem(`${Ol}/${i}`)}}const HE=zc,BE="wc",kE="ethereum_provider",VE=`${BE}@2:${kE}:`,KE="https://rpc.walletconnect.com/v1/",bc=["eth_sendTransaction","personal_sign"],GE=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Ec=["chainChanged","accountsChanged"],WE=["chainChanged","accountsChanged","message","disconnect","connect"];var JE=Object.defineProperty,QE=Object.defineProperties,YE=Object.getOwnPropertyDescriptors,Nl=Object.getOwnPropertySymbols,XE=Object.prototype.hasOwnProperty,ZE=Object.prototype.propertyIsEnumerable,Fl=(a,i,r)=>i in a?JE(a,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[i]=r,Gn=(a,i)=>{for(var r in i||(i={}))XE.call(i,r)&&Fl(a,r,i[r]);if(Nl)for(var r of Nl(i))ZE.call(i,r)&&Fl(a,r,i[r]);return a},jl=(a,i)=>QE(a,YE(i));function vo(a){return Number(a[0].split(":")[1])}function fc(a){return`0x${a.toString(16)}`}function eI(a){const{chains:i,optionalChains:r,methods:s,optionalMethods:o,events:p,optionalEvents:_,rpcMap:b}=a;if(!vn(i))throw new Error("Invalid chains");const S={chains:i,methods:s||bc,events:p||Ec,rpcMap:Gn({},i.length?{[vo(i)]:b[vo(i)]}:{})},D=p?.filter(Q=>!Ec.includes(Q)),$=s?.filter(Q=>!bc.includes(Q));if(!r&&!_&&!o&&!(D!=null&&D.length)&&!($!=null&&$.length))return{required:i.length?S:void 0};const K=D?.length&&$?.length||!r,X={chains:[...new Set(K?S.chains.concat(r||[]):r)],methods:[...new Set(S.methods.concat(o!=null&&o.length?o:GE))],events:[...new Set(S.events.concat(_!=null&&_.length?_:WE))],rpcMap:b};return{required:i.length?S:void 0,optional:r.length?X:void 0}}class Uc{constructor(){this.events=new Pr.exports.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=VE,this.on=(i,r)=>(this.events.on(i,r),this),this.once=(i,r)=>(this.events.once(i,r),this),this.removeListener=(i,r)=>(this.events.removeListener(i,r),this),this.off=(i,r)=>(this.events.off(i,r),this),this.parseAccount=i=>this.isCompatibleChainId(i)?this.parseAccountId(i).address:i,this.signer={},this.rpc={}}static async init(i){const r=new Uc;return await r.initialize(i),r}async request(i){return await this.signer.request(i,this.formatChainId(this.chainId))}sendAsync(i,r){this.signer.sendAsync(i,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(i){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(i);const{required:r,optional:s}=eI(this.rpc);try{const o=await new Promise(async(_,b)=>{var S;this.rpc.showQrModal&&((S=this.modal)==null||S.subscribeModal(D=>{!D.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),b(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(jl(Gn({namespaces:Gn({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:i?.pairingTopic})).then(D=>{_(D)}).catch(D=>{b(new Error(D.message))})});if(!o)return;const p=Z_(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:p),this.setAccounts(p),this.events.emit("connect",{chainId:fc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",i=>{const{params:r}=i,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",i)}),this.signer.on("chainChanged",i=>{const r=parseInt(i);this.chainId=r,this.events.emit("chainChanged",fc(this.chainId)),this.persist()}),this.signer.on("session_update",i=>{this.events.emit("session_update",i)}),this.signer.on("session_delete",i=>{this.reset(),this.events.emit("session_delete",i),this.events.emit("disconnect",jl(Gn({},er("USER_DISCONNECTED")),{data:i.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",i=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:i})),this.events.emit("display_uri",i)})}switchEthereumChain(i){this.request({method:"wallet_switchEthereumChain",params:[{chainId:i.toString(16)}]})}isCompatibleChainId(i){return typeof i=="string"?i.startsWith(`${this.namespace}:`):!1}formatChainId(i){return`${this.namespace}:${i}`}parseChainId(i){return Number(i.split(":")[1])}setChainIds(i){const r=i.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",fc(this.chainId)),this.persist())}setChainId(i){if(this.isCompatibleChainId(i)){const r=this.parseChainId(i);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(i){const[r,s,o]=i.split(":");return{chainId:`${r}:${s}`,address:o}}setAccounts(i){this.accounts=i.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(i){var r,s;const o=(r=i?.chains)!=null?r:[],p=(s=i?.optionalChains)!=null?s:[],_=o.concat(p);if(!_.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const b=o.length?i?.methods||bc:[],S=o.length?i?.events||Ec:[],D=i?.optionalMethods||[],$=i?.optionalEvents||[],K=i?.rpcMap||this.buildRpcMap(_,i.projectId),X=i?.qrModalOptions||void 0;return{chains:o?.map(Q=>this.formatChainId(Q)),optionalChains:p.map(Q=>this.formatChainId(Q)),methods:b,events:S,optionalMethods:D,optionalEvents:$,rpcMap:K,showQrModal:!!(i!=null&&i.showQrModal),qrModalOptions:X,projectId:i.projectId,metadata:i.metadata}}buildRpcMap(i,r){const s={};return i.forEach(o=>{s[o]=this.getRpcUrl(o,r)}),s}async initialize(i){if(this.rpc=this.getRpcConfig(i),this.chainId=this.rpc.chains.length?vo(this.rpc.chains):vo(this.rpc.optionalChains),this.signer=await HE.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:i.disableProviderPing,relayUrl:i.relayUrl,storageOptions:i.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await em(()=>import("./index.e9215dbb.js").then(function(o){return o.i}),["assets/index.e9215dbb.js","assets/index.ffae99bc.js","assets/index.8b8d187e.css"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Gn({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(i){if(!i)return;const{chains:r,optionalChains:s,rpcMap:o}=i;r&&vn(r)&&(this.rpc.chains=r.map(p=>this.formatChainId(p)),r.forEach(p=>{this.rpc.rpcMap[p]=o?.[p]||this.getRpcUrl(p)})),s&&vn(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s?.map(p=>this.formatChainId(p)),s.forEach(p=>{this.rpc.rpcMap[p]=o?.[p]||this.getRpcUrl(p)}))}getRpcUrl(i,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[i])||`${KE}?chainId=eip155:${i}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const i=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${i}`]?this.session.namespaces[`${this.namespace}:${i}`]:this.session.namespaces[this.namespace];this.setChainIds(i?[this.formatChainId(i)]:r?.accounts),this.setAccounts(r?.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(i){return typeof i=="string"||i instanceof String?[this.parseAccount(i)]:i.map(r=>this.parseAccount(r))}}const iI=Uc;export{iI as EthereumProvider,WE as OPTIONAL_EVENTS,GE as OPTIONAL_METHODS,Ec as REQUIRED_EVENTS,bc as REQUIRED_METHODS,Uc as default};
